"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[87],{87:(Pt,S,m)=>{m.r(S),m.d(S,{OrderModule:()=>qt});var c=m(6814),i=m(6223),V=m(3983),E=m(8180),g=m(4664),G=m(6306),f=m(2096),W=m(9397),h=m(2181),N=m(4769),e=m(5879);class L{constructor(){this.customerId=0,this.id=0,this.custType="Associate",this.pageNumber=1,this.pageSize=4,this.search=""}}var I=m(2051),A=m(9862),q=m(7398),M=m(5516),k=m(1436);let $=(()=>{class o{constructor(t){this.http=t,this.apiUrl=M.N.apiUrl,this.cParams=new L,this.associates=[],this.cache=new Map}getOfficialAndAgentName(){return this.http.get(this.apiUrl+"customers/officialidandcustomernames/associate")}getOfficialsAndCustomers(){const t=this.cache.get(Object.values(this.cParams).join("-"));if(t)return(0,f.of)(t);let r=new A.LE;return r=r.append("customerType",this.cParams.custType),r=r.append("pageNumber",this.cParams.pageNumber.toString()),r=r.append("pageSize",this.cParams.pageSize.toString()),(0,k.Tr)(this.apiUrl+"customers/officialidandcustomernames/"+this.cParams.custType,r,this.http).pipe((0,q.U)(s=>(this.cache.set(Object.values(this.cParams).join("-"),s),s)))}setParams(t){this.cParams=t}getParams(){return this.cParams}static#e=this.\u0275fac=function(r){return new(r||o)(e.LFG(A.eN))};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var F=m(7012);function X(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"pagination",14),e.NdJ("pageChanged",function(s){e.CHM(t);const n=e.oxw();return e.KtG(n.onPageChanged(s))}),e._uU(1," >"),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("totalItems",t.pagination.totalItems)("itemsPerPage",t.pagination.itemsPerPage)("maxSize",10)}}function ee(o,d){1&o&&(e.TgZ(0,"div"),e._uU(1," No Officials found on record "),e.qZA())}function te(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div",18)(1,"input",19),e.NdJ("change",function(){const n=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.updateChecked(n))}),e.qZA(),e.TgZ(2,"label",20),e._uU(3),e.qZA(),e.TgZ(4,"label",21),e._uU(5),e.qZA(),e.TgZ(6,"label",22),e._uU(7),e.qZA(),e.TgZ(8,"label",23),e._uU(9),e.qZA()()}if(2&o){const t=d.$implicit,r=e.oxw(2);e.xp6(1),e.Q6J("checked",r.selectedOfficials.includes(t))("disabled",t.customerIsBlacklisted||void 0===t.email),e.xp6(2),e.Oqu(t.customerName),e.xp6(2),e.Oqu(t.officialName),e.xp6(2),e.Oqu(t.email),e.xp6(2),e.Oqu(t.phoneNo)}}function re(o,d){if(1&o&&(e.TgZ(0,"form",15,16),e.YNc(2,te,10,6,"div",17),e.qZA()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("ngForOf",t.availableOfficials)}}let se=(()=>{class o{constructor(t,r){this.bsModalRef=t,this.service=r,this.selectedOfficialsEvent=new e.vpe,this.availableOfficials=[],this.selectedOfficials=[],this.cParams=new L,this.lastCustomerType="",this.totalCount=0}ngOnInit(){this.service.setParams(this.cParams),this.getAssociates()}getAssociates(){this.service.getOfficialsAndCustomers().subscribe({next:t=>{this.availableOfficials=t.result,this.pagination=t.pagination,this.totalCount=t.totalCount}}),console.log("available officials:",this.availableOfficials)}updateChecked(t){const r=this.selectedOfficials.indexOf(t);-1!==r?this.selectedOfficials.splice(r,1,t):this.selectedOfficials.push(t)}Close(){this.selectedOfficialsEvent.emit(this.selectedOfficials),this.bsModalRef.hide()}onPageChanged(t){this.cParams&&(this.cParams.pageNumber!==t.page||this.cParams.custType!==this.lastCustomerType)&&(this.cParams.pageNumber=t.page,this.service.setParams(this.cParams),this.lastCustomerType=this.cParams.custType,this.getAssociates())}static#e=this.\u0275fac=function(r){return new(r||o)(e.Y36(I.UZ),e.Y36($))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-select-associates-modal"]],outputs:{selectedOfficialsEvent:"selectedOfficialsEvent"},decls:20,vars:3,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],["type","button",1,"btn","btn-success","fa","fa-check",2,"margin-left","50px",3,"click"],["type","button","aria-label","Close",1,"btn-close","close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],["class","stdd","previousText","\u2039","nextText","\u203a","firstText","\xab","lastText","\xbb",3,"totalItems","itemsPerPage","maxSize","pageChanged",4,"ngIf"],[1,"lbl","w250","b",2,"margin-left","60px"],[1,"lbl","w125","b"],[1,"lbl","w150","b"],[1,"lbl","w100","b"],[4,"ngIf"],["id","form",4,"ngIf"],[1,"modal-footer"],["previousText","\u2039","nextText","\u203a","firstText","\xab","lastText","\xbb",1,"stdd",3,"totalItems","itemsPerPage","maxSize","pageChanged"],["id","form"],["form","ngForm"],["class","form-check",4,"ngFor","ngForOf"],[1,"form-check"],["type","checkbox","value","associate",1,"lbl","w15","form-check-input",2,"border-color","black",3,"checked","disabled","change"],[1,"lbl","w250"],[1,"lbl","w125"],[1,"lbl","w150"],[1,"lbl","w100"]],template:function(r,s){1&r&&(e.TgZ(0,"div",0)(1,"h4",1),e._uU(2,"Select Associates"),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return s.Close()}),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return s.bsModalRef.hide()}),e.TgZ(5,"span",4),e._uU(6,"\xd7"),e.qZA()()(),e.TgZ(7,"div",5),e.YNc(8,X,2,3,"pagination",6),e.TgZ(9,"label",7),e._uU(10,"Customer Name"),e.qZA(),e.TgZ(11,"label",8),e._uU(12,"Official Name"),e.qZA(),e.TgZ(13,"label",9),e._uU(14,"Email"),e.qZA(),e.TgZ(15,"label",10),e._uU(16,"Phone No"),e.qZA(),e.YNc(17,ee,2,0,"div",11),e.YNc(18,re,3,1,"form",12),e.qZA(),e._UZ(19,"div",13)),2&r&&(e.xp6(8),e.Q6J("ngIf",void 0!==s.pagination),e.xp6(9),e.Q6J("ngIf",0===s.availableOfficials.length),e.xp6(1),e.Q6J("ngIf",s.availableOfficials.length>0))},dependencies:[c.sg,c.O5,F.Qt,i._Y,i.JL,i.F],styles:[".lbl[_ngcontent-%COMP%]{display:inline-block;font-size:small;margin:0 2px;vertical-align:top}.w150[_ngcontent-%COMP%]{width:150px}.w250[_ngcontent-%COMP%]{width:250px}.w125[_ngcontent-%COMP%]{width:125px}.w15[_ngcontent-%COMP%]{width:15px}.b[_ngcontent-%COMP%]{font-weight:700}"]})}return o})();var y=m(8241),Y=m(7783),oe=m(3957),H=m(4038);class U{constructor(){this.orderNo=0,this.orderId=0,this.fwdDateFrom=new Date,this.fwdDateUpto=new Date,this.customerId=0,this.professionId=0,this.sort="orderno",this.pageNumber=1,this.pageSize=15,this.search=""}}let x=(()=>{class o{constructor(t){this.http=t,this.apiUrl=M.N.apiUrl,this.orderFwds=[],this.fwdParams=new U,this.cache=new Map}getForwardsBriefPaginated(t){const r=this.cache.get(Object.values(t).join("-"));if(r)return(0,f.of)(r);let s=function ie(o){let d=new A.LE;return d=d.append("pageNumber",o.pageNumber),d=d.append("pageSize",o.pageSize),0!==o.customerId&&(d=d.append("customerId",o.customerId.toString())),0!==o.orderId&&(d=d.append("orderId",o.orderId.toString())),o.fwdDateFrom&&o.fwdDateUpto&&(d=d.append("orderDateFrom",o.fwdDateFrom.toString()),d=d.append("orderDateUpto",o.fwdDateUpto.toString())),o.search&&(d=d.append("search",o.search)),d=d.append("sort",o.sort),d}(t);return(0,k.Tr)(this.apiUrl+"OrderForward/pagedlist",s,this.http).pipe((0,q.U)(n=>(this.cache.set(Object.values(t).join("-"),n),n)))}forwardOrderToSelectedAgents(t,r){return this.http.post(this.apiUrl+"Orderforward/forwardToAgents/"+r,t)}getOrderForwardOfAnOrder(t){return this.http.get(this.apiUrl+"Orderforward/getOrGenerateOrderFwdToAgent/"+t)}getAssociatesForwardedForADL(t){return this.http.get(this.apiUrl+"Orderforward/associatesforwardedForOrderId/"+t)}generateObjToForwarOrderToAgent(t){return this.http.get(this.apiUrl+"OrderForward/generateOrderFwdToAgent/"+t,{})}insertForwarOrderToAgent(t){return this.http.post(this.apiUrl+"OrderForward/insertOrderFwdToAgent",t)}updateForwarOrderToAgent(t){return this.http.put(this.apiUrl+"OrderForward/updateOrderFwdToAgent",t)}forwarOrderToHR(t){return this.http.post(this.apiUrl+"OrderForward/updateOrderFwdToHR/"+t,{})}generateObjToForwardDLtoHR(t){return this.http.get(this.apiUrl+"OrderForward/"+t,{})}setFwdParams(t){this.fwdParams=t}getFwdParams(){return this.fwdParams}deleteForward(t){return this.http.delete(this.apiUrl+"OrderForward/deleteOrderFwd/"+t)}deleteOrderFwdCategory(t){return this.http.delete(this.apiUrl+"OrderForward/deleteOrderFwdCategory/"+t)}deleteOrderFwdCatOfficial(t){return this.http.delete(this.apiUrl+"OrderForward/deleteOrderFwdCatOfficial/"+t)}static#e=this.\u0275fac=function(r){return new(r||o)(e.LFG(A.eN))};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var u=m(7133),_=m(8763),Q=m(7450),O=m(7411),ne=m(3391),de=m(3340);function ae(o,d){if(1&o&&(e.TgZ(0,"div",20),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.order.customerName," ")}}function le(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div",21),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.editClicked())}),e._uU(1),e.qZA()}if(2&o){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.order.customerName," ")}}function ce(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div",22),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.contractReviewClicked())}),e._uU(1,"Not Reviewed"),e.qZA()}}function me(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div",23),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.contractReviewClicked())}),e._uU(1),e.ALo(2,"date"),e.qZA()}if(2&o){const t=e.oxw(2);e.xp6(1),e.hij("",e.xi3(2,1,t.order.contractReviewedOn,"dd-MMM-yy")," ")}}function ue(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div",24),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.forwardOrderToHRDept())}),e._uU(1," Not forwarded"),e.qZA()}}function pe(o,d){if(1&o&&(e.TgZ(0,"div",25),e._uU(1),e.ALo(2,"date"),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij(" ",e.xi3(2,1,t.order.forwardedToHRDeptOn,"dd-MMM-yy")," ")}}function fe(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"div",1)(2,"div",2),e._uU(3),e.qZA(),e.TgZ(4,"div",3),e._uU(5),e.ALo(6,"date"),e.qZA(),e.YNc(7,ae,2,1,"div",4),e.YNc(8,le,2,1,"div",5),e.TgZ(9,"div",6),e._uU(10),e.qZA(),e.TgZ(11,"div",7),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.contractReviewClicked())}),e._uU(12),e.qZA(),e.YNc(13,ce,2,0,"div",8),e.YNc(14,me,3,4,"div",9),e.YNc(15,ue,2,0,"div",10),e.YNc(16,pe,3,4,"div",11),e.TgZ(17,"button",12),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.editClicked())}),e.qZA(),e.TgZ(18,"button",13),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.dlForwardToAssociatesClicked())}),e.qZA(),e.TgZ(19,"button",14),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.DLForwardedClicked())}),e.qZA(),e.TgZ(20,"button",15),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.AcknowledgeClicked())}),e.qZA(),e.TgZ(21,"button",16),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.cvReferredClicked())}),e.qZA(),e.TgZ(22,"button",17),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.selectionClicked())}),e.TgZ(23,"i",18),e._uU(24,"assignment_ind"),e.qZA()(),e.TgZ(25,"button",19),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.deleteClicked())}),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(3),e.Oqu(t.order.orderNo),e.xp6(2),e.Oqu(e.xi3(6,11,t.order.orderDate,"dd-MMM-yy")),e.xp6(2),e.Q6J("ngIf","concluded"==t.order.status),e.xp6(1),e.Q6J("ngIf","concluded"!=t.order.status),e.xp6(2),e.Oqu(t.order.cityOfWorking),e.xp6(1),e.Q6J("ngClass","Not Reviewed"==t.order.contractReviewStatus||"regretted"===t.order.contractReviewStatus?"b":""),e.xp6(1),e.Oqu(t.order.contractReviewStatus),e.xp6(1),e.Q6J("ngIf",null===t.order.contractReviewedOn),e.xp6(1),e.Q6J("ngIf",null!==t.order.contractReviewedOn),e.xp6(1),e.Q6J("ngIf",null===t.order.forwardedToHRDeptOn),e.xp6(1),e.Q6J("ngIf",null!==t.order.forwardedToHRDeptOn)}}let ge=(()=>{class o{constructor(t,r,s){this.orderFwdService=t,this.toastr=r,this.intervwService=s,this.editEvent=new e.vpe,this.contractReviewEvent=new e.vpe,this.orderFwdToAssociatesEvent=new e.vpe,this.DLForwardedEvent=new e.vpe,this.deleteEvent=new e.vpe,this.acknowledgeToClientEvent=new e.vpe,this.cvreferredEvent=new e.vpe,this.orderAssessmentItemEvent=new e.vpe,this.selectionEvent=new e.vpe,this.menuTopLeftPosition={x:0,y:0}}ngOnInit(){}contractReviewClicked(){this.contractReviewEvent.emit(this.order.id)}orderAssessmentItemClicked(){this.order&&this.orderAssessmentItemEvent.emit(this.order.id)}editClicked(){this.editEvent.emit(this.order.id)}selectionClicked(){this.selectionEvent.emit(this.order.id)}deleteClicked(){this.deleteEvent.emit(this.order?.id)}forwardOrderToHRDept(){this.order&&this.orderFwdService.forwarOrderToHR(this.order.id).subscribe({next:t=>{""===t||null===t?this.toastr.success("task created for HR Dept and message created and saved in drafts","success"):this.toastr.warning(t,"failure")},error:t=>this.toastr.error(t?.error?.details,"error encountered")})}dlForwardToAssociatesClicked(){console.log("orderid in modal",this.order?.id),this.orderFwdToAssociatesEvent.emit(this.order?.id)}DLForwardedClicked(){this.DLForwardedEvent.emit(this.order?.id)}AcknowledgeClicked(){this.acknowledgeToClientEvent.emit(this.order?.id)}cvReferredClicked(){this.cvreferredEvent.emit(this.order?.id)}static#e=this.\u0275fac=function(r){return new(r||o)(e.Y36(x),e.Y36(_._W),e.Y36(de.n))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-order-item"]],inputs:{order:"order"},outputs:{editEvent:"editEvent",contractReviewEvent:"contractReviewEvent",orderFwdToAssociatesEvent:"orderFwdToAssociatesEvent",DLForwardedEvent:"DLForwardedEvent",deleteEvent:"deleteEvent",acknowledgeToClientEvent:"acknowledgeToClientEvent",cvreferredEvent:"cvreferredEvent",orderAssessmentItemEvent:"orderAssessmentItemEvent",selectionEvent:"selectionEvent"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"stdd",2,"width","max-content"],[1,"stdd","w80"],[1,"stdd","w90"],["class","stdd w200","title","this order cannot be edited as it is concluded",4,"ngIf"],["class","stdd w200",3,"click",4,"ngIf"],[1,"stdd","w150"],["title","click to conduct Contract Review of this Order",1,"stdd","w100","cursorpointer",3,"ngClass","click"],["class","stdd w100 b","title","click for technical & commercial review of this order",3,"click",4,"ngIf"],["class","stdd w100","title","click to review/edit technical & commercial review of this order",3,"click",4,"ngIf"],["class","stdd w100 fontSmall b cursorpointer","title","click to forward this Order to HR Dept Head",3,"click",4,"ngIf"],["class","stdd w100",4,"ngIf"],["title","edit this DL","type","button",1,"stdd","w15","fa","fa-pencil",3,"click"],["title","Forward this order to Associates (to be selected)",1,"stdd","w15","fa","fa-users",3,"click"],["title","Associates to whom this DL is already forwardED",1,"stdd","w15","fa","fa-users",3,"click"],["title","compose email message of acknowldgement to client",1,"stdd","w15","fa","fa-envelope",3,"click"],["title","cvs forwarded","type","button","title","CVs already referrED to clients for this Order",1,"stdd","w15","fa","fa-circle",3,"click"],["title","selections and rejections against this order","type","button",1,"stdd","w30",3,"click"],[1,"material-icons",2,"font-size","medium"],["title","delete the DL","type","button",1,"stdd","w15","fa","fa-trash","red",3,"click"],["title","this order cannot be edited as it is concluded",1,"stdd","w200"],[1,"stdd","w200",3,"click"],["title","click for technical & commercial review of this order",1,"stdd","w100","b",3,"click"],["title","click to review/edit technical & commercial review of this order",1,"stdd","w100",3,"click"],["title","click to forward this Order to HR Dept Head",1,"stdd","w100","fontSmall","b","cursorpointer",3,"click"],[1,"stdd","w100"]],template:function(r,s){1&r&&e.YNc(0,fe,26,14,"div",0),2&r&&e.Q6J("ngIf",null!=s.order)},dependencies:[c.mk,c.O5,c.uU],styles:[".stdd[_ngcontent-%COMP%]{display:inline-block;margin-left:2px;margin-right:1px;font-size:small;word-wrap:normal!important;vertical-align:top}.cursorpointer[_ngcontent-%COMP%]{cursor:pointer}.alignR[_ngcontent-%COMP%]{text-align:right}.w15[_ngcontent-%COMP%]{width:15px}.w30[_ngcontent-%COMP%]{width:30px}.w80[_ngcontent-%COMP%]{width:80px}.w90[_ngcontent-%COMP%]{width:90px}.w100[_ngcontent-%COMP%]{width:100px}.w150[_ngcontent-%COMP%]{width:150px}.w200[_ngcontent-%COMP%]{width:200px}.w250[_ngcontent-%COMP%]{width:250px}.b[_ngcontent-%COMP%]{font-weight:700}.green[_ngcontent-%COMP%]{color:green}.vAlignMiddle[_ngcontent-%COMP%]{vertical-align:middle}.fontSmall[_ngcontent-%COMP%]{font-size:small}.borderAqua[_ngcontent-%COMP%]{border:aqua}.w15[_ngcontent-%COMP%]{width:25px}"]})}return o})();const he=["search"];function _e(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"pagination",15),e.NdJ("pageChanged",function(s){e.CHM(t);const n=e.oxw();return e.KtG(n.onPageChanged(s))}),e._uU(1," >"),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("totalItems",t.pagination.totalItems)("itemsPerPage",t.pagination.itemsPerPage)("maxSize",10)}}function ve(o,d){1&o&&(e.TgZ(0,"div"),e._uU(1,"No orders on record"),e.qZA())}function we(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"app-order-item",17),e.NdJ("editEvent",function(s){e.CHM(t);const n=e.oxw(2);return e.KtG(n.editOrder(s))})("orderFwdToAssociatesEvent",function(s){e.CHM(t);const n=e.oxw(2);return e.KtG(n.orderForwardToAssociates(s))})("DLForwardedEvent",function(s){e.CHM(t);const n=e.oxw(2);return e.KtG(n.DLForwarded(s))})("deleteEvent",function(s){e.CHM(t);const n=e.oxw(2);return e.KtG(n.deleteOrder(s))})("acknowledgeToClientEvent",function(s){e.CHM(t);const n=e.oxw(2);return e.KtG(n.acknowledgeToClient(s))})("cvreferredEvent",function(s){e.CHM(t);const n=e.oxw(2);return e.KtG(n.cvsReferred(s))})("orderAssessmentItemEvent",function(s){e.CHM(t);const n=e.oxw(2);return e.KtG(n.orderAssessmentItem(s))})("selectionEvent",function(s){e.CHM(t);const n=e.oxw(2);return e.KtG(n.selectionRejection(s))})("contractReviewEvent",function(s){e.CHM(t);const n=e.oxw(2);return e.KtG(n.contractReviewOrder(s))}),e.qZA()()}if(2&o){const t=d.$implicit;e.xp6(1),e.Q6J("order",t)}}function be(o,d){if(1&o&&(e.TgZ(0,"div"),e.YNc(1,we,2,1,"div",16),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.orders)}}let xe=(()=>{class o{constructor(t,r,s,n,a,l,p,w,T,D,b,Ft,Ut){this.service=t,this.accountsService=r,this.selService=s,this.taskService=n,this.orderFwdService=a,this.router=l,this.activatedRoute=p,this.toastr=w,this.modalService=T,this.customerService=D,this.dlFwdService=b,this.confirmService=Ft,this.cvrefService=Ut,this.orders=[],this.oParams=new N.R,this.totalCount=0,this.customers=[],this.title="context-menu",this.sortOptions=[{name:"By Order No Asc",value:"orderno"},{name:"By Order No Desc",value:"ordernodesc"},{name:"By City Asc",value:"city"},{name:"By City Desc",value:"citydesc"},{name:"By Profession Asc",value:"prof"},{name:"By Profession Desc",value:"profdesc"},{name:"By Contract Reviewed Asc",value:"reviewed"},{name:"By Contract Rvwd Desc",value:"reveiweddesc"}],this.orderStatus=[{name:"Not Reviewed",value:"Not Reviewed"},{name:"Reviewed and Approved",value:"ReviewedAndApproved"},{name:"Reviewed and declined",value:"ReviewedAndDeclined"}],this.accountsService.currentUser$.pipe((0,E.q)(1)).subscribe(Qt=>this.user=Qt)}ngOnInit(){this.getOrders(this.oParams),this.activatedRoute.data.subscribe({next:t=>{this.customers=t.customers}})}getOrders(t){this.service.getOrdersBrief(t).subscribe({next:r=>{r.result&&r.pagination&&(this.orders=r.result,this.pagination=r.pagination,this.totalCount=r.count)},error:r=>console.log(this.orders)})}onSearch(){const t=this.service.getOParams();t.search=this.searchTerm?.nativeElement.value,t.pageNumber=1,this.service.setOParams(t),this.getOrders(t)}onReset(){this.searchTerm.nativeElement.value="",this.oParams=new N.R,this.service.setOParams(this.oParams),this.getOrders(this.oParams)}onSortSelected(t){var r=t?.target.value;this.oParams.pageNumber=1,this.oParams.sort=r,this.getOrders(this.oParams)}onPageChanged(t){const r=this.service.getOParams()??new N.R;r.pageNumber!==t.page&&(r.pageNumber=t.page,this.service.setOParams(r),this.getOrders(r))}deleteOrder(t){this.confirmService.confirm("confirm delete this Order","confirm delete order").pipe((0,g.w)(r=>this.service.deleteOrder(t).pipe((0,G.K)(s=>(0,f.of)()),(0,W.b)(s=>this.toastr.success("deleted Order")))),(0,G.K)(r=>(this.toastr.error("Error in getting delete confirmation",r),(0,f.of)()))).subscribe(()=>{var r=this.orders.findIndex(s=>s.id===t);-1!==r&&this.orders.splice(r,1),this.toastr.success("order deleted")},r=>{console.log("any error NOT handed in catchError() or if throwError() is returned instead of of() inside catcherror()",r)})}editOrder(t){this.navigateByRoute(t,"/orders/edit",!0)}contractReviewOrder(t){this.navigateByRoute(t,"/orders/orderReview",!0)}orderAssessmentItem(t){this.navigateByRoute(t,"orders/orderitemreview",!0)}orderForwardToAssociates(t){this.bsModalRef=this.modalService.show(se,{class:"modal-dialog-centered modal-lg",initialState:{}}),(this.bsModalRef.content?.selectedOfficialsEvent).pipe((0,h.h)(n=>n.length>0),(0,g.w)(n=>this.orderFwdService.forwardOrderToSelectedAgents(n,t))).subscribe({next:()=>this.toastr.success("Requirement forwarded","Success"),error:n=>{console.log(n),this.toastr.error(n.error.details,"Error encountered")}})}DLForwarded(t){this.navigateByRoute(t,"orders/DLForwarded",!0)}acknowledgeToClient(t){this.service.acknowledgeOrderToClient(t).subscribe({next:r=>{r?this.toastr.success("message of acknowledgement composed and saved in Messages Draft"):this.toastr.warning("failed to compose message of acknowledgement")},error:r=>this.toastr.error("Error in composing acknowldgement message to client",r)})}cvsReferred(t){this.navigateByRoute(t,"/orders/cvsreferred",!1)}selectionRejection(t){this.navigateByRoute(t,"/orders/selections",!1)}navigateByRoute(t,r,s){this.router.navigate([0===t?r:r+"/"+t],{state:{user:this.user,toedit:s,returnUrl:"/orders/orders"}})}documentClick(){}static#e=this.\u0275fac=function(r){return new(r||o)(e.Y36(y.p),e.Y36(Y.B),e.Y36(oe.z),e.Y36(H.M),e.Y36(x),e.Y36(u.F0),e.Y36(u.gz),e.Y36(_._W),e.Y36(I.tT),e.Y36(Q.v),e.Y36(x),e.Y36(O.z),e.Y36(ne.Z))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-orders-listing"]],viewQuery:function(r,s){if(1&r&&e.Gf(he,5),2&r){let n;e.iGM(n=e.CRH())&&(s.searchTerm=n.first)}},hostBindings:function(r,s){1&r&&e.NdJ("click",function(){return s.documentClick()},!1,e.evT)},decls:27,vars:3,consts:[[2,"display","inline-block","font-size","large","font-weight","bold"],[2,"display","inline-block","margin-left","15px","vertical-align","top"],["class","stdd","previousText","\u2039","nextText","\u203a","firstText","\xab","lastText","\xbb",3,"totalItems","itemsPerPage","maxSize","pageChanged",4,"ngIf"],["type","text","placeholder","Search",1,"stdd","fa-solid","w200",3,"keyup.enter"],["search",""],["title","searches the database based upon criteria entered in the search box",1,"btn","fa","fa-search","fa-2x",2,"color","aliceblue",3,"click"],["title","Resets the search criteria",1,"btn","fa","fa-refresh","fa-2x",2,"color","aliceblue",3,"click"],["title","Add a new Order","routerLink","/orders/edit/0",1,"btn","fa","fa-plus","fa-2x",2,"color","aliceblue"],["routerLink","/",1,"btn","fa","fa-window-close","fa-2x",2,"color","aliceblue"],[1,"form-inline"],[1,"stdd","w70","b"],[1,"stdd","w100","b"],[1,"stdd","w200","b"],[1,"stdd","w150","b"],[4,"ngIf"],["previousText","\u2039","nextText","\u203a","firstText","\xab","lastText","\xbb",1,"stdd",3,"totalItems","itemsPerPage","maxSize","pageChanged"],[4,"ngFor","ngForOf"],[3,"order","editEvent","orderFwdToAssociatesEvent","DLForwardedEvent","deleteEvent","acknowledgeToClientEvent","cvreferredEvent","orderAssessmentItemEvent","selectionEvent","contractReviewEvent"]],template:function(r,s){1&r&&(e.TgZ(0,"div",0),e._uU(1,"Orders Listing"),e.qZA(),e.TgZ(2,"div",1),e.YNc(3,_e,2,3,"pagination",2),e.TgZ(4,"input",3,4),e.NdJ("keyup.enter",function(){return s.onSearch()}),e.qZA(),e.TgZ(6,"button",5),e.NdJ("click",function(){return s.onSearch()}),e.qZA(),e.TgZ(7,"button",6),e.NdJ("click",function(){return s.onReset()}),e.qZA(),e._UZ(8,"button",7)(9,"button",8),e.qZA(),e.TgZ(10,"div",9)(11,"div",10),e._uU(12,"Order No"),e.qZA(),e.TgZ(13,"div",11),e._uU(14,"Order Date"),e.qZA(),e.TgZ(15,"div",12),e._uU(16,"Customer Name"),e.qZA(),e.TgZ(17,"div",13),e._uU(18,"City"),e.qZA(),e.TgZ(19,"div",11),e._uU(20,"Review status"),e.qZA(),e.TgZ(21,"div",11),e._uU(22,"Reviewed On"),e.qZA(),e.TgZ(23,"div",11),e._uU(24,"Forwarded To HR On"),e.qZA()(),e.YNc(25,ve,2,0,"div",14),e.YNc(26,be,2,1,"div",14)),2&r&&(e.xp6(3),e.Q6J("ngIf",s.pagination),e.xp6(22),e.Q6J("ngIf",!s.orders),e.xp6(1),e.Q6J("ngIf",s.orders))},dependencies:[c.sg,c.O5,u.rH,F.Qt,ge],styles:[".stdd[_ngcontent-%COMP%]{display:inline-block;margin-left:2px;margin-right:1px;font-size:smaller;word-wrap:normal;vertical-align:middle;font-weight:700}.alignR[_ngcontent-%COMP%]{text-align:right}.w50[_ngcontent-%COMP%]{width:50px}.w70[_ngcontent-%COMP%]{width:70px}.w80[_ngcontent-%COMP%]{width:80px}.w100[_ngcontent-%COMP%]{width:100px}.w150[_ngcontent-%COMP%]{width:150px}.w200[_ngcontent-%COMP%]{width:200px}.w300[_ngcontent-%COMP%]{width:300px}.b[_ngcontent-%COMP%]{font-weight:700}.red[_ngcontent-%COMP%]{color:red}.blue[_ngcontent-%COMP%]{color:#00f}.vAlignMiddle[_ngcontent-%COMP%]{vertical-align:middle}.fontSmall[_ngcontent-%COMP%]{font-size:small}.borderAqua[_ngcontent-%COMP%]{border:aqua}"]})}return o})();var j=m(7208);const B=o=>(0,e.f3M)(Q.v).getClientIdAndNames();var z=m(6468);class Ce{constructor(){this.orderId=0,this.orderDate=new Date,this.customerId=0,this.customerNameLike="",this.city="",this.categoryId=0,this.orderidInts=[],this.orderids="",this.sort="name",this.pageNumber=1,this.pageSize=10,this.search=""}}let P=(()=>{class o{constructor(t){this.http=t,this.apiUrl=M.N.apiUrl,this.reviewItemStatuses=[],this.cache=new Map,this.cacheS=new Map,this.oParams=new Ce}getOrGenerateContractReview(t){return this.http.get(this.apiUrl+"ContractReview/getOrGenerate/"+t)}getContractReviewItem(t){return this.http.get(this.apiUrl+"ContractReview/reviewitem/"+t)}getContractReviewItems(t){return this.http.get(this.apiUrl+"contractreview/reviewitems/"+t)}InsertContractReviewItemFromOrderItemId(t){return this.http.get(this.apiUrl+"Orders/insertreviewitem/"+t)}updateContractReviewItem(t){return 0!==t.id?this.http.put(this.apiUrl+"ContractReview/reviewitem",t):this.http.post(this.apiUrl+"ContractReview/reviewitem",t)}getContractReviews(t){const r=this.cache.get(Object.values(t).join("-"));if(r)return(0,f.of)(r);let s=(0,k.v1)(t);return(0,k.Tr)(this.apiUrl+"ContractReview/contractreviewspaged",s,this.http).pipe((0,q.U)(n=>(this.cache.set(Object.values(t).join("-"),n),n)))}getContractReviewStddQsData(){return this.http.get(this.apiUrl+"contractreview/reviewstddq")}generateContractReviewObject(t){return this.http.get(this.apiUrl+"ContractReview/generate/"+t)}saveContractReview(t){return this.http.post(this.apiUrl+"ContractReview/contractreview",t)}updateContractReview(t){return this.http.put(this.apiUrl+"ContractReview/contractreview",t)}static#e=this.\u0275fac=function(r){return new(r||o)(e.LFG(A.eN))};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var R=m(4807),Z=m(7114);function Ie(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"ng-select",32),e.NdJ("change",function(s){e.CHM(t);const n=e.oxw(2);return e.KtG(n.employeeChanged(s))}),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("items",t.empIdAndNames)}}function Ae(o,d){1&o&&e._UZ(0,"div",33)}function Oe(o,d){if(1&o&&(e.TgZ(0,"div",34),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Oqu(t.skills.flat())}}function Ze(o,d){if(1&o&&e._UZ(0,"ng-select",35),2&o){const t=e.oxw(2);e.Q6J("items",t.reviewStatus)}}function Te(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div",11)(1,"h4",12),e._uU(2,"Contract Review - Order Category"),e.qZA(),e._UZ(3,"br"),e.TgZ(4,"div",13)(5,"span",14),e._uU(6,"Customer: "),e.qZA(),e._uU(7),e.qZA(),e.TgZ(8,"div",15)(9,"span",14),e._uU(10,"Order No.: "),e.qZA(),e._uU(11),e.ALo(12,"date"),e.qZA(),e.TgZ(13,"button",16),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.confirmUpdate())}),e.qZA(),e.TgZ(14,"button",17),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.decline())}),e.qZA(),e._UZ(15,"br"),e.TgZ(16,"div",18)(17,"span"),e._uU(18,"Category to review: "),e.qZA()(),e.TgZ(19,"div",19),e._uU(20),e.qZA(),e.TgZ(21,"div",20),e._uU(22,"Charges: "),e.qZA(),e._UZ(23,"app-text-input",21)(24,"br"),e.TgZ(25,"div",22),e._uU(26,"Assigned to: "),e.qZA(),e.YNc(27,Ie,1,1,"ng-select",23),e.TgZ(28,"label",24),e._uU(29,"HR Skills:"),e.qZA(),e.YNc(30,Ae,1,0,"div",25),e.YNc(31,Oe,2,1,"div",26),e._UZ(32,"br"),e.TgZ(33,"div",27),e._uU(34,"Review Item Status"),e.qZA(),e.YNc(35,Ze,1,1,"ng-select",28),e.TgZ(36,"label",29),e._uU(37,"Assessment Reqd: "),e.qZA(),e._UZ(38,"input",30),e._uU(39,"Yes "),e._UZ(40,"input",31),e._uU(41,"No "),e.qZA()}if(2&o){const t=e.oxw();e.xp6(7),e.Oqu(t.reviewItem.customerName),e.xp6(4),e.AsE("",t.reviewItem.orderNo," dtd: ",e.xi3(12,9,t.reviewItem.orderDate,"dd-MMM-yy"),""),e.xp6(9),e.Oqu(t.reviewItem.professionName),e.xp6(3),e.Q6J("label","Charges"),e.xp6(4),e.Q6J("ngIf",t.empIdAndNames),e.xp6(3),e.Q6J("ngIf",!t.skills),e.xp6(1),e.Q6J("ngIf",t.skills),e.xp6(4),e.Q6J("ngIf",t.reviewStatus)}}function Me(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"div",36),e._UZ(2,"input",37)(3,"input",38)(4,"app-text-input",39)(5,"input",40)(6,"app-text-input",41),e.TgZ(7,"button",42),e.NdJ("click",function(){const n=e.CHM(t).index,a=e.oxw();return e.KtG(a.removeQ(n))}),e.qZA()()()}if(2&o){const t=d.index;e.xp6(1),e.Q6J("formGroupName",t),e.xp6(3),e.Q6J("label","Parameter"),e.xp6(2),e.Q6J("label","Remarks")}}let K=(()=>{class o{constructor(t,r,s,n,a,l,p){this.bsModalRef=t,this.empService=r,this.fb=s,this.router=n,this.activatedRoute=a,this.service=l,this.confirm=p,this.updateModalReview=new e.vpe,this.form=new i.cw({}),this.isAddMode=!1,this.reviewStatus=[{name:"Not Reviewed"},{name:"Accepted"},{name:"Rejected"}],this.empIdAndNames=[],this.skills=[],this.stddQs=[],this.itemQsExist=!1;let w=this.router.getCurrentNavigation();w?.extras&&w.extras.state&&w.extras.state.user&&(this.user=w.extras.state.user),r.getEmployeeIdAndKnownAs().subscribe({next:T=>this.empIdAndNames=T})}ngOnInit(){this.reviewItem&&this.createAndInitializeForm(this.reviewItem)}createAndInitializeForm(t){this.form=this.fb.group({id:t.id??0,orderId:t.orderId??0,orderItemId:t.orderItemId??0,professionName:t.professionName??"",quantity:t.quantity??0,ecnr:t.ecnr??!1,contractReviewId:[t.contractReviewId??0,i.kI.required],sourceFrom:t.sourceFrom??"India",requireAssess:[t.requireAssess??!1,i.kI.required],charges:t.charges??0,hrExecUsername:[t.hrExecUsername??"",i.kI.required],reviewItemStatus:[t.reviewItemStatus??"Not Reviewed",i.kI.required],orderDate:t.orderDate??new Date,customerName:[t.customerName??"",i.kI.required],contractReviewItemQs:this.fb.array(t.contractReviewItemQs.map(n=>this.fb.group({id:n.id??0,orderItemId:n.orderItemId??0,contractReviewItemId:[n.contractReviewItemId??0,i.kI.required],srNo:n.srNo??0,reviewParameter:[n.reviewParameter??"",i.kI.required],response:n.response??!1,responseText:n.responseText??"",isResponseBoolean:n.isResponseBoolean??!1,isMandatoryTrue:n.isMandatoryTrue??!1,remarks:n.remarks??""})))});var r=this.form.get("hrExecUsername").value;if(r){var s=this.empIdAndNames.filter(n=>n.username===r)[0];this.skills=s?.hrSkills?.map(n=>n.professionName)}}get contractReviewItemQs(){return this.form.get("contractReviewItemQs")}addQ(){this.contractReviewItemQs.push(this.newQ())}removeQ(t){this.contractReviewItemQs.removeAt(t),this.contractReviewItemQs.markAsDirty(),this.contractReviewItemQs.markAsTouched()}confirmUpdate(){this.service.updateContractReviewItem(this.form.value).subscribe(t=>{this.updateModalReview.emit(t)}),this.bsModalRef.hide()}decline(){this.bsModalRef.hide()}employeeChanged(t){console.log("emplotyeecanged event:",t),this.skills=t.hrSkills.map(r=>r.professionName)}newQ(){var t=0===this.contractReviewItemQs.length?1:Math.max(...this.contractReviewItemQs.value.map(r=>r.srNo))+1;return this.fb.group({id:0,orderItemId:this.reviewItem.orderItemId??0,contractReviewItemId:[this.reviewItem.id??0,i.kI.required],srNo:t,reviewParameter:["",i.kI.required],response:!1,responseText:"",isResponseBoolean:!1,isMandatoryTrue:!1,remarks:""})}static#e=this.\u0275fac=function(r){return new(r||o)(e.Y36(I.UZ),e.Y36(z.G),e.Y36(i.qu),e.Y36(u.F0),e.Y36(u.gz),e.Y36(P),e.Y36(O.z))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-order-item-review"]],outputs:{updateModalReview:"updateModalReview"},decls:24,vars:6,consts:[[2,"margin-left","20px",3,"formGroup"],["class","my-2 mx-2",4,"ngIf"],[2,"font-size","small","vertical-align","middle"],[1,"lbl","w35"],[1,"lbl","mL10","w350"],[1,"lbl","w75"],[1,"lbl","w150"],["title","add a new Review Question",1,"btn","fa","fa-plus",3,"click"],["formArrayName","contractReviewItemQs",1,"mt-2","my-1","px-0"],[4,"ngFor","ngForOf"],[2,"font-size","x-small"],[1,"my-2","mx-2"],[1,"my-2","b"],[1,"title"],[2,"font-weight","bold"],[1,"title","mx-4"],["type","button",1,"mL15","btn","btn-success","fa","fa-save",2,"display","inline-block",3,"click"],["type","button",1,"btn","fa","fa-window-close","fa-2x",2,"display","inline-block",3,"click"],[1,"title","b"],[1,"title","w350"],[1,"title","mx-2","hAlignR"],["formControlName","charges",1,"stdd","w75",3,"label"],[1,"title","w100"],["class","stdd w150","bindLabel","knownAs","bindValue","username","labelForId","username","clearAllText","Clear","formControlName","hrExecUsername",3,"items","change",4,"ngIf"],[1,"stdd","my-0",2,"font-size","x-small"],["class","stdd my-0 cursorpointer","title","click the HR Exec Username to display his skill set",4,"ngIf"],["class","stdd my-0","style","width: 450px; font-size: x-small",4,"ngIf"],[1,"title","w150"],["class","stdd w150","bindLabel","name","bindValue","name","labelForId","reviewItemStatus","clearAllText","Clear","formControlName","reviewItemStatus",3,"items",4,"ngIf"],[1,"lbl","w150","b","my-2","hAlignR"],["type","radio","value","1","formControlName","requireAssess",1,"inputcheck","form-check-input","mx-2"],["type","radio","value","0","formControlName","requireAssess",1,"inputcheck","form-check-input","mx-2"],["bindLabel","knownAs","bindValue","username","labelForId","username","clearAllText","Clear","formControlName","hrExecUsername",1,"stdd","w150",3,"items","change"],["title","click the HR Exec Username to display his skill set",1,"stdd","my-0","cursorpointer"],[1,"stdd","my-0",2,"width","450px","font-size","x-small"],["bindLabel","name","bindValue","name","labelForId","reviewItemStatus","clearAllText","Clear","formControlName","reviewItemStatus",1,"stdd","w150",3,"items"],[3,"formGroupName"],["type","text","formControlName","srNo",1,"std","w35"],["type","checkbox","formControlName","isMandatoryTrue",1,"stdd","w35"],["formControlName","reviewParameter",1,"stdd","w350",2,"font-size","small",3,"label"],["type","checkbox","formControlName","response",1,"stdd","w75"],["formControlName","remarks",1,"stdd","w150",2,"font-size","small",3,"label"],[1,"btn","mL10","fa","fa-trash","fa-sm","red",3,"click"]],template:function(r,s){1&r&&(e.TgZ(0,"form",0),e.YNc(1,Te,42,12,"div",1),e._UZ(2,"br"),e.TgZ(3,"div",2)(4,"label",3),e._uU(5,"Sr#"),e.qZA(),e.TgZ(6,"label",3),e._uU(7,"Manda-"),e._UZ(8,"br"),e._uU(9,"tory"),e.qZA(),e.TgZ(10,"label",4),e._uU(11,"Parameter"),e.qZA(),e.TgZ(12,"label",5),e._uU(13,"Response"),e._UZ(14,"br"),e._uU(15,"YES"),e.qZA(),e.TgZ(16,"label",6),e._uU(17,"Remarks"),e.qZA(),e.TgZ(18,"button",7),e.NdJ("click",function(){return s.addQ()}),e.qZA(),e.TgZ(19,"div",8),e.YNc(20,Me,8,3,"div",9),e.qZA()()(),e.TgZ(21,"div",10),e._uU(22),e.ALo(23,"json"),e.qZA()),2&r&&(e.Q6J("formGroup",s.form),e.xp6(1),e.Q6J("ngIf",void 0!==s.reviewItem),e.xp6(19),e.Q6J("ngForOf",s.contractReviewItemQs.controls),e.xp6(2),e.Oqu(e.lcZ(23,4,s.form.value)))},dependencies:[c.sg,c.O5,i._Y,i.Fj,i.Wl,i._,i.JJ,i.JL,i.sg,i.u,i.x0,i.CE,R.w9,Z.t,c.Ts,c.uU],styles:['.lbl[_ngcontent-%COMP%]{display:inline-block;font-size:small;font-weight:700;margin:0 2px;vertical-align:middle}.stdd[_ngcontent-%COMP%]{display:inline-block;font-size:small;margin:0 2px;padding:0}.std[_ngcontent-%COMP%]{display:inline-block;font-size:smaller;text-align:left}.title[_ngcontent-%COMP%]{display:inline-block;font-size:small}.hAlignR[_ngcontent-%COMP%]{text-align:right}.b[_ngcontent-%COMP%]{font-weight:700}.red[_ngcontent-%COMP%]{color:red}.w35[_ngcontent-%COMP%]{width:35px}.w50[_ngcontent-%COMP%]{width:50px}.w75[_ngcontent-%COMP%]{width:75px}.w100[_ngcontent-%COMP%]{width:100px}.w150[_ngcontent-%COMP%]{width:150px}.w200[_ngcontent-%COMP%]{width:200px}.w350[_ngcontent-%COMP%]{width:350px}.mL15[_ngcontent-%COMP%]{margin-left:15px}.mL10[_ngcontent-%COMP%]{margin-left:10px}.inputCheck[_ngcontent-%COMP%]{margin:0 5px 0 10px;width:40px;border:2px;border-color:#000;vertical-align:bottom}input[type=radio][_ngcontent-%COMP%]{appearance:none;-webkit-appearance:none;width:20px;height:20px;border:1px solid #fff;border-radius:50%;margin:0 10px 0 5px;background-color:#c3b1b1;position:relative}input[type=radio][_ngcontent-%COMP%]:checked:before{content:"";display:block;width:12px;height:12px;background-color:#4a0fec;border-radius:50%;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);animation:appear .8s}.cursorpointer[_ngcontent-%COMP%]{cursor:pointer;font-size:smaller;font-weight:700}']})}return o})();function ke(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"h4",3),e._uU(3,"Job Description "),e.qZA(),e.TgZ(4,"button",4),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.confirm())}),e.qZA(),e.TgZ(5,"button",5),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.decline())}),e.qZA()(),e.TgZ(6,"div",6)(7,"div")(8,"strong"),e._uU(9,"Customer: "),e.qZA(),e._uU(10),e.qZA(),e.TgZ(11,"div")(12,"strong"),e._uU(13,"Order No.:"),e.qZA(),e._uU(14),e.ALo(15,"date"),e.qZA(),e.TgZ(16,"div")(17,"strong"),e._uU(18,"Category: "),e.qZA(),e._uU(19),e.qZA(),e.TgZ(20,"form",7,8)(22,"strong"),e._uU(23,"Qualification"),e.qZA(),e.TgZ(24,"input",9),e.NdJ("ngModelChange",function(s){e.CHM(t);const n=e.oxw();return e.KtG(n.jd.qualificationDesired=s)}),e.qZA(),e._UZ(25,"br"),e.TgZ(26,"label",10),e._uU(27,"Exp (in yrs):"),e.qZA(),e.TgZ(28,"label",11),e._uU(29,"From: "),e.qZA(),e.TgZ(30,"input",12),e.NdJ("ngModelChange",function(s){e.CHM(t);const n=e.oxw();return e.KtG(n.jd.expDesiredMin=s)}),e.qZA(),e.TgZ(31,"label",13),e._uU(32,"to: "),e.qZA(),e.TgZ(33,"input",14),e.NdJ("ngModelChange",function(s){e.CHM(t);const n=e.oxw();return e.KtG(n.jd.expDesiredMax=s)}),e.qZA(),e._UZ(34,"br"),e.TgZ(35,"label",10),e._uU(36,"Age (in yrs):"),e.qZA(),e.TgZ(37,"label",15),e._uU(38,"From: "),e.qZA(),e.TgZ(39,"input",16),e.NdJ("ngModelChange",function(s){e.CHM(t);const n=e.oxw();return e.KtG(n.jd.minAge=s)}),e.qZA(),e.TgZ(40,"label",17),e._uU(41,"to: "),e.qZA(),e.TgZ(42,"input",18),e.NdJ("ngModelChange",function(s){e.CHM(t);const n=e.oxw();return e.KtG(n.jd.maxAge=s)}),e.qZA(),e._UZ(43,"br"),e.TgZ(44,"strong"),e._uU(45,"Job Description"),e.qZA(),e._UZ(46,"br"),e.TgZ(47,"textarea",19),e.NdJ("ngModelChange",function(s){e.CHM(t);const n=e.oxw();return e.KtG(n.jd.jobDescInBrief=s)}),e._uU(48," "),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(10),e.hij(" ",t.jd.companyName," "),e.xp6(4),e.AsE(" ",t.jd.orderNo," dt ",e.lcZ(15,10,t.jd.orderDate)," "),e.xp6(5),e.hij("",t.jd.categoryName," "),e.xp6(5),e.Q6J("ngModel",t.jd.qualificationDesired),e.xp6(6),e.Q6J("ngModel",t.jd.expDesiredMin),e.xp6(3),e.Q6J("ngModel",t.jd.expDesiredMax),e.xp6(6),e.Q6J("ngModel",t.jd.minAge),e.xp6(3),e.Q6J("ngModel",t.jd.maxAge),e.xp6(5),e.Q6J("ngModel",t.jd.jobDescInBrief)}}let ye=(()=>{class o{constructor(t,r,s){this.service=t,this.bsModalRef=r,this.fb=s,this.updateSelectedJD=new e.vpe,this.title="",this.closeBtnName="",this.form=new i.cw({})}ngOnInit(){}confirm(){this.jd&&this.service.updateJD({id:this.jd.id,orderItemId:this.jd.orderItemId,orderNo:this.jd.orderNo,jobDescInBrief:this.jd.jobDescInBrief,qualificationDesired:this.jd.qualificationDesired,minAge:this.jd.minAge,maxAge:this.jd.maxAge,expDesiredMax:this.jd.expDesiredMax,expDesiredMin:this.jd.expDesiredMin}).subscribe({next:r=>{this.updateSelectedJD.emit(r),r&&this.bsModalRef.hide()},error:r=>this.updateSelectedJD.emit(!1)})}decline(){this.bsModalRef.hide()}static#e=this.\u0275fac=function(r){return new(r||o)(e.Y36(y.p),e.Y36(I.UZ),e.Y36(i.qu))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-jd-modal"]],outputs:{updateSelectedJD:"updateSelectedJD"},decls:1,vars:1,consts:[["class","mx-2 my-1",4,"ngIf"],[1,"mx-2","my-1"],[1,"modal-header","my-0"],[2,"font-weight","bold"],["type","button",1,"btn","btn-success","mx-5","fa","fa-save",3,"click"],["type","button",1,"btn","btn-secondary","fa","fa-window-close","fa-2x",3,"click"],[1,"modal-body","my-9"],["id","jdForm"],["jdForm","ngForm"],["id","qualificationDesired","name","qualificationDesired","type","text",1,"form-text-input",2,"width","200px",3,"ngModel","ngModelChange"],[2,"font-weight","bold","margin-right","2px"],["for","expDesiredMin",2,"font-weight","bold","margin-right","2px"],["type","text","id","expDesiredMin","name","expDesiredMin",1,"form-text-input","stdd","w50","tAlignR",3,"ngModel","ngModelChange"],["for","expDesiredMax",2,"font-weight","bold","margin-left","2px"],["type","text","id","expDesiredMax","name","expDesiredMax",1,"form-text-input","stdd","w50","tAlignR",3,"ngModel","ngModelChange"],["for","minAge",2,"font-weight","bold","margin-right","2px"],["type","text","id","minAge","name","minAge",1,"form-text-input","stdd","w50","tAlignR",3,"ngModel","ngModelChange"],["for","maxAge",2,"font-weight","bold","margin-left","2px"],["type","text","id","maxAge","name","maxAge",1,"form-text-input","stdd","w50","tAlignR",3,"ngModel","ngModelChange"],["type","text","id","jobDescInBrief","name","jobDescInBrief","cols","50","rows","6",1,"form-text-input",3,"ngModel","ngModelChange"]],template:function(r,s){1&r&&e.YNc(0,ke,49,12,"div",0),2&r&&e.Q6J("ngIf",null!=s.jd)},dependencies:[c.O5,i._Y,i.Fj,i.JJ,i.JL,i.On,i.F,c.uU],styles:[".stdd[_ngcontent-%COMP%]{margin:2px;padding:2px;display:inline-block!important}.w100[_ngcontent-%COMP%]{width:100px}.w250[_ngcontent-%COMP%]{width:250px}.w50[_ngcontent-%COMP%]{width:50px}.tAlignR[_ngcontent-%COMP%]{text-align:right}"]})}return o})();var Ne=m(675),qe=m(7328);class Fe{constructor(){this.orderItemId=0,this.orderId=0,this.categoryId=0,this.search=""}}let C=(()=>{class o{constructor(t,r,s,n){this.activatedRoute=t,this.router=r,this.accountService=s,this.http=n,this.apiUrl=M.N.apiUrl,this.currentUserSource=new qe.t(1),this.currentUser$=this.currentUserSource.asObservable(),this.qParams=new Fe,this.routeId="",this.accountService.currentUser$.pipe((0,E.q)(1)).subscribe(a=>this.user=a)}getOrderAssessmentItem(t){return this.http.get(this.apiUrl+"OrderAssessment/orderassessmentitem/"+t)}getOrderAssessment(t){return this.http.get(this.apiUrl+"OrderAssessment/orderAssessment/"+t)}updateOrderAssessment(t){return this.http.put(this.apiUrl+"OrderAssessment/assessment",t)}deleteAssessmentQ(t){return this.http.delete(this.apiUrl+"orderassessment/assessmentq/"+t)}deleteAssessment(t){return this.http.delete(this.apiUrl+"orderassessment/assessment/"+t)}AddNewAssessment(t){return this.http.post(this.apiUrl+"OrderAssessment/assessment",t)}getOrderAssessmentItemQsFromOrderItemId(t){return this.http.get(this.apiUrl+"OrderAssessment/orderassessmentItemQsFromOrderItemId/"+t)}updateOrderAssessmentItem(t){return this.http.put(this.apiUrl+"OrderAssessment/assessmentitem",t)}deleteOrderAssessmentItem(t){return this.http.delete(this.apiUrl+"OrderAssessment/assessmentitemq/"+t)}InsertOrderAssessmentItem(t){return this.http.post(this.apiUrl+"OrderAssessment/assessmentitem",t)}getAssessmentQBankOfCategoryId(t){return this.http.get(this.apiUrl+"AssessmentQBank/questionsFromQBank/"+t)}getAssessmentQStandard(){return this.http.get(this.apiUrl+"OrderAssessment/assessmentStddQs")}getContractReviewItemDto(t){return this.http.get(this.apiUrl+"ContractReview/")}getOrderAssessmentItemHeaderFromProfessionGroup(t){return this.http.get(this.apiUrl+"OrderAssessment/assessmentItemHeaders/"+t)}getOrderAssessmentItemQsFromId(t){return this.http.get(this.apiUrl+"OrderAssessment/orderassessmentItemQs/"+t)}getAndSetProfessionGroupFromProfId(t,r){return this.http.get(this.apiUrl+"OrderAssessment/getAndSetProfessionGroup/"+t+"/"+r)}static#e=this.\u0275fac=function(r){return new(r||o)(e.LFG(u.gz),e.LFG(u.F0),e.LFG(Y.B),e.LFG(A.eN))};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var v=m(3593);function Ue(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"input",5),e.NdJ("ngModelChange",function(s){const a=e.CHM(t).$implicit;return e.KtG(a.checked=s)})("click",function(){const n=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.selectedClicked(n.id))}),e.qZA(),e.TgZ(2,"div",6),e._uU(3),e.qZA(),e.TgZ(4,"div",7),e._uU(5),e.qZA(),e.TgZ(6,"div",6),e._uU(7),e.qZA(),e.TgZ(8,"div",8),e._uU(9),e.ALo(10,"date"),e.qZA()()}if(2&o){const t=d.$implicit;e.xp6(1),e.Q6J("ngModel",t.checked),e.xp6(2),e.Oqu(t.customerName),e.xp6(2),e.Oqu(t.categoryRef),e.xp6(2),e.Oqu(t.professionName),e.xp6(2),e.Oqu(e.xi3(10,5,t.dateDesigned,"ddMMMyy"))}}function Qe(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div",1)(1,"button",2),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.populateQs())}),e.qZA(),e.TgZ(2,"button",3),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.closeClicked())}),e.qZA(),e.YNc(3,Ue,11,8,"div",4),e.qZA()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("disabled",null===t.headers),e.xp6(2),e.Q6J("ngForOf",t.headers)}}let Pe=(()=>{class o{constructor(t){this.service=t,this.profGroup="",this.sectionCloseEvent=new e.vpe,this.targetAssessmentItemQsEvent=new e.vpe,this.headers=[],this.assessmentItemProfessionGroupSelected=""}ngOnInit(){this.service.getOrderAssessmentItemHeaderFromProfessionGroup(this.profGroup).subscribe({next:t=>{this.headers=t,this.sectionCloseEvent.emit(!0)}})}populateQs(){var t=this.headers.filter(r=>!0===r.checked).map(r=>r.orderItemId);null!=t&&this.service.getOrderAssessmentItemQsFromOrderItemId(+t).subscribe({next:r=>{console.log("response:",r,"targetassessmentitem:",this.targetAssessmentItem),this.targetAssessmentItemQsEvent.emit(r)}})}selectedClicked(t){this.headers.forEach(r=>{r.id!==t&&(r.checked=!1)})}closeClicked(){this.sectionCloseEvent.emit(!0)}static#e=this.\u0275fac=function(r){return new(r||o)(e.Y36(C))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-order-assessment-item-header"]],inputs:{profGroup:"profGroup",targetAssessmentItem:"targetAssessmentItem"},outputs:{sectionCloseEvent:"sectionCloseEvent",targetAssessmentItemQsEvent:"targetAssessmentItemQsEvent"},decls:1,vars:1,consts:[["style","border-style: solid; border-color: yellow;",4,"ngIf"],[2,"border-style","solid","border-color","yellow"],["title","On selecting a Assessment Item, click this to populate the current Order Assessment Item Parameters",1,"btn","fa","fa-check",3,"disabled","click"],[1,"btn","fa","fa-window-close",3,"click"],[4,"ngFor","ngForOf"],["type","checkbox",1,"form-check-input","w20","hAlignCenter",2,"margin-left","25px","border-color","black",3,"ngModel","ngModelChange","click"],[1,"stdd","w200"],[1,"stdd","w50"],[1,"stdd","w90"]],template:function(r,s){1&r&&e.YNc(0,Qe,4,2,"div",0),2&r&&e.Q6J("ngIf",s.headers&&s.headers.length>0)},dependencies:[c.sg,c.O5,i.Wl,i.JJ,i.On,c.uU],styles:[".w20[_ngcontent-%COMP%]{width:20px}.w50[_ngcontent-%COMP%]{width:50px}.w90[_ngcontent-%COMP%]{width:90px}.w200[_ngcontent-%COMP%]{width:200px}.stdd[_ngcontent-%COMP%]{display:inline-block;margin:0 2px;font-size:smaller}.hAlignCenter[_ngcontent-%COMP%]{text-align:center}"]})}return o})();function Re(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"app-order-assessment-item-header",31),e.NdJ("sectionCloseEvent",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.closeSection())})("targetAssessmentItemQsEvent",function(s){e.CHM(t);const n=e.oxw(2);return e.KtG(n.assessmentQsEmitted(s))}),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("profGroup",t.orderAssessmentItem.professionGroup)("targetAssessmentItem",t.orderAssessmentItem)}}function Je(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"div",32)(2,"div",33),e._UZ(3,"app-text-input",34),e.qZA(),e.TgZ(4,"div",35),e._UZ(5,"app-text-input",36),e.qZA(),e._UZ(6,"textarea",37),e.TgZ(7,"app-text-input",38),e.NdJ("change",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.calcualteTotals())}),e.qZA(),e._UZ(8,"input",39),e.TgZ(9,"button",40),e.NdJ("click",function(){const n=e.CHM(t).index,a=e.oxw(2);return e.KtG(a.removeOrderAssessmentItemQ(n))}),e.qZA()()()}if(2&o){const t=d.index;e.xp6(1),e.Q6J("formGroupName",t),e.xp6(2),e.Q6J("label","Question No"),e.xp6(2),e.Q6J("label","Subject"),e.xp6(2),e.Q6J("label","Points")}}const De=function(){return{dateInputFormat:"YYYY-MM-DD"}};function Se(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"form",5),e.NdJ("ngSubmit",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.form.valid)}),e.TgZ(1,"label",6),e._uU(2,"Order No.:"),e.qZA(),e.TgZ(3,"div",7),e._uU(4),e.qZA(),e.TgZ(5,"label",8),e._uU(6,"Customer"),e.qZA(),e.TgZ(7,"div",9),e._uU(8),e.qZA(),e._UZ(9,"br"),e.TgZ(10,"label",8),e._uU(11,"Category"),e.qZA(),e.TgZ(12,"div",9),e._uU(13),e.qZA(),e.TgZ(14,"label",8),e._uU(15,"Prof Group:"),e.qZA(),e.TgZ(16,"div",10),e.NdJ("dblclick",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.getProfessionGroup())}),e._uU(17),e.qZA(),e._UZ(18,"br"),e.TgZ(19,"label",11),e._uU(20,"Designed By"),e.qZA(),e._UZ(21,"app-text-input",12),e.TgZ(22,"label",13),e._uU(23,"On"),e.qZA(),e._UZ(24,"input",14),e.TgZ(25,"label",15),e._uU(26,"Approved By"),e.qZA(),e.TgZ(27,"input",16),e.NdJ("dblclick",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.updateApprovedBy())}),e.qZA(),e.TgZ(28,"button",17),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.populateStddAssessmentQuestions())}),e.qZA(),e.TgZ(29,"button",18),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.populateCustomAssessmentQuestions())}),e.qZA(),e.TgZ(30,"button",19),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.update())}),e.qZA(),e.TgZ(31,"button",20),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.cancel())}),e.qZA(),e.TgZ(32,"button",21),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.copyProfGroup())}),e.qZA(),e.YNc(33,Re,2,2,"div",22),e.TgZ(34,"div",23)(35,"label",24),e._uU(36,"Q No"),e.qZA(),e.TgZ(37,"label",25),e._uU(38,"Subject"),e.qZA(),e.TgZ(39,"label",26),e._uU(40,"Question"),e.qZA(),e.TgZ(41,"label",24),e._uU(42,"Points"),e.qZA(),e.TgZ(43,"label",27),e._uU(44,"Manda"),e._UZ(45,"br"),e._uU(46,"tory"),e.qZA(),e.TgZ(47,"button",28),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.addNewOrderAssessmentItemQ())}),e.qZA(),e.YNc(48,Je,10,4,"div",29),e.TgZ(49,"div",30),e._uU(50),e.qZA()()()}if(2&o){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(4),e.hij("",t.orderAssessmentItem.orderNo," "),e.xp6(4),e.Oqu(t.orderAssessmentItem.customerName),e.xp6(5),e.Oqu(t.orderAssessmentItem.professionName),e.xp6(4),e.Oqu(t.orderAssessmentItem.professionGroup),e.xp6(4),e.Q6J("label","Designed By"),e.xp6(3),e.Q6J("bsValue",t.bsValueDate)("bsConfig",e.DdM(11,De)),e.xp6(9),e.Q6J("ngIf",t.copyAssessmentQs),e.xp6(15),e.Q6J("ngForOf",t.orderAssessmentItemQs.controls),e.xp6(2),e.hij("Total: ",t.totalMarks,"")}}let Ee=(()=>{class o{constructor(t,r,s,n,a){this.fb=t,this.confirm=r,this.bsModalService=s,this.service=n,this.toastr=a,this.form=new i.cw({}),this.cancelRegister=new e.vpe,this.updateEvent=new e.vpe,this.returnUrl="",this.professionId=0,this.copyAssessmentQs=!1,this.totalMarks=0,this.bsValueDate=new Date}ngOnInit(){this.orderAssessmentItem&&(this.CreateAndInitializeFormArray(this.orderAssessmentItem),this.calcualteTotals(),this.professionId=this.orderAssessmentItem?.professionId)}CreateAndInitializeFormArray(t){console.log("item in createandinitiaize:",t),this.form=this.fb.group({id:[t.id],orderAssessmentId:[t.orderAssessmentId],orderItemId:[t.orderItemId,i.kI.required],orderId:[t.orderId,i.kI.required],orderNo:[t.orderNo,i.kI.required],customerName:[t.customerName,i.kI.required],professionId:[t.professionId,i.kI.required],professionName:[t.professionName,i.kI.required],professionGroup:[t.professionGroup??""],designedBy:[t.designedBy],dateDesigned:[t.dateDesigned??new Date],approvedBy:[t.approvedBy],orderAssessmentItemQs:this.fb.array(t.orderAssessmentItemQs.map(r=>this.fb.group({id:[r.id??0],orderAssessmentItemId:r.orderAssessmentItemId,orderItemId:[r.orderItemId,i.kI.required],orderId:r.orderId,questionNo:[r.questionNo,i.kI.required],subject:[r.subject,i.kI.required],question:[r.question,i.kI.required],maxPoints:[r.maxPoints,i.kI.required],isMandatory:[r.isMandatory,i.kI.required]})))})}get orderAssessmentItemQs(){return this.form.get("orderAssessmentItemQs")}newOrderAssessmentItemQ(){return this.fb.group({id:0,orderAssessmentItemId:this.form.get("id")?.value,orderItemId:[this.form.get("orderItemId")?.value,i.kI.required],orderId:[this.form.get("orderId")?.value,i.kI.required],questionNo:[0===this.orderAssessmentItemQs.length?1:Math.max(...this.orderAssessmentItemQs.value.map(t=>t.questionNo))+1,i.kI.required],subject:["",i.kI.required],question:["",i.kI.required],maxPoints:[0,i.kI.required],isMandatory:[!1,i.kI.required]})}newOrderAssessmentItemQFromStddQ(t){t.forEach(r=>{this.orderAssessmentItemQs.push(this.fb.group({orderAssessmentItemId:r.orderAssessmentItemId,orderItemId:[r.orderItemId,i.kI.required],orderId:[r.orderId,i.kI.required],questionNo:[r.questionNo,i.kI.required],subject:[r.subject,i.kI.required],question:[r.question,i.kI.required],maxPoints:[r.maxPoints,i.kI.required],isMandatory:[r.isMandatory,i.kI.required]}))})}addNewOrderAssessmentItemQ(){this.orderAssessmentItemQs.push(this.newOrderAssessmentItemQ())}removeOrderAssessmentItemQ(t){this.orderAssessmentItemQs.removeAt(t)}cancel(){this.cancelRegister.emit(!1),this.bsModalService.hide()}update(){this.service.updateOrderAssessmentItem(this.form.value).subscribe({next:t=>{t?(this.updateEvent.emit(!0),this.toastr.success("Order Assessment Item successfully updated","success"),this.bsModalService.hide()):this.toastr.warning("failed to update the order assessment item","Failed to update")}})}calcualteTotals(){this.totalMarks=this.form.get("orderAssessmentItemQs")?.value.map(t=>t.maxPoints).reduce((t,r)=>+t+ +r),console.log("total marks:",this.totalMarks)}populateStddAssessmentQuestions(){const t=this.service.getAssessmentQStandard();this.confirm.confirm("confirm Copy standard assessment Questions","This will replace any existing Assessment Questions, and replace it with the standard Assessment QuestionsPress OK to proceed, CANCEL to abort").pipe((0,h.h)(s=>s),(0,g.w)(()=>t)).subscribe(s=>{s.length>0?(this.orderAssessmentItemQs.clear(),this.newOrderAssessmentItemQFromStddQ(s)):this.toastr.warning("Failed to retrieve the standard assessment Questions")})}populateCustomAssessmentQuestions(){var t=this.form.get("professionId")?.value;const r=this.service.getAssessmentQBankOfCategoryId(t);this.confirm.confirm("confirm Copy Custom assessment Questions","This will replace any existing Assessment Questions, and replace it with the standard Assessment QuestionsPress OK to proceed, CANCEL to abort").pipe((0,h.h)(n=>n),(0,g.w)(()=>r)).subscribe(n=>{null!==n?(this.orderAssessmentItemQs.clear(),n.assessmentStddQs.forEach(a=>{var l={id:0,orderAssessmentItemId:this.orderAssessmentItem.id,orderItemId:this.orderAssessmentItem.orderItemId,orderId:this.orderAssessmentItem.orderId,questionNo:a.questionNo,question:a.question,subject:a.subject,maxPoints:a.maxPoints,isMandatory:!1};this.orderAssessmentItem?.orderAssessmentItemQs.push(l)})):this.toastr.warning("No custom assessment parameters exist for the chosen category","Parameters Not Found")})}updateApprovedBy(){this.user&&(this.form.value.approvedBy=this.user.userName,this.form.get("approvedBy")?.setValue(this.user.userName))}closeSection(){}getProfessionGroup(){var t=this.form.get("professionId")?.value,r=this.form.get("id")?.value;this.service.getAndSetProfessionGroupFromProfId(t,r).subscribe({next:s=>{""===s.stringValue?this.toastr.warning("No Order Assessment Items exist matching the desired profession Group "+this.form.get("professionGroup")?.value,"No matching assessments exist"):this.orderAssessmentItem.professionGroup=s.stringValue},error:s=>console.log(s.error?.details,"Error encountered in getProfessionGroup")})}copyProfGroup(){if(this.copyAssessmentQs=!this.copyAssessmentQs,this.copyAssessmentQs&&this.getProfessionGroup(),this.copyAssessmentQs){var r=this.form.get("professionGroup")?.value;this.service.getOrderAssessmentItemHeaderFromProfessionGroup(r).subscribe({next:s=>{if(console.log(s),0===s.length)return this.toastr.warning("this profession Group does not have any corresponding Order Assessment Items defined","not found"),void(this.copyAssessmentQs=!1)}})}}assessmentQsEmitted(t){this.orderAssessmentItemQs.clear(),this.newOrderAssessmentItemQFromStddQ(t),this.calcualteTotals(),this.copyAssessmentQs=!1}static#e=this.\u0275fac=function(r){return new(r||o)(e.Y36(i.qu),e.Y36(O.z),e.Y36(I.tT),e.Y36(C),e.Y36(_._W))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-order-assessment-item-modal"]],outputs:{cancelRegister:"cancelRegister",updateEvent:"updateEvent"},decls:8,vars:4,consts:[[1,"modal-body","my-0"],[2,"font-weight","bold"],["autocomplete","off",3,"formGroup","ngSubmit",4,"ngIf"],[1,"modal-footer"],[2,"font-size","x-small"],["autocomplete","off",3,"formGroup","ngSubmit"],[1,"lbl","b","100"],[1,"stdd","w75"],[1,"lbl","w75"],[1,"stdd","w200"],[1,"stdd","w200","borderAllaround",3,"dblclick"],[1,"lbl","w100"],["formControlName","designedBy",1,"stdd","w75",3,"label"],[1,"lbl","w50","hAlignR"],["type","text","placeholder","designed On","formControlName","dateDesigned","bsDatepicker","",1,"stdd","w75",3,"bsValue","bsConfig"],[1,"lbl","w75","fSmaller"],["type","text","formControlName","approvedBy",1,"stdd","w75",3,"dblclick"],["title","imports standard assessment questions",1,"btn","fa","fa-list",3,"click"],["title","imports custom assessment questions matching the profession",1,"btn","fa","fa-list-ul",3,"click"],["title","Save this data",1,"btn","fa","fa-save",3,"click"],["title","close this form and return to the calling program",1,"btn","fa","fa-window-close","fa-2x",3,"click"],["title","Retrieve Profession Group from Profession Object",1,"btn","fa","fa-copy",3,"click"],[4,"ngIf"],["formArrayName","orderAssessmentItemQs"],[1,"lbl","w50"],[1,"lbl","w150"],[1,"lbl","w400"],[1,"w40",2,"display","inline-block","font-size","x-small","vertical-align","middle"],["type","button",1,"stdd","btn","btn-priamry","fa","fa-plus",3,"click"],[4,"ngFor","ngForOf"],[2,"margin-left","600px"],[3,"profGroup","targetAssessmentItem","sectionCloseEvent","targetAssessmentItemQsEvent"],[3,"formGroupName"],[1,"stdd","w50"],["formControlName","questionNo",3,"label"],[1,"stdd","w150"],["formControlName","subject",3,"label"],["cols","60","rows","1","formControlName","question","placeholder","assessment parameter",1,"stdd"],["formControlName","maxPoints",1,"stdd","w50",3,"label","change"],["type","checkbox","formControlName","isMandatory",1,"stdd"],[1,"btn","fa","fa-trash","red",3,"click"]],template:function(r,s){1&r&&(e.TgZ(0,"div",0)(1,"h4",1),e._uU(2,"Define Assessment parameters for Order Item "),e.qZA(),e.YNc(3,Se,51,12,"form",2),e.qZA(),e._UZ(4,"div",3),e.TgZ(5,"div",4),e._uU(6),e.ALo(7,"json"),e.qZA()),2&r&&(e.xp6(3),e.Q6J("ngIf",s.orderAssessmentItem),e.xp6(3),e.Oqu(e.lcZ(7,2,s.form.value)))},dependencies:[c.sg,c.O5,i._Y,i.Fj,i.Wl,i.JJ,i.JL,v.Np,v.Y5,i.sg,i.u,i.x0,i.CE,Z.t,Pe,c.Ts],styles:[".stdd[_ngcontent-%COMP%]{display:inline-block;font-size:small;margin:0 2px;vertical-align:top}.btn[_ngcontent-%COMP%]{vertical-align:top;margin:0;font-size:medium}.fSmaller[_ngcontent-%COMP%]{font-size:smaller!important}.lbl[_ngcontent-%COMP%]{display:inline-block;font-size:small;font-weight:700;margin:0 2px}.borderAllaround[_ngcontent-%COMP%]{border-style:solid;border-color:#ff0}.w50[_ngcontent-%COMP%]{width:50px}.w75[_ngcontent-%COMP%]{width:75px}.w100[_ngcontent-%COMP%]{width:100px}.w150[_ngcontent-%COMP%]{width:150px}.w250[_ngcontent-%COMP%]{width:250px}.w400[_ngcontent-%COMP%]{width:400px}.b[_ngcontent-%COMP%]{font-weight:700}.blue[_ngcontent-%COMP%]{color:#00f}.red[_ngcontent-%COMP%]{color:red}.hAlignR[_ngcontent-%COMP%]{text-align:right}"]})}return o})();function Ge(o,d){if(1&o&&(e.TgZ(0,"div",40),e._uU(1),e.ALo(2,"date"),e.qZA()),2&o){const t=e.oxw(3);e.xp6(1),e.hij(" ",e.lcZ(2,1,t.order.forwardedToHRDeptOn)," ")}}function Le(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div",41),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(3);return e.KtG(s.forwardOrderToHRDept())}),e._uU(1," Not Forwarded "),e.qZA()}}function Ye(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div",34)(1,"label",35),e._uU(2,"Contract Review Status"),e.qZA(),e.TgZ(3,"div",36),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.updateContractReviewStatus())}),e._uU(4),e.qZA(),e.TgZ(5,"label",37),e._uU(6,"Forwarded to HR On"),e.qZA(),e.YNc(7,Ge,3,3,"div",38),e.YNc(8,Le,2,0,"div",39),e.qZA()}if(2&o){const t=e.oxw(2);e.xp6(3),e.Q6J("ngClass","Accepted"===t.order.contractReviewStatus?"green":"Accepted with regrets"===t.order.contractReviewStatus?"blue":"red"),e.xp6(1),e.hij(" ",t.order.contractReviewStatus," "),e.xp6(3),e.Q6J("ngIf",null!=t.order.forwardedToHRDeptOn),e.xp6(1),e.Q6J("ngIf",void 0===t.order.forwardedToHRDeptOn)}}function He(o,d){1&o&&e._UZ(0,"span",42)}function je(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div",43)(1,"button",44),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.assignTasksToHRExecs())}),e.qZA(),e.TgZ(2,"button",45),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.OrderForwardedTo())}),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("disabled","Accepted"!==t.order.contractReviewStatus)}}function Be(o,d){if(1&o&&e._UZ(0,"ng-select",58),2&o){const t=e.oxw(3);e.Q6J("items",t.categories)}}function ze(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div",34)(1,"button",59),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().index,n=e.oxw(2);return e.KtG(n.openContractReviewItemModal(s))}),e.qZA(),e.TgZ(2,"button",60),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().index,n=e.oxw(2);return e.KtG(n.displayOrderAssessmentItem(s))}),e.qZA(),e.TgZ(3,"button",61),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().index,n=e.oxw(2);return e.KtG(n.openJDModal(s))}),e.qZA(),e.TgZ(4,"button",62),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().index,n=e.oxw(2);return e.KtG(n.openRemunerationModal(s))}),e.qZA()()}}const J=function(){return{dateInputFormat:"YYYY-MM-DD"}};function Ke(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"div",46),e._UZ(2,"input",47)(3,"input",48),e.YNc(4,Be,1,1,"ng-select",49),e._UZ(5,"input",50)(6,"app-text-input",51),e.TgZ(7,"app-text-input",52),e.NdJ("change",function(){const n=e.CHM(t).index,a=e.oxw(2);return e.KtG(a.qntyChanged(n))}),e.qZA(),e._UZ(8,"app-text-input",53)(9,"app-text-input",54)(10,"input",55)(11,"input",56),e.YNc(12,ze,5,0,"div",16),e.TgZ(13,"button",57),e.NdJ("click",function(){const n=e.CHM(t).index,a=e.oxw(2);return e.KtG(a.removeItem(n))}),e.qZA()()()}if(2&o){const t=d.index,r=e.oxw(2);e.xp6(1),e.Q6J("formGroupName",t),e.xp6(3),e.Q6J("ngIf",r.categories),e.xp6(2),e.Q6J("label","Source From"),e.xp6(1),e.Q6J("label","quantity"),e.xp6(1),e.Q6J("label","Min CVs"),e.xp6(1),e.Q6J("label","max CVs"),e.xp6(1),e.Q6J("bsValue",r.bsValueDate)("bsConfig",e.DdM(9,J)),e.xp6(2),e.Q6J("ngIf",!r.isAddMode)}}function Ve(o,d){if(1&o&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&o){const t=d.$implicit;e.xp6(1),e.hij(" ",t," ")}}function We(o,d){if(1&o&&(e.TgZ(0,"ul",63),e.YNc(1,Ve,2,1,"li",32),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.errors)}}function $e(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"form",2),e.NdJ("change",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.formChanged())}),e.TgZ(2,"label",3),e._uU(3,"Order No"),e.qZA(),e.TgZ(4,"label",4),e._uU(5,"Customer"),e.qZA(),e.TgZ(6,"label",3),e._uU(7,"Dated"),e.qZA(),e.TgZ(8,"label",3),e._uU(9,"Complete By"),e.qZA(),e.TgZ(10,"label",3),e._uU(11,"City"),e.qZA(),e.TgZ(12,"label",5),e._uU(13,"Country"),e.qZA(),e.TgZ(14,"label",3),e._uU(15,"Order Ref"),e.qZA(),e._UZ(16,"br")(17,"app-text-input",6),e.TgZ(18,"div",7),e._UZ(19,"ng-select",8),e.qZA(),e._UZ(20,"input",9)(21,"input",10)(22,"app-text-input",11)(23,"app-text-input",12)(24,"app-text-input",13)(25,"br"),e.TgZ(26,"label",5),e._uU(27,"Project Head"),e.qZA(),e.TgZ(28,"div",14),e._UZ(29,"ng-select",15),e.qZA(),e.YNc(30,Ye,9,4,"div",16),e.TgZ(31,"label",17),e._uU(32,"Status"),e.qZA(),e.TgZ(33,"div",18),e._uU(34),e.qZA(),e.TgZ(35,"button",19),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.onSubmit())}),e.YNc(36,He,1,0,"span",20),e.qZA(),e.YNc(37,je,3,1,"div",21),e.TgZ(38,"button",22),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.close())}),e.qZA(),e._UZ(39,"hr",23),e.TgZ(40,"div",24)(41,"div",25)(42,"label",26),e._uU(43,"Sel"),e.qZA(),e.TgZ(44,"label",26),e._uU(45,"Sr#"),e.qZA(),e.TgZ(46,"label",27),e._uU(47,"Category"),e.qZA(),e.TgZ(48,"label",28),e._uU(49,"ECNR"),e.qZA(),e.TgZ(50,"label",17),e._uU(51,"Source"),e._UZ(52,"br"),e._uU(53,"From"),e.qZA(),e.TgZ(54,"label",29),e._uU(55,"Qnty"),e.qZA(),e.TgZ(56,"label",29),e._uU(57,"Min"),e._UZ(58,"br"),e._uU(59,"CVs"),e.qZA(),e.TgZ(60,"label",29),e._uU(61,"Max"),e._UZ(62,"br"),e._uU(63,"CVs"),e.qZA(),e.TgZ(64,"label",30),e._uU(65,"Complete by "),e.qZA(),e.TgZ(66,"label",29),e._uU(67,"Review"),e._UZ(68,"br"),e._uU(69,"Status"),e.qZA(),e.TgZ(70,"button",31),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.addItem())}),e.qZA()(),e.YNc(71,Ke,14,10,"div",32),e.qZA()(),e.YNc(72,We,2,1,"ul",33),e.qZA()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.form),e.xp6(16),e.Q6J("label","Order No"),e.xp6(2),e.Q6J("items",t.customers),e.xp6(1),e.Q6J("bsValue",t.bsValueDate)("bsConfig",e.DdM(18,J)),e.xp6(1),e.Q6J("bsValue",t.bsValueDate)("bsConfig",e.DdM(19,J)),e.xp6(1),e.Q6J("label","City"),e.xp6(1),e.Q6J("label","Country"),e.xp6(1),e.Q6J("label","Order Ref"),e.xp6(5),e.Q6J("items",t.employees),e.xp6(1),e.Q6J("ngIf",!t.isAddMode),e.xp6(4),e.Oqu(t.order.status),e.xp6(1),e.Q6J("disabled",!t.form.dirty),e.xp6(1),e.Q6J("ngIf",t.loading),e.xp6(1),e.Q6J("ngIf",!t.isAddMode),e.xp6(34),e.Q6J("ngForOf",t.orderItems.controls),e.xp6(1),e.Q6J("ngIf",t.errors)}}let Xe=(()=>{class o{constructor(t,r,s,n,a,l,p,w,T,D){this.activatedRoute=t,this.fb=r,this.service=s,this.orderAssessService=n,this.toastr=a,this.router=l,this.taskService=p,this.contractRvwService=w,this.modalService=T,this.confirm=D,this.associates=[],this.customers=[],this.employees=[],this.categories=[],this.isAddMode=!1,this.loading=!1,this.form=new i.cw({}),this.bsValueDate=new Date,this.returnUrl="",this.routeId="",this.errors=[],this.routeId=this.activatedRoute.snapshot.params.id;let b=this.router.getCurrentNavigation();b?.extras&&b.extras.state&&(b.extras.state.returnUrl&&(this.returnUrl=b.extras.state.returnUrl),b.extras.state.user&&(this.user=b.extras.state.user))}ngOnInit(){this.activatedRoute.data.subscribe(t=>{this.order=t.order,this.customers=t.customers,this.employees=t.employees,this.categories=t.professions}),this.isAddMode=0===this.order?.id,this.createAndInitializeForm(this.order)}createAndInitializeForm(t){this.form=this.fb.group({id:[t.id],orderNo:[t.orderNo,i.kI.required],orderDate:[t.orderDate,i.kI.required],customerId:[t.customerId,i.kI.required],orderRef:[t.orderRef],salesmanId:[t.salesmanId],projectManagerId:[t.projectManagerId,i.kI.required],cityOfWorking:[t.cityOfWorking],country:[t.country,i.kI.required],completeBy:[t.completeBy,i.kI.required],status:[t.status],forwardedToHRDeptOn:[t.forwardedToHRDeptOn],contractReviewStatus:[t.contractReviewStatus],orderItems:this.fb.array(t.orderItems.map(r=>this.fb.group({selected:!1,id:r.id,orderId:r.orderId,srNo:r.srNo,professionId:[r.professionId,i.kI.required],ecnr:r.ecnr,sourceFrom:r.sourceFrom,quantity:[r.quantity,[i.kI.required,i.kI.min(1)]],minCVs:r.minCVs,maxCVs:r.maxCVs,completeBefore:r.completeBefore,status:r.status,reviewItemStatus:[r.reviewItemStatus],requireAssessment:[r.requireAssessment]})))})}get orderItems(){return this.form.get("orderItems")}newItem(){this.isAddMode&&this.form.get("completeBy");var t=0===this.orderItems.length?1:Math.max(...this.orderItems.value.map(s=>s.srNo))+1;return this.isAddMode&&this.form.get("completeBy"),this.fb.group({selected:!1,id:0,orderId:this.order?.id,srNo:t,professionId:[0,i.kI.required],ecnr:!1,sourceFrom:"India",quantity:[0,[i.kI.required,i.kI.min(1)]],minCVs:0,maxCVs:0,completeBefore:[this.form.get("completeBy")?.value,i.kI.required],status:"Not Started",reviewItemStatus:"Not Reviewed",requireAssessment:!1})}addItem(){this.orderItems.push(this.newItem())}formChanged(){console.log("form changed event")}setMinCVs(t,r){this.orderItems.at(t).get("minCVs").setValue(r)}setMaxCVs(t,r){this.orderItems.at(t).get("maxCVs").setValue(r)}getMinCVs(t){return this.getControls()[t].value.minCVs}getMaxCVs(t){return this.getControls()[t].value.maxCVs}getQnty(t){return this.getControls()[t].value.quantity}getControls(){return this.form.get("orderItems").controls}qntyChanged(t){if(!(+this.getMinCVs(t)>0||+this.getMaxCVs(t)>0)){var r=+this.getQnty(t);this.setMinCVs(t,3*r),this.setMaxCVs(t,3*r)}}onSubmit(){0!==this.orderItems.length?this.isAddMode?this.CreateOrder():(this.toastr.info("updating order ..."),this.UpdateOrder()):this.toastr.warning("Require atleast one Order Item to save the Demand Letter","Invalid form data")}removeItem(t){this.orderItems.removeAt(t),this.orderItems.markAsDirty(),this.orderItems.markAsTouched()}close(){this.router.navigateByUrl(this.returnUrl)}CreateOrder(){this.service.register(this.form.value).subscribe({next:t=>{null==t?this.toastr.info("Failed to creat the order"):(this.form.get("orderNo")?.value.setValue(t.orderNo),this.form.get("id")?.value.setValue(t.id),this.toastr.success("Created the Order, with Order No. "+t.orderNo))},error:t=>this.toastr.error("Error in creating the Order",t)})}displayOrderAssessmentItem(t){var r=this.orderItems.at(t).get("id")?.value;r?this.orderAssessService.getOrderAssessmentItem(r).pipe((0,h.h)(n=>null!==n),(0,g.w)(n=>(this.bsModalRef=this.modalService.show(Ee,{class:"modal-dialog-centered modal-lg",initialState:{orderAssessmentItem:n,user:this.user}}),this.bsModalRef.content.updateEvent))).subscribe(n=>{n?this.toastr.success("Updated the contract review item - you must update this Demand Letter for the changes to take permanent effect","Success"):this.toastr.warning("Failed to update the contract review","Failed")}):this.toastr.warning("Failed to get Order Item Id","logic error")}assignTasksToHRExecs(){if(this.isAddMode)return;if(0===this.order?.projectManagerId)return void this.toastr.warning("Project Manager needs to be defined before tasks can be assiged");if(this.isAddMode)return void this.toastr.error("tasks cannot be assigned while in add mode.  Save the data first and then comeback to this form in edit mode to assign HR Executive tasks");var r=this.form.value.orderItems.filter(l=>!0===l.selected).map(l=>l.id);if(0===r.length)return void this.toastr.error("No Order Items selected");const n=this.service.createOrderAssignmentTasks(r);this.confirm.confirm("confirm assign Tasks to HR Executives","This will create tasks in the name of HR Executives defined in the contract review.  This will also compose messages which you can view/edit in the Messages section.").pipe((0,h.h)(l=>l),(0,g.w)(()=>n)).subscribe({next:l=>{""===l||null===l?this.toastr.success("tasks created for the chosen order items. Messages also composed, which you can view/edit in the Messages section","Success"):this.toastr.warning(l,"Failed to process Some or all Order Item Ids")},error:l=>this.toastr.error(l.error.text,"Error encountered")})}assignTasksToHRExecsdelete(){if(!this.isAddMode)if(0!==this.order?.projectManagerId)if(this.isAddMode)this.toastr.error("tasks cannot be assigned while in add mode.  Save the data first and then comeback to this form in edit mode to assign HR Executive tasks");else{var r=this.form.value.orderItems.filter(s=>!0===s.selected).map(s=>s.id);if(0!==r.length)return this.service.createOrderAssignmentTasks(r).subscribe(s=>{""===s||null===s?this.toastr.success("tasks created for the chosen order items","Success"):this.toastr.warning(s,"Failure")},s=>{this.toastr.error(s.error.details,"failed to create tasks for the chosen order items")});this.toastr.error("No Order Items selected")}else this.toastr.warning("Project Manager needs to be defined before tasks can be assiged")}updateContractReviewStatus(){var t=this.form.get("id")?.value;return""===t||null===t?null:this.service.updateContractReviewStatus(+t).subscribe({next:r=>{console.log("response:",r),""===r||null===r?this.toastr.info("Failed to update the Contract Review","Failure"):(this.order.contractReviewStatus=r,this.toastr.success("Contract Review value updated","Success"))},error:r=>{console.log("error in updatecontractreviewstatus:",r),this.toastr.error(r.error?.details,"Error")}})}openContractReviewItemModal(t){var r=this.orderItems.at(t).get("id")?.value;this.contractRvwService.getContractReviewItem(r).pipe((0,h.h)(n=>null!=n),(0,g.w)(n=>(this.bsModalRef=this.modalService.show(K,{class:"modal-dialog-centered modal-lg",initialState:{reviewItem:n}}),this.bsModalRef.content.updateModalReview))).subscribe(n=>{null!==n?(this.toastr.success("Updated the contract review item - you must update this Demand Letter for the changes to take permanent effect","Success"),this.orderItems.at(t).get("reviewItemStatus")?.setValue(n.reviewItemStatus),this.form.markAsDirty()):this.toastr.warning("Failed to update the contract review","Failed")})}navigateByRoute(t,r,s){this.router.navigate([t],{state:{user:this.user,object:r,toedit:s,returnUrl:"/orders/orders/edit/"+this.routeId}})}openJDModal(t){if(!this.isAddMode){var r=this.getControls()[t].value;this.service.getJD(r.id).pipe((0,h.h)(a=>null!=a),(0,g.w)(a=>(this.bsModalRef=this.modalService.show(ye,{class:"modal-dialog-centered modal-md",initialState:{title:"Job Description",jd:a}}),this.bsModalRef.content.updateSelectedJD))).subscribe(a=>{a?this.toastr.success("Updated the contract review item","Success"):this.toastr.success("Failed to update the contract review item","Failure")})}}openRemunerationModal(t){if(!this.isAddMode){var r=this.getName(t);this.service.getRemuneration(r).pipe((0,h.h)(n=>null!==n),(0,g.w)(n=>(this.bsModalRef=this.modalService.show(Ne.l,{class:"modal-dialog-centered modal-md",initialState:{remun:n,editable:!0}}),this.bsModalRef.content.updateSelectedRemuneration))).subscribe(n=>{null!==n?this.toastr.success("Updated the Remuneration details","Success"):this.toastr.warning("Failed to update the Remuneration details","Failed")})}}getName(t){return this.getControls()[t].value.id}UpdateOrder(){this.service.UpdateOrder(this.form.value).subscribe({next:t=>{t?this.toastr.success("Order Updated","Success"):this.toastr.warning("Failed to update the order","Failure")},error:t=>{console.log("updateOrder error:",t),this.toastr.error(t.error.error?t.error.error:t,"Error encountered")}})}forwardOrderToHRDept(){}OrderForwardedTo(){}static#e=this.\u0275fac=function(r){return new(r||o)(e.Y36(u.gz),e.Y36(i.qu),e.Y36(y.p),e.Y36(C),e.Y36(_._W),e.Y36(u.F0),e.Y36(H.M),e.Y36(P),e.Y36(I.tT),e.Y36(O.z))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-dl"]],decls:4,vars:4,consts:[[4,"ngIf"],[2,"font-size","small"],[3,"formGroup","change"],[1,"lbl","w110","mx-2"],[1,"lbl","w300","mx-2"],[1,"lbl","w150","mx-2"],["formControlName","orderNo",1,"stdd","w110","mx-2",3,"label"],[1,"stdd","w300","mx-2"],["bindLabel","customerName","bindValue","id","labelForId","id","clearAllText","Clear","formControlName","customerId",3,"items"],["type","text","placeholder","Order Date","formControlName","orderDate","bsDatepicker","",1,"stdd","w110","mx-2",3,"bsValue","bsConfig"],["type","text","placeholder","Order Date","formControlName","completeBy","bsDatepicker","",1,"stdd","w110","mx-2",3,"bsValue","bsConfig"],["formControlName","cityOfWorking",1,"stdd","w110","mx-1",3,"label"],["formControlName","country",1,"stdd","w100","mx-1",3,"label"],["formControlName","orderRef",1,"stdd","w200",3,"label"],[1,"stdd","w150","mx-2"],["bindLabel","knownAs","bindValue","id","labelForId","id","clearAllText","Clear","formControlName","projectManagerId",3,"items"],["class","stdd",4,"ngIf"],[1,"lbl","w100"],[1,"stdd","fontSmaller","w110","yellow"],["type","submit","title","Save the requirement",1,"fa","fa-save","fa-2x",2,"margin-left","25px!important",3,"disabled","click"],["class","spinner-border spinner-border-sm mr-1",4,"ngIf"],["style","display: inline-block;",4,"ngIf"],["title","Return to calling procedure",1,"btn","fa","fa-2x","fa-window-close",2,"margin-left","25px",3,"click"],[2,"margin","0px","padding","0px"],["formArrayName","orderItems",1,"my-2"],[2,"font-weight","bold","margin-left","0px","font-size","smaller"],[1,"lbl","w30"],[1,"lbl","w225"],[1,"w30","mx-2",2,"display","inline-block"],[1,"lbl","w50"],["title","Date by which the shortlisting of candidates is to be completed by the HR Executive",1,"lbl","w110"],["type","button",1,"stdd","w30","fa","fa-plus","fa-2x","blue",2,"margin-left","20px",3,"click"],[4,"ngFor","ngForOf"],["class","text-danger list-unstyled",4,"ngIf"],[1,"stdd"],[1,"lbl","w150"],[1,"stdd","w100","cursorpointer","yellow",2,"border","btn-primary",3,"ngClass","click"],[1,"lbl","w150","mx-3"],["id","forwardedToHRDeptOn","class","stdd w110 yellow mx-2",4,"ngIf"],["class","stdd w110 cursorpointer mx-2 yellow",3,"click",4,"ngIf"],["id","forwardedToHRDeptOn",1,"stdd","w110","yellow","mx-2"],[1,"stdd","w110","cursorpointer","mx-2","yellow",3,"click"],[1,"spinner-border","spinner-border-sm","mr-1"],[2,"display","inline-block"],["title","assign selected categories once Contract Review is done",1,"btn","mx-2","fa","fa-users","fa-2x",3,"disabled","click"],["title","displays list of Associates to whom this order has been forwarded",1,"btn","mx-2","fa","fa-question",3,"click"],[3,"formGroupName"],["type","checkbox","formControlName","selected",2,"display","inline-block","width","15px","margin-left","8px","margin-right","8px"],["type","text","formControlName","srNo",1,"w40",2,"margin","0 1px 0 1px","text-align","right"],["class","stdd w240","bindLabel","professionName","bindValue","id","labelForId","id","clearAllText","Clear","formControlName","professionId",3,"items",4,"ngIf"],["type","checkbox","formControlName","ecnr",1,"chk","w30"],["formControlName","sourceFrom",1,"stdd","w100",3,"label"],["formControlName","quantity",1,"stdd","w50",3,"label","change"],["formControlName","minCVs",1,"stdd","w50",3,"label"],["formControlName","maxCVs",1,"stdd","w50",3,"label"],["type","text","placeholder","Complete By","formControlName","completeBefore","bsDatepicker","",1,"stdd","w110",3,"bsValue","bsConfig"],["type","text","title","contract review of this category","formControlName","reviewItemStatus",1,"stdd","w150","cursorpointer"],["title","remove this item",1,"btn","fa","fa-trash","red",3,"click"],["bindLabel","professionName","bindValue","id","labelForId","id","clearAllText","Clear","formControlName","professionId",1,"stdd","w240",3,"items"],["title","click to edit/prepare Contract Review for this category",1,"btn","w10","fa","fa-expand",3,"click"],["title","design Assessment Questions for this category",1,"w10","btn","fa","fa-question",3,"click"],["title","Open Job Description",1,"btn","fa","fa-list",3,"click"],["title","Open Remuneration",1,"btn","fa","fa-dollar",3,"click"],[1,"text-danger","list-unstyled"]],template:function(r,s){1&r&&(e.YNc(0,$e,73,20,"div",0),e.TgZ(1,"div",1),e._uU(2),e.ALo(3,"json"),e.qZA()),2&r&&(e.Q6J("ngIf",s.order),e.xp6(2),e.hij(" ",e.lcZ(3,2,s.form.value),"\n"))},dependencies:[c.mk,c.sg,c.O5,i._Y,i.Fj,i.Wl,i.JJ,i.JL,v.Np,v.Y5,i.sg,i.u,i.x0,i.CE,R.w9,Z.t,c.Ts,c.uU],styles:['.lbl[_ngcontent-%COMP%]{display:inline-block;font-size:small;font-weight:700;margin:0 2px;vertical-align:middle}.btn[_ngcontent-%COMP%]{color:#f0f8ff;width:15px}.stdd[_ngcontent-%COMP%]{display:inline-block;font-size:small;margin:0 2px}.cursorpointer[_ngcontent-%COMP%]{cursor:pointer;font-size:smaller;font-weight:700}.red[_ngcontent-%COMP%]{color:red}.yellow[_ngcontent-%COMP%]{color:#ff0}.w15[_ngcontent-%COMP%]{width:15px}.w30[_ngcontent-%COMP%]{width:30px}.w40[_ngcontent-%COMP%]{width:40px}.w50[_ngcontent-%COMP%]{width:50px}.w75[_ngcontent-%COMP%]{width:75px}.w100[_ngcontent-%COMP%]{width:100px}.w110[_ngcontent-%COMP%]{width:110px}.w150[_ngcontent-%COMP%]{width:150px}.w200[_ngcontent-%COMP%]{width:200px}.w225[_ngcontent-%COMP%]{width:225px}.w240[_ngcontent-%COMP%]{width:240px}.w300[_ngcontent-%COMP%]{width:300px}.inputCheck[_ngcontent-%COMP%]{margin-right:5px;width:40px;margin-left:10px;border:2px;border-color:#000}input[type=radio][_ngcontent-%COMP%]{appearance:none;-webkit-appearance:none;width:15px;height:15px;border:1px solid #fff;border-radius:50%;margin-right:5px;background-color:#c3b1b1;position:relative;vertical-align:middle}input[type=radio][_ngcontent-%COMP%]:checked:before{content:"";display:block;width:9px;height:9px;background-color:#4a0fec;border-radius:50%;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);animation:appear .8s}']})}return o})();class et{constructor(){this.id=0,this.orderNo=0,this.orderDate=new Date,this.customerId=0,this.customerName="",this.buyerEmail="",this.orderRef="",this.orderRefDate=new Date,this.salesmanId=0,this.salesmanName="",this.projectManagerId=0,this.medicalProcessInchargeEmpId=0,this.visaProcessInchargeEmpId=0,this.emigProcessInchargeId=0,this.travelProcessInchargeId=0,this.completeBy=new Date,this.country="",this.cityOfWorking="",this.contractReviewStatus="",this.estimatedRevenue=0,this.status="",this.forwardedToHRDeptOn=new Date("1900-01-01"),this.orderItems=[]}}const st=function(){return{dateInputFormat:"YYYY-MM-DD"}};function ot(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"div",29),e._UZ(2,"input",30),e.TgZ(3,"ng-select",31),e.NdJ("change",function(s){const a=e.CHM(t).index,l=e.oxw().index,p=e.oxw();return e.KtG(p.officialClicked(s,l,a))}),e.qZA(),e.TgZ(4,"div",32),e._UZ(5,"app-text-input",33),e.qZA(),e.TgZ(6,"button",34),e.NdJ("click",function(){const n=e.CHM(t).index,a=e.oxw().index,l=e.oxw();return e.KtG(l.removeOfficial(a,n))}),e.qZA()()()}if(2&o){const t=d.index,r=e.oxw(2);e.xp6(1),e.Q6J("formGroupName",t),e.xp6(1),e.Q6J("bsValue",r.bsValueDate)("bsConfig",e.DdM(5,st)),e.xp6(1),e.Q6J("items",r.customers),e.xp6(2),e.Q6J("label","Official Name")}}function it(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"div",18)(2,"div",19),e._UZ(3,"app-text-input",20),e.qZA(),e.TgZ(4,"div",21),e._UZ(5,"app-text-input",22),e.qZA(),e.TgZ(6,"div",23)(7,"label",24),e._uU(8,"Date Forwarded"),e.qZA(),e.TgZ(9,"label",25),e._uU(10,"Agent"),e.qZA(),e.TgZ(11,"label",26),e._uU(12,"Official Name"),e.qZA(),e.TgZ(13,"button",27),e.NdJ("click",function(){const n=e.CHM(t).index,a=e.oxw();return e.KtG(a.addOfficial(n))}),e.qZA(),e.YNc(14,ot,7,6,"div",16),e.qZA(),e._UZ(15,"hr",28),e.qZA()()}if(2&o){const t=d.index,r=e.oxw();e.xp6(1),e.Q6J("formGroupName",t),e.xp6(2),e.Q6J("label","Category"),e.xp6(2),e.Q6J("label","Charges"),e.xp6(9),e.Q6J("ngForOf",r.orderForwardCategoryOfficials(t).controls)}}let nt=(()=>{class o{constructor(t,r,s,n,a,l){this.fb=t,this.toastr=r,this.router=s,this.service=n,this.activatedRoute=a,this.confirm=l,this.form=new i.cw({}),this.customers=[],this.bsValueDate=new Date}ngOnInit(){this.activatedRoute.data.subscribe({next:t=>{this.orderFwd=t.orderfwd,this.customers=t.customers}}),this.orderFwd&&this.CreateAndInitializeForm(this.orderFwd)}CreateAndInitializeForm(t){this.form=this.fb.group({id:[t.id??0],orderId:[t.orderId??0,i.kI.required],orderNo:[t.orderNo??0,i.kI.required],orderDate:[t.orderDate??new Date,i.kI.required],customerId:[t.customerId??0,i.kI.required],customerName:[t.customerName??""],customerCity:[t.customerCity],orderForwardCategories:this.fb.array(t.orderForwardCategories.map(r=>this.fb.group({id:[r.id??0],orderItemId:[r.orderItemId??0,i.kI.required],orderForwardToAgentId:[r.agentId??0,i.kI.required],professionId:[r.professionId??0,i.kI.required],professionName:[r.professionName??""],charges:[r.charges??0],orderForwardCategoryOfficials:this.fb.array(r.orderForwardCategoryOfficials.map(s=>this.fb.group({id:[s.id],orderForwardCategoryId:[s.orderForwardCategoryId??0,i.kI.required],customerOfficialId:[s.customerOfficialId??0,i.kI.required],customerOfficialName:[s.customerOfficialName??""],agentName:[s.agentName??"",i.kI.required],dateTimeForwarded:[s.dateForwarded??new Date],emailIdForwardedTo:[s.emailIdForwardedTo??""],phoneNoForwardedTo:[s.phoneNoForwardedTo??""],whatsAppNoForwardedTo:[s.whatsAppNoForwardedTo??""],username:[s.username??""]})))})))})}orderForwards(){return this.form.get("orderForwards")}newForward(){return this.fb.group({orderNo:"",orderDate:"",customerName:"",dlForwardCategories:this.fb.array([])})}addForward(){this.orderForwards().push(this.newForward())}removeForward(){const s=this.service.deleteForward(this.orderFwd?.orderId??0);this.confirm.confirm("confirm Delete","confirm delete this Order Forward.WARNING: deleting this order forward will also delete its children  grand children objects").pipe((0,h.h)(a=>a),(0,g.w)(a=>(console.log("switchmap confirmed vaue:",a),s))).subscribe(a=>{console.log("subscribed response:",a),this.router.navigateByUrl("orders/orders")})}orderForwardCategories(){return this.form.get("orderForwardCategories")}newCategory(){return this.fb.group({categoryName:"",charges:0,dlForwardCategoryOfficials:this.fb.array([])})}addCategory(){this.orderForwardCategories().push(this.newCategory())}removeCategory(t){this.confirm.confirm("confirm Delete","confirm delete this Order Forward.WARNING: deleting this order forward will also delete its children  grand children objects").subscribe(n=>{n&&(this.orderForwardCategoryOfficials(t).clear(),this.orderForwardCategories().removeAt(t))})}removeSWitchMapAndFilterEx(t){const s=this.service.deleteOrderFwdCategory(t);this.confirm.confirm("confirm Delete","confirm delete this Order Forward.WARNING: deleting this order forward will also delete its children  grand children objects").pipe((0,h.h)(a=>a),(0,g.w)(a=>s)).subscribe(a=>{this.orderForwardCategoryOfficials(t).clear(),this.orderForwardCategories().removeAt(t),this.router.navigateByUrl("orders/orders")})}orderForwardCategoryOfficials(t){return this.orderForwardCategories().at(t).get("orderForwardCategoryOfficials")}newOfficial(t){return this.fb.group({id:0,agentName:"",customerOfficialId:0,dateTimeForwarded:new Date,emailIdForwardedTo:"",orderForwardCategoryId:this.orderForwardCategories().at(t).get("id"),orderItemId:this.orderForwardCategories().at(t).get("orderItemId"),officialName:""})}addOfficial(t){this.orderForwardCategoryOfficials(t).push(this.newOfficial(t))}removeOfficial(t,r){this.orderForwardCategoryOfficials(t).removeAt(r)}onSubmit(){var t=this.formContainsError();""===t?0===this.form.get("id")?.value?this.service.insertForwarOrderToAgent(this.form.value).subscribe({next:r=>{this.toastr.success("Order Forward registered successfully","success"),this.close()},error:r=>{this.toastr.error("error encountered",r)}}):this.service.updateForwarOrderToAgent(this.form.value).subscribe({next:r=>{this.toastr.success("Order Forward registered successfully","success"),this.close()},error:r=>{this.toastr.error("Error encountered",r)}}):this.toastr.info(t,"Form contains error")}formContainsError(){var r="";return this.form.value.orderForwardCategories.forEach(s=>{s.orderForwardCategoryOfficials.forEach(n=>{0===n.customerOfficialId&&(r+="Customer Not Selected"),void 0!==n.dateForwarded&&(r+="Date forwarded not selected")})}),this.toastr.info(r,"info"),r}officialClicked(t,r,s){this.orderForwardCategoryOfficials(r).at(s).get("officialName")?.setValue(t.officialName)}close(){this.router.navigateByUrl("/orders/orders")}static#e=this.\u0275fac=function(r){return new(r||o)(e.Y36(i.qu),e.Y36(_._W),e.Y36(u.F0),e.Y36(x),e.Y36(u.gz),e.Y36(O.z))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-order-forward"]],decls:29,vars:11,consts:[[1,"mt-5",3,"formGroup","ngSubmit"],[1,"stdd","w150","b"],[1,"stdd","w250","mx-2","blue"],[1,"stdd","w100","b"],[1,"stdd","w75","mx-2","blue"],[1,"stdd","w125","b"],[1,"stdd","w125","mx-2"],["title","Save this form","type","submit",1,"btn","fa-success","fa","fa-save","fa-2x","green"],["title","Close this form","type","button",1,"btn","fa-primary","fa","fa-undo","fa-2x",3,"click"],["title","Delete this Order Forard","type","button",1,"btn","fa-primary","fa","fa-trash","red","pull-right",3,"click"],[2,"border","double","color","darkblue","margin","0px","padding","0px"],["formArrayName","orderForwardCategories"],[1,"stdd","b","w250"],[1,"stdd","b","w100","mx-2"],["title","add a category",1,"btn","btn-primary","stdd","fa","fa-plus",3,"click"],[2,"margin-top","0px","margin-bottom","0px","padding-top","0px","padding-bottom","0px"],[4,"ngFor","ngForOf"],[1,"ml-5",2,"font-size","smaller"],[3,"formGroupName"],[1,"stdd","w250"],["readonly","","formControlName","professionName",3,"label"],[1,"stdd","mx-2","w100"],["formControlName","charges",3,"label"],["formArrayName","orderForwardCategoryOfficials",2,"margin","0px","padding","0px"],[1,"stdd","mL355","w110","b"],[1,"stdd","mx-2","w300","b"],[1,"stdd","b","mx-2","w250"],["type","button",1,"btn","mx-20","fa","fa-plus",3,"click"],[2,"border-bottom","blue","border-bottom-style","solid","border-width","2px","color","darkblue","margin","0px","padding","0px"],[2,"margin-left","355px",3,"formGroupName"],["bsDatepicker","","type","text","placeholder","Forwarded On","formControlName","dateTimeForwarded",1,"mx-2",2,"display","inline-block","width","100px","font-size","small",3,"bsValue","bsConfig"],["bindLabel","officialName","bindValue","id","labelForId","customerId","clearAllText","Clear","formControlName","customerOfficialId",2,"display","inline-block","font-size","small","width","300px",3,"items","change"],[1,"stdd","mx-2","w250"],["formControlName","officialName",2,"font-size","small",3,"label"],[1,"btn","fa","fa-sm","fa-trash","red",3,"click"]],template:function(r,s){1&r&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return s.onSubmit()}),e.TgZ(1,"label",1),e._uU(2,"Customer Name"),e.qZA(),e.TgZ(3,"div",2),e._uU(4),e.qZA(),e.TgZ(5,"label",3),e._uU(6,"Order No"),e.qZA(),e.TgZ(7,"div",4),e._uU(8),e.qZA(),e.TgZ(9,"label",5),e._uU(10,"Order Dated"),e.qZA(),e.TgZ(11,"div",6),e._uU(12),e.ALo(13,"date"),e.qZA(),e._UZ(14,"button",7),e.TgZ(15,"button",8),e.NdJ("click",function(){return s.close()}),e.qZA(),e.TgZ(16,"button",9),e.NdJ("click",function(){return s.removeForward()}),e.qZA(),e._UZ(17,"hr",10),e.TgZ(18,"div",11)(19,"label",12),e._uU(20,"Category"),e.qZA(),e.TgZ(21,"label",13),e._uU(22,"Charges"),e.qZA(),e.TgZ(23,"button",14),e.NdJ("click",function(){return s.addCategory()}),e.qZA(),e._UZ(24,"br",15),e.YNc(25,it,16,4,"div",16),e.qZA()(),e.TgZ(26,"div",17),e._uU(27),e.ALo(28,"json"),e.qZA()),2&r&&(e.Q6J("formGroup",s.form),e.xp6(4),e.Oqu(null==s.orderFwd?null:s.orderFwd.customerName),e.xp6(4),e.Oqu(null==s.orderFwd?null:s.orderFwd.orderNo),e.xp6(4),e.Oqu(e.xi3(13,6,null==s.orderFwd?null:s.orderFwd.orderDate,"dd-MMM-yy")),e.xp6(13),e.Q6J("ngForOf",s.orderForwardCategories().controls),e.xp6(2),e.hij(" ",e.lcZ(28,9,s.form.value),"\n"))},dependencies:[c.sg,i._Y,i.Fj,i.JJ,i.JL,v.Np,v.Y5,i.sg,i.u,i.x0,i.CE,R.w9,Z.t,c.Ts,c.uU],styles:[".stdd[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%]{display:inline-block;font-size:small;margin:0 2px;color:#f0f8ff}.b[_ngcontent-%COMP%]{font-weight:700}.w75[_ngcontent-%COMP%]{width:75px}.w100[_ngcontent-%COMP%]{width:100px}.w110[_ngcontent-%COMP%]{width:110px}.w125[_ngcontent-%COMP%]{width:125px}.w150[_ngcontent-%COMP%]{width:150px}.w250[_ngcontent-%COMP%]{width:250px}.w300[_ngcontent-%COMP%]{width:300px}.w350[_ngcontent-%COMP%]{width:350px}.mL355[_ngcontent-%COMP%]{margin-left:355px}.red[_ngcontent-%COMP%]{color:red}.green[_ngcontent-%COMP%]{color:green}.blue[_ngcontent-%COMP%]{color:#00008b}"]})}return o})();function lt(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"div",25)(2,"div",26),e._UZ(3,"app-text-input",27),e.qZA(),e.TgZ(4,"div",8),e._UZ(5,"app-text-input",28),e.qZA(),e._UZ(6,"app-text-input",29),e.TgZ(7,"app-text-input",30),e.NdJ("change",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.calcualteTotals())}),e.qZA(),e._UZ(8,"input",31),e.TgZ(9,"button",32),e.NdJ("click",function(){const n=e.CHM(t).index,a=e.oxw(2);return e.KtG(a.removeOrderAssessmentItemQ(n))}),e.qZA()()()}if(2&o){const t=d.index;e.xp6(1),e.Q6J("formGroupName",t),e.xp6(2),e.Q6J("label","Question No"),e.xp6(2),e.Q6J("label","Subject"),e.xp6(1),e.Q6J("label","question"),e.xp6(1),e.Q6J("type","number")("label","Points")}}const ct=function(){return{dateInputFormat:"YYYY-MM-DD"}};function mt(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"form",2),e.NdJ("ngSubmit",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.form.valid&&s.update())}),e.TgZ(1,"h4",3),e._uU(2,"Order Assessment - design questions for Order Item Category"),e.qZA(),e.TgZ(3,"label",4),e._uU(4,"Order No.:"),e.qZA(),e._UZ(5,"app-text-input",5),e.TgZ(6,"div",6),e._uU(7),e.qZA(),e.TgZ(8,"label",7),e._uU(9,"Customer Name"),e.qZA(),e.TgZ(10,"div",8),e._uU(11),e.qZA(),e.TgZ(12,"label",7),e._uU(13,"Category"),e.qZA(),e.TgZ(14,"div",8),e._uU(15),e.qZA(),e._UZ(16,"br"),e.TgZ(17,"label",7),e._uU(18,"Designed By"),e.qZA(),e._UZ(19,"app-text-input",9),e.TgZ(20,"label",10),e._uU(21,"On"),e.qZA(),e._UZ(22,"input",11),e.TgZ(23,"label",7),e._uU(24,"Approved By"),e.qZA(),e.TgZ(25,"input",12),e.NdJ("dblclick",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.updateApprovedBy())}),e.qZA(),e.TgZ(26,"button",13),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.populateStddAssessmentQuestions())}),e.qZA(),e.TgZ(27,"button",14),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.populateCustomAssessmentQuestions(s.professionId))}),e.qZA(),e.TgZ(28,"button",15),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.update())}),e.qZA(),e.TgZ(29,"button",16),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.cancel())}),e.qZA(),e.TgZ(30,"div",17)(31,"label",18),e._uU(32,"Qstn No"),e.qZA(),e.TgZ(33,"label",19),e._uU(34,"Subject"),e.qZA(),e.TgZ(35,"label",20),e._uU(36,"Question"),e.qZA(),e.TgZ(37,"label",21),e._uU(38,"Points"),e.qZA(),e.TgZ(39,"label",21),e._uU(40,"Mandatory"),e.qZA(),e.TgZ(41,"button",22),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.addNewOrderAssessmentItemQ())}),e.qZA(),e.YNc(42,lt,10,6,"div",23),e.TgZ(43,"div",24),e._uU(44),e.qZA()()()}if(2&o){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(5),e.Q6J("label","Order No"),e.xp6(2),e.hij("",t.orderAssessmentItem.orderNo," "),e.xp6(4),e.Oqu(t.orderAssessmentItem.customerName),e.xp6(4),e.Oqu(t.orderAssessmentItem.professionName),e.xp6(4),e.Q6J("label","Designed By"),e.xp6(3),e.Q6J("bsValue",t.bsValueDate)("bsConfig",e.DdM(10,ct)),e.xp6(20),e.Q6J("ngForOf",t.orderAssessmentItemQs.controls),e.xp6(2),e.hij("Total: ",t.totalMarks,"")}}let ut=(()=>{class o{constructor(t,r,s,n,a,l){this.fb=t,this.router=r,this.activatedRoute=s,this.confirmService=n,this.service=a,this.toastr=l,this.form=new i.cw({}),this.cancelRegister=new e.vpe,this.returnUrl="",this.professionId=0,this.totalMarks=0,this.bsValueDate=new Date;let p=this.router.getCurrentNavigation();p?.extras&&p.extras.state&&(p.extras.state.returnUrl&&(this.returnUrl=p.extras.state.returnUrl),p.extras.state.user&&(this.user=p.extras.state.user))}ngOnInit(){this.activatedRoute.data.subscribe(t=>{this.orderAssessmentItem=t.assessmentItem}),this.orderAssessmentItem&&(this.CreateAndInitializeFormArray(this.orderAssessmentItem),this.calcualteTotals(),this.professionId=this.orderAssessmentItem?.professionId)}CreateAndInitializeFormArray(t){this.form=this.fb.group({id:[t.id],orderAssessmentId:[t.orderAssessmentId],orderItemId:[t.orderItemId,i.kI.required],orderId:[t.orderId,i.kI.required],orderNo:[t.orderNo,i.kI.required],customerName:[t.customerName,i.kI.required],professionId:[t.professionId,i.kI.required],professionName:[t.professionName,i.kI.required],designedBy:[t.designedBy],dateDesigned:[t.dateDesigned],approvedBy:[t.approvedBy],orderAssessmentItemQs:this.fb.array(t.orderAssessmentItemQs.map(r=>this.fb.group({id:[r.id??0],orderAssessmentItemId:r.orderAssessmentItemId,orderItemId:[r.orderItemId,i.kI.required],orderId:r.orderId,questionNo:[r.questionNo,i.kI.required],subject:[r.subject,i.kI.required],question:[r.question,i.kI.required],maxPoints:[r.maxPoints,i.kI.required],isMandatory:[r.isMandatory,i.kI.required]})))})}get orderAssessmentItemQs(){return this.form.get("orderAssessmentItemQs")}newOrderAssessmentItemQ(){return this.fb.group({id:0,orderAssessmentItemId:this.form.get("id"),orderItemId:[this.form.get("orderItemId"),i.kI.required],orderId:[this.form.get("orderId"),i.kI.required],questionNo:[0,i.kI.required],subject:["",i.kI.required],question:["",i.kI.required],maxPoints:[0,i.kI.required],isMandatory:[!1,i.kI.required]})}newOrderAssessmentItemQFromStddQ(t){t.forEach(r=>{this.orderAssessmentItemQs.push(this.fb.group({id:r.id,orderAssessmentItemId:r.orderAssessmentItemId,orderItemId:[r.orderItemId,i.kI.required],orderId:[r.orderId,i.kI.required],questionNo:[r.questionNo,i.kI.required],subject:[r.subject,i.kI.required],question:[r.question,i.kI.required],maxPoints:[r.maxPoints,i.kI.required],isMandatory:[r.isMandatory,i.kI.required]}))})}addNewOrderAssessmentItemQ(){this.orderAssessmentItemQs.push(this.newOrderAssessmentItemQ())}removeOrderAssessmentItemQ(t){this.orderAssessmentItemQs.removeAt(t)}cancel(){this.cancelRegister.emit(!1),this.router.navigateByUrl(this.returnUrl)}update(){this.service.updateOrderAssessmentItem(this.form.value).subscribe({next:t=>{t?this.toastr.success("Order Assessment Item successfully updated","success"):this.toastr.warning("failed to update the order assessment item","Failed to update")}})}calcualteTotals(){this.totalMarks=this.form.get("orderAssessmentItemQs")?.value.map(t=>t.maxPoints).reduce((t,r)=>+t+ +r)}GetConfirmation(t){var r=!1;return this.confirmService.confirm("confirm OVER-WRITE existing Assessment Questions","Currently, there are "+t+" assessment Questions relating to this Category.If you continue, these questions will be replaced with new set of standard assessment quetions").subscribe(s=>r=s),r}populateStddAssessmentQuestions(){this.GetConfirmation(this.orderAssessmentItemQs.length)?this.service.getAssessmentQStandard().subscribe({next:r=>{if(r.length>0){if(this.orderAssessmentItemQs.clear(),!r.length)return void this.toastr.warning("No standard Questions retrieved","Failure");this.newOrderAssessmentItemQFromStddQ(r)}else this.toastr.warning("Failed to retrieve the standard assessment Questions")},error:r=>this.toastr.error(r,"Error in retrieving Standard Questions")}):this.toastr.info("User aborted","abort")}populateCustomAssessmentQuestions(t){this.GetConfirmation(this.orderAssessmentItemQs.length)?this.service.getAssessmentQBankOfCategoryId(t).subscribe({next:s=>{null!==s?(this.orderAssessmentItemQs.clear(),s.assessmentStddQs.forEach(n=>{var a={id:0,orderAssessmentItemId:this.orderAssessmentItem.id,orderItemId:this.orderAssessmentItem.orderItemId,orderId:this.orderAssessmentItem.orderId,questionNo:n.questionNo,question:n.question,subject:n.subject,maxPoints:n.maxPoints,isMandatory:!1};this.orderAssessmentItem?.orderAssessmentItemQs.push(a)})):this.toastr.warning("Failed to retrieve the standard assessment Questions")},error:s=>this.toastr.error(s,"Error in retrieving Standard Questions")}):this.toastr.info("User aborted","abort")}updateApprovedBy(){this.user&&(this.form.value.approvedBy=this.user.userName,this.form.get("approvedBy")?.setValue(this.user.userName))}static#e=this.\u0275fac=function(r){return new(r||o)(e.Y36(i.qu),e.Y36(u.F0),e.Y36(u.gz),e.Y36(O.z),e.Y36(C),e.Y36(_._W))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-order-assessment-item"]],outputs:{cancelRegister:"cancelRegister"},decls:4,vars:4,consts:[["autocomplete","off",3,"formGroup","ngSubmit",4,"ngIf"],[2,"font-size","smaller"],["autocomplete","off",3,"formGroup","ngSubmit"],[2,"font-weight","bold"],[1,"lbl","b","100"],["formControlName","orderNo",1,"stdd","w75",3,"label"],[1,"stdd","w100"],[1,"lbl","w100"],[1,"stdd","w250"],["formControlName","designedBy",1,"stdd","w100",3,"label"],[1,"lbl","w50","hAlignR"],["type","text","placeholder","designed On","formControlName","dateDesigned","bsDatepicker","",1,"stdd","w100",3,"bsValue","bsConfig"],["type","text","formControlName","approvedBy",1,"stdd","w75",3,"dblclick"],["title","imports standard assessment questions",1,"btn","mx-2","fa","fa-download",3,"click"],["title","imports custom assessment questions matching the profession",1,"btn","fa","fa-download",3,"click"],["title","Save this data",1,"btn","fa","fa-save","fa-2x",3,"click"],["title","close this form and return to the calling program",1,"btn","fa","fa-window-close","fa-2x",3,"click"],["formArrayName","orderAssessmentItemQs"],[1,"lbl","w50"],[1,"lbl","w250"],[1,"lbl","w400"],[1,"lbl","w75"],["type","button",1,"stdd","btn","btn-priamry","fa","fa-plus","fa-lg",2,"margin-left","15px",3,"click"],[4,"ngFor","ngForOf"],[2,"margin-left","700px"],[3,"formGroupName"],[1,"stdd","w50"],["formControlName","questionNo",3,"label"],["formControlName","subject",3,"label"],["formControlName","question",1,"stdd","w400",3,"label"],["formControlName","maxPoints",1,"stdd","w75",3,"type","label","change"],["type","checkbox","formControlName","isMandatory",1,"stdd","mx-4"],[1,"mx-4","btn","fa","fa-trash","red",3,"click"]],template:function(r,s){1&r&&(e.YNc(0,mt,45,11,"form",0),e.TgZ(1,"div",1),e._uU(2),e.ALo(3,"json"),e.qZA()),2&r&&(e.Q6J("ngIf",s.orderAssessmentItem),e.xp6(2),e.hij(" ",e.lcZ(3,2,s.form.value),"\n"))},dependencies:[c.sg,c.O5,i._Y,i.Fj,i.Wl,i.JJ,i.JL,v.Np,v.Y5,i.sg,i.u,i.x0,i.CE,Z.t,c.Ts],styles:[".stdd[_ngcontent-%COMP%]{display:inline-block;font-size:small;margin:0 3px}.lbl[_ngcontent-%COMP%]{display:inline-block;font-size:small;font-weight:700;margin:0 3px}.btn[_ngcontent-%COMP%]{color:#f0f8ff;margin:2px}.w50[_ngcontent-%COMP%]{width:50px}.w75[_ngcontent-%COMP%]{width:75px}.w150[_ngcontent-%COMP%]{width:150px}.w250[_ngcontent-%COMP%]{width:250px}.w400[_ngcontent-%COMP%]{width:400px}.w500[_ngcontent-%COMP%]{width:500px}.b[_ngcontent-%COMP%]{font-weight:700}.blue[_ngcontent-%COMP%]{color:#00f}.red[_ngcontent-%COMP%]{color:red}.hAlignR[_ngcontent-%COMP%]{text-align:right}"]})}return o})();function gt(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"div",22),e._UZ(2,"app-text-input",23)(3,"app-text-input",24)(4,"app-text-input",25)(5,"app-text-input",26)(6,"input",27),e.TgZ(7,"button",28),e.NdJ("click",function(){const n=e.CHM(t).index,a=e.oxw().index,l=e.oxw(2);return e.KtG(l.removeOrderAssessmentItemQ(a,n))}),e.qZA()()()}if(2&o){const t=d.index;e.xp6(1),e.Q6J("formGroupName",t),e.xp6(1),e.Q6J("label","Question No"),e.xp6(1),e.Q6J("label","subject"),e.xp6(1),e.Q6J("label","Question"),e.xp6(1),e.Q6J("label","Max Points")}}function ht(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"div",13)(2,"label",7),e._uU(3,"Category"),e.qZA(),e.TgZ(4,"div",5),e._uU(5),e.qZA(),e._UZ(6,"br"),e.TgZ(7,"label",14),e._uU(8,"Assessment Questions for the category"),e.qZA(),e._UZ(9,"br"),e.TgZ(10,"label",15),e._uU(11,"Q No"),e.qZA(),e.TgZ(12,"label",16),e._uU(13,"Subject"),e.qZA(),e.TgZ(14,"label",17),e._uU(15,"Question"),e.qZA(),e.TgZ(16,"label",18),e._uU(17,"Max Pts"),e.qZA(),e.TgZ(18,"label",19),e._uU(19,"Mandatory"),e.qZA(),e.TgZ(20,"button",20),e.NdJ("click",function(){const n=e.CHM(t).index,a=e.oxw(2);return e.KtG(a.addNewOrderAssessmentItemQ(n))}),e.qZA(),e._UZ(21,"hr"),e.TgZ(22,"div",21),e.YNc(23,gt,8,5,"div",12),e.qZA()()()}if(2&o){const t=d.index,r=e.oxw(2);let s;e.xp6(1),e.Q6J("formGroupName",t),e.xp6(4),e.Oqu(null==(s=r.orderAssessmentItems.at(t).get("professionName"))?null:s.value),e.xp6(18),e.Q6J("ngForOf",r.orderAssessmentItemQs(t).controls)}}function _t(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"form",1)(1,"div",2)(2,"div",3)(3,"label",4),e._uU(4,"Customer"),e.qZA(),e.TgZ(5,"div",5),e._uU(6),e.qZA(),e.TgZ(7,"label",6),e._uU(8,"Order No"),e.qZA(),e.TgZ(9,"div",7),e._uU(10),e.qZA(),e.TgZ(11,"button",8),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.updateAssessment())}),e.qZA(),e._UZ(12,"button",9),e.qZA(),e.TgZ(13,"label",10),e._uU(14,"Order Assessment Items"),e.qZA(),e.TgZ(15,"div",11),e.YNc(16,ht,24,3,"div",12),e.qZA()()()}if(2&o){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(6),e.Oqu(t.orderAssessment.customerName),e.xp6(4),e.Oqu(t.orderAssessment.orderNo),e.xp6(1),e.Q6J("disabled",!t.form.valid),e.xp6(1),e.MGl("routerLink","/administration/orders/edit/",t.orderAssessment.orderId,""),e.xp6(4),e.Q6J("ngForOf",t.orderAssessmentItems.controls)}}let vt=(()=>{class o{constructor(t,r,s,n,a){this.fb=t,this.router=r,this.activatedRoute=s,this.service=n,this.toastr=a,this.form=new i.cw({}),this.returnUrl="";let l=this.router.getCurrentNavigation();l?.extras&&l.extras.state&&(l.extras.state.returnUrl&&(this.returnUrl=l.extras.state.returnUrl),l.extras.state.user&&(this.user=l.extras.state.user))}ngOnInit(){this.activatedRoute.data.subscribe(t=>{this.orderAssessment=t.orderAssessment}),void 0!==this.orderAssessment&&this.CreateAndInitializeFormArray(this.orderAssessment)}CreateAndInitializeFormArray(t){this.form=this.fb.group({id:t.id,orderId:[t.orderId,i.kI.required],orderNo:[t.orderNo,i.kI.required],customerName:[t.customerName,i.kI.required],orderAssessmentItems:this.fb.array(t.orderAssessmentItems.map(r=>this.fb.group({id:[r.id],orderAssessmentId:[r.orderAssessmentId],orderItemId:[r.orderItemId,i.kI.required],orderId:[t.orderId,i.kI.required],professionId:[r.professionId,i.kI.required],professionName:[r.professionName,i.kI.required],orderAssessmentItemQs:this.fb.array(r.orderAssessmentItemQs.map(s=>this.fb.group({id:[s.id??0],orderAssessmentItemId:r.id??0,orderItemId:[r.orderItemId,i.kI.required],orderId:r.orderId,questionNo:[s.questionNo,i.kI.required],subject:[s.subject,i.kI.required],question:[s.question,i.kI.required],maxPoints:[s.maxPoints,i.kI.required],isMandatory:[s.isMandatory,i.kI.required]})))})))})}get orderAssessmentItems(){return this.form?.get("orderAssessmentItems")}newOrderAssessmentItem(){return this.fb.group({id:0,orderAssessmentItemId:0,orderItemId:0})}addOrderAssessmentItem(){this.orderAssessmentItems.push(this.newOrderAssessmentItem)}removeOrderAssessmentItem(t){this.orderAssessmentItems.removeAt(t)}orderAssessmentItemQs(t){return this.orderAssessmentItems.at(t).get("orderAssessmentItemQs")}newOrderAssessmentItemQ(t){return this.fb.group({id:0,orderAssessmentItemId:this.orderAssessmentItems.at(t).get("id"),orderItemId:[this.orderAssessmentItems.at(t).get("orderItemId"),i.kI.required],orderId:[this.orderAssessmentItems.at(t).get("orderId"),i.kI.required],questionNo:[0,i.kI.required],subject:["",i.kI.required],question:["",i.kI.required],maxPoints:[0,i.kI.required],isMandatory:[!1,i.kI.required]})}addNewOrderAssessmentItemQ(t){this.orderAssessmentItemQs(t).push(this.newOrderAssessmentItemQ(t))}removeOrderAssessmentItemQ(t,r){this.orderAssessmentItemQs(t).removeAt(r)}updateAssessment(){if(this.orderAssessment){var t={...this.form.value};this.service.updateOrderAssessment(t).subscribe({next:r=>{""===r?this.toastr.success("Updated the Order Assessment data","success"):(this.toastr.warning("Failed to update the order assessment data","Failure"),console.log("next error:",r))}})}}static#e=this.\u0275fac=function(r){return new(r||o)(e.Y36(i.qu),e.Y36(u.F0),e.Y36(u.gz),e.Y36(C),e.Y36(_._W))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-order-assessment"]],decls:1,vars:1,consts:[["autocomplete","off",3,"formGroup",4,"ngIf"],["autocomplete","off",3,"formGroup"],[1,"stdd","my-1",2,"border-style","groove","margin","5px"],[1,"my-2"],[1,"lbl","w100"],[1,"stdd","w200"],[1,"lbl","w100","mx-2"],[1,"stdd","w100"],[1,"btn","fa","fa-save","fa-2x",2,"margin-left","50px",3,"disabled","click"],[1,"btn","fa","fa-window-close","fa-2x",3,"routerLink"],[1,"lbl"],["formArrayName","orderAssessmentItems",1,"formArray"],[4,"ngFor","ngForOf"],[2,"margin-left","25px",3,"formGroupName"],[1,"lbl",2,"margin-left","50px"],[1,"title","w50",2,"margin-left","50px"],[1,"title","w150"],[1,"title","w200"],[1,"title","w50"],[1,"title","w100"],["title","add a new Assessment Question",1,"my-1","fa","fa-plus",3,"click"],["formArrayName","orderAssessmentItemQs",1,"formArray"],[2,"margin-left","50px",3,"formGroupName"],["formControlName","questionNo",1,"stdd","w50",3,"label"],["formControlName","subject",1,"stdd","w150",3,"label"],["formControlName","question",1,"stdd","w200",3,"label"],["formControlName","maxPoints",1,"stdd","w50",3,"label"],["type","checkbox","formControlName","isMandatory",1,"stdd","w15"],[1,"stdd","fa","fa-trash","red",2,"margin-left","20px",3,"click"]],template:function(r,s){1&r&&e.YNc(0,_t,17,6,"form",0),2&r&&e.Q6J("ngIf",s.orderAssessment)},dependencies:[c.sg,c.O5,i._Y,i.Wl,i.JJ,i.JL,u.rH,i.sg,i.u,i.x0,i.CE,Z.t],styles:[".w15[_ngcontent-%COMP%]{width:15px}.w50[_ngcontent-%COMP%]{width:50px}.w100[_ngcontent-%COMP%]{width:100px}.w150[_ngcontent-%COMP%]{width:150px}.w200[_ngcontent-%COMP%]{width:200px}.stdd[_ngcontent-%COMP%]{display:inline-block;margin-left:2px;margin-right:2px;vertical-align:top;font-size:small}.lbl[_ngcontent-%COMP%]{display:inline-block;margin:0 2px;vertical-align:top;font-size:small;font-weight:700}.title[_ngcontent-%COMP%]{margin:0 2px;vertical-align:top;font-size:small;font-weight:700}.b[_ngcontent-%COMP%]{font-weight:700}.red[_ngcontent-%COMP%]{color:red}.btn[_ngcontent-%COMP%]{color:#f0f8ff;margin-left:2px;margin-right:2px}"]})}return o})();function xt(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div",6)(1,"pagination",7),e.NdJ("pageChanged",function(s){e.CHM(t);const n=e.oxw();return e.KtG(n.onPageChanged(s))}),e._uU(2," >"),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("totalItems",t.pagination.totalItems)("itemsPerPage",t.pagination.itemsPerPage)("maxSize",10)}}function Ct(o,d){1&o&&(e.TgZ(0,"div"),e._uU(1,"No Associate has been forwarded this requirement"),e.qZA())}function It(o,d){if(1&o&&(e.TgZ(0,"div")(1,"label",18),e._uU(2),e.qZA(),e.TgZ(3,"label",18),e._uU(4),e.qZA(),e.TgZ(5,"label",18),e._uU(6),e.ALo(7,"date"),e.qZA(),e._uU(8," firstLoop=false; "),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(2),e.hij("Customer Name: ",t.customerName,""),e.xp6(2),e.hij("Order No: ",t.orderNo,""),e.xp6(2),e.hij("dated: ",e.xi3(7,3,t.orderDate,"dd-MMM-yy")," ")}}function At(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"label",19),e._uU(2,"Date Forwarded"),e.qZA(),e.TgZ(3,"label",20),e._uU(4,"Associate"),e.qZA(),e.TgZ(5,"label",20),e._uU(6,"Associate Name"),e.qZA(),e.TgZ(7,"label",21),e._uU(8,"Email Forwarded to"),e.qZA(),e.TgZ(9,"label",19),e._uU(10,"Phone No"),e.qZA(),e.TgZ(11,"div",19),e._uU(12),e.ALo(13,"date"),e.qZA(),e.TgZ(14,"div",20),e._uU(15),e.qZA(),e.TgZ(16,"div",20),e._uU(17),e.qZA(),e.TgZ(18,"div",21),e._uU(19),e.qZA(),e.TgZ(20,"div",19),e._uU(21),e.qZA(),e.TgZ(22,"button",22),e.NdJ("click",function(){const n=e.CHM(t).$implicit,a=e.oxw(3);return e.KtG(a.orderCatOfficialDelete(n.id))}),e.qZA()()}if(2&o){const t=d.$implicit;e.xp6(12),e.Oqu(e.xi3(13,5,t.dateForwarded,"dd-MMM-yy")),e.xp6(3),e.Oqu(t.agentName),e.xp6(2),e.Oqu(t.officialName),e.xp6(2),e.Oqu(t.emailIdForwardedTo),e.xp6(2),e.Oqu(t.phoneNoForwardedTo)}}function Ot(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div"),e._uU(1," i+=1; "),e.YNc(2,It,9,6,"div",4),e.TgZ(3,"button",11),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.hideCategory=!s.hideCategory)}),e._uU(4),e.qZA(),e.TgZ(5,"label",12),e._uU(6,"Category Name"),e.qZA(),e.TgZ(7,"div",13),e._uU(8),e.qZA(),e.TgZ(9,"label",14),e._uU(10,"Quantity"),e.qZA(),e.TgZ(11,"div",15),e._uU(12),e.qZA(),e.TgZ(13,"label",16),e._uU(14,"Charges"),e.qZA(),e.TgZ(15,"div",15),e._uU(16),e.qZA(),e.TgZ(17,"button",17),e.NdJ("click",function(){const n=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.orderCategoryDelete(n.id))}),e.qZA(),e.YNc(18,At,23,8,"div",9),e.qZA()}if(2&o){const t=d.$implicit,r=e.oxw(2);e.xp6(2),e.Q6J("ngIf",r.firstLoop),e.xp6(2),e.Oqu(r.hideCategory?"-":"+"),e.xp6(4),e.Oqu(t.professionName),e.xp6(4),e.Oqu(t.quantity),e.xp6(4),e.Oqu(t.charges),e.xp6(2),e.Q6J("ngForOf",t.orderForwardCategoryOfficials)}}function Zt(o,d){if(1&o&&(e.TgZ(0,"div",8),e.YNc(1,Ot,19,6,"div",9),e.TgZ(2,"div",10),e._uU(3),e.ALo(4,"json"),e.qZA()()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.fwds),e.xp6(2),e.hij(" ",e.lcZ(4,2,t.form.value),"\n")}}const kt=[{path:"",component:(()=>{class o{static#e=this.\u0275fac=function(r){return new(r||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-order-menu"]],decls:2,vars:0,template:function(r,s){1&r&&(e.TgZ(0,"p"),e._uU(1,"order-menu works!"),e.qZA())}})}return o})()},{path:"orders",component:xe,resolve:{professions:j.h,customers:B}},{path:"edit/:id",component:Xe,resolve:{order:o=>{var d=o.paramMap.get("id");return null===d?(0,f.of)(null):"0"===d?(0,f.of)(new et):(0,e.f3M)(y.p).getOrder(+d)},customers:B,employees:()=>(0,e.f3M)(z.G).getEmployeeIdAndKnownAs(),professions:j.h}},{path:"DLForwarded/:id",component:(()=>{class o{constructor(t,r,s,n){this.fb=t,this.activatedRoute=r,this.service=s,this.toastr=n,this.form=new i.cw({}),this.fwds=[],this.fwdParams=new U,this.totalCount=0,this.hideCategory=!1,this.customerName="",this.orderNo=0,this.firstLoop=!0}ngOnInit(){this.activatedRoute.data.subscribe({next:t=>{this.fwds=t.DLForwarded.result,this.pagination=t.pagination,this.totalCount=t.totalCount,console.log("fwds",this.fwds);var r=this.fwds[0];this.customerName=r.customerName,this.orderNo=r.orderNo,this.orderDate=r.orderDate}})}loadFwdRecords(t){this.service.setFwdParams(t),this.service.getForwardsBriefPaginated(t).subscribe({next:r=>{console.log("DLForwarded OrderFwdToAgent",r),r.result&&r.pagination&&(this.fwds=r.result,this.pagination=r.pagination,this.totalCount=r.pagination.totalItems)},error:r=>console.log(r)})}onPageChanged(t){const r=this.service.getFwdParams();r.pageNumber!==t&&(r.pageNumber=t,this.service.setFwdParams(r),this.loadFwdRecords(r))}orderFwdDelete(){this.service.deleteForward(this.fwds[0].id).subscribe({next:t=>{t?this.toastr.success("Deleted","The Order Forward along with its related records was deleted"):this.toastr.warning("Failed to delete the Order forward","Failure")}})}orderCategoryDelete(t){this.service.deleteOrderFwdCategory(t).subscribe({next:r=>{this.toastr.success("Deleted","The Order Forward along with its related records was deleted");var s=this.fwds?.findIndex(n=>n.id===t.id);-1!==s&&this.fwds?.splice(s,1)}})}orderCatOfficialDelete(t){}static#e=this.\u0275fac=function(r){return new(r||o)(e.Y36(i.qu),e.Y36(u.gz),e.Y36(x),e.Y36(_._W))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-order-fwds"]],decls:7,vars:3,consts:[["style","display: inline-block; margin-left: 15px;",4,"ngIf"],[2,"font-size","medium","font-weight","bold","display","inline-block"],["title","delete order forwarded to agent","title","delete all forward related data concerning this Job Order",1,"btn","btn-sm","fa","fa-trash","red","pull-right",3,"click"],["routerLink","/orders",1,"stdd","btn","btn-outline-success","pull-right","fa","fa-window-close","fa-2x"],[4,"ngIf"],["class","form-inline b",4,"ngIf"],[2,"display","inline-block","margin-left","15px"],["previousText","\u2039","nextText","\u203a","firstText","\xab","lastText","\xbb",3,"totalItems","itemsPerPage","maxSize","pageChanged"],[1,"form-inline","b"],[4,"ngFor","ngForOf"],[2,"font-size","smaller"],[2,"display","inline-block","font-size","large","font-weight","bold",3,"click"],[1,"stdd","b","w100"],[1,"stdd","b","w200"],[1,"stddLeft50","b","w50"],[1,"stdd","w50","b"],[1,"stdd","w70","b"],["title","delete this category.  Any agency offcials forwarded to will also be deleted",1,"btn","pull-right","fa","fa-trash","red",3,"click"],[1,"stdd","w200","b"],[1,"stdd","w100"],[1,"stdd","w250"],[1,"stdd","w200"],["title","delete official",1,"btn","btn-sm","fa","fa-trash","red",2,"margin-left","17px",3,"click"]],template:function(r,s){1&r&&(e.YNc(0,xt,3,3,"div",0),e.TgZ(1,"div",1),e._uU(2," Demand Letter forwarded to Associates"),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return s.orderFwdDelete()}),e.qZA(),e._UZ(4,"button",3),e.YNc(5,Ct,2,0,"div",4),e.YNc(6,Zt,5,4,"div",5)),2&r&&(e.Q6J("ngIf",void 0!==s.pagination),e.xp6(5),e.Q6J("ngIf",!s.fwds),e.xp6(1),e.Q6J("ngIf",s.fwds.length))},dependencies:[c.sg,c.O5,u.rH,F.Qt,c.Ts,c.uU],styles:[".stdd[_ngcontent-%COMP%]{display:inline-block;font-size:small;vertical-align:top;margin:0 2px}.stddLeft50[_ngcontent-%COMP%]{display:inline-block;font-size:small;vertical-align:top;margin:0 2px 0 50px}.mL320[_ngcontent-%COMP%]{margin-left:326x}.ml170[_ngcontent-%COMP%]{margin-left:174px}.b[_ngcontent-%COMP%]{font-weight:700}.red[_ngcontent-%COMP%]{color:red}.mL50[_ngcontent-%COMP%]{margin-left:50px}.w50[_ngcontent-%COMP%]{width:50px}.w70[_ngcontent-%COMP%]{width:70px}.w100[_ngcontent-%COMP%]{width:100px}.w150[_ngcontent-%COMP%]{width:150px}.w300[_ngcontent-%COMP%]{width:300px}.w200[_ngcontent-%COMP%]{width:200px}"]})}return o})(),resolve:{DLForwarded:o=>{var d=o.paramMap.get("id");if(null===d)return(0,f.of)(null);var t=(0,e.f3M)(x),r=new U;return r.orderId=+d,t.getForwardsBriefPaginated(r)}}},{path:"ordersforwarded",component:nt,resolve:{orderfwd:o=>{var d=o.paramMap.get("orderid");return null===d?(0,f.of)(null):(0,e.f3M)(x).getOrderForwardOfAnOrder(+d)},customers:()=>(0,e.f3M)(Q.v).getOfficialAndCustomerName()}},{path:"orderassessmentitem/:id",component:ut,resolve:{assessmentItem:o=>{var d=o.paramMap.get("id");return null===d?(0,f.of)(null):(0,e.f3M)(C).getOrderAssessmentItem(+d)}}},{path:"orderitemreview/:id",component:K,resolve:{orderitemreview:o=>{var d=o.paramMap.get("id");return null===d?(0,f.of)(null):(0,e.f3M)(P).getContractReviewItem(+d)}}},{path:"orderassessment/:id",component:vt,resolve:{orderAssessment:o=>{var d=o.paramMap.get("id");return null===d?(0,f.of)(null):(0,e.f3M)(C).getOrderAssessment(+d)}}}];let yt=(()=>{class o{static#e=this.\u0275fac=function(r){return new(r||o)};static#t=this.\u0275mod=e.oAB({type:o});static#r=this.\u0275inj=e.cJS({imports:[c.ez,u.Bz.forChild(kt),u.Bz]})}return o})();var Nt=m(617);let qt=(()=>{class o{static#e=this.\u0275fac=function(r){return new(r||o)};static#t=this.\u0275mod=e.oAB({type:o});static#r=this.\u0275inj=e.cJS({imports:[c.ez,i.u5,yt,V.m,Nt.Ps]})}return o})()}}]);