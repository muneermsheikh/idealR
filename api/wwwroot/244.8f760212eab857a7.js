"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[244],{5244:(me,Z,d)=>{d.r(Z),d.d(Z,{DeploymentModule:()=>ge});var g=d(6814),I=d(371),e=d(5879);class y{constructor(){this.cvRefId=0,this.orderItemId=0,this.candidateId=0,this.selectedOn=new Date,this.orderNo=0,this.customerId=0,this.currentStatus="",this.search="",this.pageNumber=1,this.pageSize=10}}var l=d(6223),C=d(2051),v=d(8763),b=d(7411),O=d(7328),_=d(2096),w=d(7398),U=d(5516),q=d(3976),E=d(9862);let m=(()=>{class s{constructor(t){this.http=t,this.apiUrl=U.N.apiUrl,this.currentUserSource=new O.t(1),this.currentUser$=this.currentUserSource.asObservable(),this.deployStages=[],this.depSeqAndNames=[],this.deploys=[],this.cache=new Map,this.dParams=new y,this.deployments=[]}setParams(t){this.dParams=t}getParams(){return this.dParams}getDeploymentPagedList(t){const n=this.cache.get(Object.values(t).join("-"));if(n)return(0,_.of)(n);let i=(0,q.E2)(t);return(0,q.Tr)(this.apiUrl+"Deployment/deployments",i,this.http).pipe((0,w.U)(o=>(this.cache.set(Object.values(t).join("-"),o),o)))}getDepStatusAndNames(){return this.depSeqAndNames.length>0?(0,_.of)(this.depSeqAndNames):this.http.get(this.apiUrl+"Deployment/deployStatusSeqAndNames").pipe((0,w.U)(t=>(this.depSeqAndNames=t,t)))}getDeployStatuses(){return this.deployStages.length>0?(0,_.of)(this.deployStages):this.http.get(this.apiUrl+"Deployment/deployStatusData").pipe((0,w.U)(t=>(this.deployStages=t,t)))}getDeploymentWithItems(t){return this.http.get(this.apiUrl+"Deployment/deployment/"+t)}updateDeployment(t){return this.http.put(this.apiUrl+"Deployment/deployment",t)}updateDeploymentItem(t){return this.http.put(this.apiUrl+"Deployment/depItem",t)}insertDepItemsWithTravelBooked(t){return this.http.post(this.apiUrl+"Deployment/insertItemsWithFlight",t)}getFlightData(){return this.http.get(this.apiUrl+"Deployment/flightdata")}getCandidateFlight(t){return this.http.get(this.apiUrl+"Deployment/candidateflight/"+t)}deleteCandidateFlight(t){return this.http.delete(this.apiUrl+"Deployment/CandidateFlight/"+t)}editCandidateFlight(t){return this.http.put(this.apiUrl+"Deployment/CandidateFlight",t)}InsertDepItems(t){return this.http.post(this.apiUrl+"Deployment/depItems",t)}getCVReferredDto(t){return this.http.get(this.apiUrl+"Deployment/bycvrefid/"+t)}getNextDepItemFromCVRefId(t){return this.http.get(this.apiUrl+"Deployment/nextDepItemFromCVRef/"+t)}getNextSequence(t,n){return 700===t?n?1300:900:this.deployStages.find(i=>i.sequence==t)?.nextSequence}NextSequenceProposedIsOkay(t,n,i){var o=this.getNextSequence(t,i);if(n===o)return!0;var a=this.deployStages.find(r=>r.sequence===n);return!(!a?.isOptional||n-t!=200)}getDepStage(t){return this.deployStages.length>0?this.deployStages.filter(n=>n.sequence==t)[0]:null}getNextStage(t,n){if(this.deployStages.length>0){var i=this.getNextSequence(t,n);return this.deployStages.filter(o=>o.sequence===i)[0]}return null}getNextStageDate(t){var n=this.deployStages.find(i=>i.id==t)?.estimatedDaysToCompleteThisStage;return void 0!==n?new Date((new Date).setDate((new Date).getDate()+n)):new Date}deleteDeployment(t){return this.http.delete(this.apiUrl+"Deployment/dep/"+t)}static#e=this.\u0275fac=function(n){return new(n||s)(e.LFG(E.eN))};static#t=this.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var f=d(7133),u=d(3593),T=d(4807);function J(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",3)(1,"h6"),e._uU(2,"Edit Deployment records"),e.qZA(),e.TgZ(3,"button",4),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.updateDeployment())}),e.qZA(),e.TgZ(4,"button",5),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.close())}),e.qZA()()}}const A=function(){return{dateInputFormat:"YYYY-MM-DD"}};function k(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div")(1,"div",21),e._UZ(2,"input",22)(3,"ng-select",23)(4,"ng-select",24)(5,"input",25),e.TgZ(6,"button",26),e.NdJ("click",function(){const o=e.CHM(t).index,a=e.oxw(2);return e.KtG(a.removeDepItem(o))}),e.qZA()()()}if(2&s){const t=c.index,n=e.oxw(2);e.xp6(1),e.Q6J("formGroupName",t),e.xp6(1),e.Q6J("bsValue",n.bsValueDate)("bsConfig",e.DdM(7,A)),e.xp6(1),e.Q6J("items",n.depStatusAndNames),e.xp6(1),e.Q6J("items",n.depStatusAndNames),e.xp6(1),e.Q6J("bsValue",n.bsValueDate)("bsConfig",e.DdM(8,A))}}function V(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",6)(1,"form",7)(2,"label",8),e._uU(3,"Candidate:"),e.qZA(),e.TgZ(4,"div",9),e._uU(5),e.qZA(),e.TgZ(6,"label",10),e._uU(7,"Customer:"),e.qZA(),e.TgZ(8,"div",9),e._uU(9),e.qZA(),e._UZ(10,"br"),e.TgZ(11,"label",10),e._uU(12,"Category Ref"),e.qZA(),e.TgZ(13,"div",9),e._uU(14),e.qZA(),e.TgZ(15,"label",11),e._uU(16,"ECNR"),e.qZA(),e.TgZ(17,"div",12),e._uU(18),e.qZA(),e._UZ(19,"br"),e.TgZ(20,"label",13),e._uU(21,"Selected On"),e.qZA(),e.TgZ(22,"div",9),e._uU(23),e.ALo(24,"date"),e.qZA(),e.TgZ(25,"label",13),e._uU(26,"Current Status:"),e.qZA(),e.TgZ(27,"div",14),e._uU(28),e.qZA(),e._UZ(29,"hr",15),e.TgZ(30,"label",16),e._uU(31,"Date"),e.qZA(),e.TgZ(32,"label",17),e._uU(33,"Process Name"),e.qZA(),e.TgZ(34,"label",17),e._uU(35,"Next Process"),e.qZA(),e.TgZ(36,"label",16),e._uU(37,"Next Process"),e._UZ(38,"br"),e._uU(39,"Estimated Dt"),e.qZA(),e.TgZ(40,"button",18),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.addDepItem())}),e.qZA(),e.TgZ(41,"div",19),e.YNc(42,k,7,9,"div",20),e.qZA()()()}if(2&s){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.form),e.xp6(4),e.Oqu(t.candidateName),e.xp6(4),e.Oqu(t.companyName),e.xp6(5),e.Oqu(t.categoryRef),e.xp6(4),e.Oqu(t.dep.ecnr?"Yes":"No"),e.xp6(5),e.Oqu(e.xi3(24,8,t.dep.selectedOn,"dd-MMM-yy")),e.xp6(5),e.Oqu(t.dep.currentStatus),e.xp6(14),e.Q6J("ngForOf",t.depItems.controls)}}let P=(()=>{class s{constructor(t,n,i,o,a,r){this.bsModalRef=t,this.toastr=n,this.confirmService=i,this.fb=o,this.service=a,this.activatedRoute=r,this.updateDep=new e.vpe,this.ecnr=!1,this.form=new l.cw({}),this.candidateName="",this.categoryRef="",this.companyName="",this.depStatusAndNames=[],this.bsValue=new Date,this.bsRangeValue=new Date,this.maxDate=new Date,this.minDate=new Date,this.bsValueDate=new Date}ngOnInit(){this.dep&&this.InitializeForm(this.dep)}InitializeForm(t){this.form=this.fb.group({id:[t.id],cVRefId:[t.cvRefId],orderItemId:[t.orderItemId],customerId:t.customerId,selectedOn:t.selectedOn,currentStatus:t.currentStatus,ecnr:t.ecnr,depItems:this.fb.array(t.depItems.map(n=>this.fb.group({id:n.id,depId:n.depId,transactionDate:n.transactionDate,sequence:n.sequence,nextSequence:n.nextSequence,nextSequenceDate:n.nextSequenceDate})))})}get depItems(){return this.form.get("depItems")}newDepItem(){return this.fb.group({id:0,depId:this.form.get("id")?.value,transactionDate:new Date,sequence:this.depItems.value[this.depItems.length].map(t=>t.nextSequence),nextSequence:this.service.getNextSequence(this.depItems.value[this.depItems.length].map(t=>t.nextSequence),this.ecnr),nextSequenceDate:this.service.getNextStageDate(this.depItems.value[this.depItems.length].map(t=>t.nextSequence))})}addDepItem(){this.depItems.push(this.newDepItem)}removeDepItem(t){var n="This will also delete ";n+=+t+1,this.confirmService.confirm("Confirm Delete",n+=" transactions that are after the date of this transaction.  THE DELETION WILL TAKE EFFECT ONLY AFTER YOU UPDATE THIS FORM").subscribe({next:i=>{if(i)for(let o=+t+1;o--;o<=t)console.log(t,o),this.depItems.removeAt(o)}})}updateDeployment(){this.updateDep.emit(this.form.value),this.bsModalRef.hide()}close(){this.bsModalRef.hide()}static#e=this.\u0275fac=function(n){return new(n||s)(e.Y36(C.UZ),e.Y36(v._W),e.Y36(b.z),e.Y36(l.qu),e.Y36(m),e.Y36(f.gz))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-deploy-edit-modal"]],inputs:{dep:"dep",updateDep:"updateDep"},decls:3,vars:2,consts:[["class","modal-header my-0",4,"ngIf"],["class","modal-body my-0",4,"ngIf"],[1,"modal-footer"],[1,"modal-header","my-0"],["title","edit emp data",1,"w35","btn","btn-success","fa","fa-save",2,"margin-left","200px",3,"click"],["title","Close",1,"btn","fa","fa-close","pull-right",3,"click"],[1,"modal-body","my-0"],[3,"formGroup"],["for","applicationNo",1,"stdd","w125","b"],[1,"stdd","w150"],["for","customerName",1,"stdd","w125","b"],[1,"stdd","w50","b"],[1,"stdd","w50"],[1,"stdd","w125","b"],[1,"stdd","w250"],[1,"my-0"],[1,"stdd","w110","b","vMiddle"],[1,"stdd","w200","b","vMiddle"],[1,"btn","fa","fa-plus","pull-right",3,"click"],["formArrayName","depItems"],[4,"ngFor","ngForOf"],[3,"formGroupName"],["type","text","placeholder","Selected On","formControlName","transactionDate","bsDatepicker","",1,"stdd","w100",3,"bsValue","bsConfig"],["bindLabel","name","bindValue","id","labelForId","id","formControlName","sequence",1,"stdd","w200",2,"height","fit-content","border-color","black",3,"items"],["bindLabel","name","bindValue","id","labelForId","id","clearAllText","Clear","formControlName","nextSequence",1,"stdd","w200",2,"border","rgb(from color r g b)",3,"items"],["type","text","placeholder","Selected On","formControlName","nextSequenceDate","bsDatepicker","",1,"stdd","w110",3,"bsValue","bsConfig"],[1,"btn","w25","fa","fa-trash","fa-sm","red",3,"click"]],template:function(n,i){1&n&&(e.YNc(0,J,5,0,"div",0),e.YNc(1,V,43,11,"div",1),e._UZ(2,"div",2)),2&n&&(e.Q6J("ngIf",i.dep),e.xp6(1),e.Q6J("ngIf",i.dep))},dependencies:[g.sg,g.O5,u.Np,u.Y5,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,l.x0,l.CE,T.w9,g.uU],styles:[".stdd[_ngcontent-%COMP%]{display:inline-block;font-size:small;margin:0 2px;padding:0;vertical-align:top}.vMiddle[_ngcontent-%COMP%]{vertical-align:middle}.b[_ngcontent-%COMP%]{font-weight:700}.red[_ngcontent-%COMP%]{color:red}.w50[_ngcontent-%COMP%]{width:50px}.w100[_ngcontent-%COMP%]{width:100px}.w110[_ngcontent-%COMP%]{width:110px}.w150[_ngcontent-%COMP%]{width:150px;word-wrap:normal}.w125[_ngcontent-%COMP%]{width:125px}.w200[_ngcontent-%COMP%]{width:200px}.w250[_ngcontent-%COMP%]{width:250px}"]})}return s})();var Y=d(8645),D=d(2181),x=d(4664),S=d(6306),R=d(9397);class G{constructor(){this.id=0,this.depId=0,this.transactionDate=new Date,this.sequence=0,this.nextSequence=0,this.nextSequenceDate=new Date}}const H=["editForm"],N=function(){return{dateInputFormat:"YYYY-MM-DD"}};let L=(()=>{class s{constructor(t,n,i,o){this.bsModalRef=t,this.toastr=n,this.confirmService=i,this.service=o,this.cvRefId=0,this.depItem=new G,this.updateDepItem=new e.vpe,this.candidateName="",this.categoryRef="",this.companyName="",this.ecnr=!1,this.depStatuses=[],this.bsValue=new Date,this.bsRangeValue=new Date,this.maxDate=new Date,this.minDate=new Date,this.bsValueDate=new Date,this.service.getDeployStatuses().subscribe({next:a=>this.depStatuses=a})}ngOnInit(){0!==this.cvRefId&&this.service.getNextDepItemFromCVRefId(this.cvRefId).subscribe({next:t=>{null!==t&&(this.depItem=t)}})}saveDepItem(){this.confirmService.confirm("cofirm Save","Press Ok to proceed").subscribe({next:t=>{t&&(this.updateDepItem.emit(this.editForm?.value),this.bsModalRef.hide())}})}close(){this.bsModalRef.hide()}static#e=this.\u0275fac=function(n){return new(n||s)(e.Y36(C.UZ),e.Y36(v._W),e.Y36(b.z),e.Y36(m))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-deploy-add-modal"]],viewQuery:function(n,i){if(1&n&&e.Gf(H,5),2&n){let o;e.iGM(o=e.CRH())&&(i.editForm=o.first)}},inputs:{cvRefId:"cvRefId",updateDepItem:"updateDepItem"},decls:37,vars:16,consts:[[1,"modal-header"],["title","edit emp data",1,"w35","btn","btn-success","fa","fa-save",2,"margin-left","200px",3,"click"],["title","Close",1,"btn","fa","fa-close","pull-right",3,"click"],[1,"modal-body"],["for","applicationNo",1,"stdd","w150","b"],[1,"stdd","w200"],["for","customerName",1,"stdd","w150","b"],[1,"stdd","w150"],[1,"stdd","w50"],["id","editForm"],["editForm","ngForm"],[2,"display","inline-block","width","110px"],["type","text","placeholder","Offer accepted On","bsDatepicker","",1,"stdd","w110",3,"ngModel","bsValue","bsConfig","ngModelChange"],[1,"stdd","w125"],["bindLabel","status","bindValue","depItem.sequence","labelForId","depItem.status","clearAllText","Clear",2,"border","color(from color srgb r g b)","font-size","smaller",3,"items","ngModel","ngModelChange"],["bindLabel","status","bindValue","depItem.nextSequence","labelForId","depItem.status","clearAllText","Clear",2,"border","color(from color srgb r g b)","font-size","smaller",3,"items","ngModel","ngModelChange"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0)(1,"h6"),e._uU(2,"Add a deployment transaction"),e.qZA(),e.TgZ(3,"button",1),e.NdJ("click",function(){return i.saveDepItem()}),e.qZA(),e.TgZ(4,"button",2),e.NdJ("click",function(){return i.close()}),e.qZA()(),e.TgZ(5,"div",3)(6,"label",4),e._uU(7,"Application No:"),e.qZA(),e.TgZ(8,"div",5),e._uU(9),e.qZA(),e._UZ(10,"br"),e.TgZ(11,"label",6),e._uU(12,"Customer Name"),e.qZA(),e.TgZ(13,"div",5),e._uU(14),e.qZA(),e._UZ(15,"br"),e.TgZ(16,"label",6),e._uU(17,"Category Ref"),e.qZA(),e.TgZ(18,"div",5),e._uU(19),e.qZA(),e._UZ(20,"br"),e.TgZ(21,"label",7),e._uU(22,"Emig Clearance Required"),e.qZA(),e.TgZ(23,"div",8),e._uU(24),e.qZA(),e.TgZ(25,"h6"),e._uU(26,"Deployment Transaction to add:"),e.qZA(),e.TgZ(27,"form",9,10)(29,"div",11)(30,"input",12),e.NdJ("ngModelChange",function(a){return i.depItem.transactionDate=a}),e.qZA()(),e.TgZ(31,"div",13)(32,"ng-select",14),e.NdJ("ngModelChange",function(a){return i.depItem.sequence=a}),e.qZA()(),e.TgZ(33,"div",13)(34,"ng-select",15),e.NdJ("ngModelChange",function(a){return i.depItem.nextSequence=a}),e.qZA()(),e.TgZ(35,"div",11)(36,"input",12),e.NdJ("ngModelChange",function(a){return i.depItem.nextSequenceDate=a}),e.qZA()()()()),2&n&&(e.xp6(9),e.Oqu(i.candidateName),e.xp6(5),e.Oqu(i.companyName),e.xp6(5),e.Oqu(i.categoryRef),e.xp6(5),e.Oqu(i.ecnr?"YES":"NO"),e.xp6(6),e.Q6J("ngModel",i.depItem.transactionDate)("bsValue",i.bsValueDate)("bsConfig",e.DdM(14,N)),e.xp6(2),e.Q6J("items",i.depStatuses)("ngModel",i.depItem.sequence),e.xp6(2),e.Q6J("items",i.depStatuses)("ngModel",i.depItem.nextSequence),e.xp6(2),e.Q6J("ngModel",i.depItem.nextSequenceDate)("bsValue",i.bsValueDate)("bsConfig",e.DdM(15,N)))},dependencies:[u.Np,u.Y5,l._Y,l.Fj,l.JJ,l.JL,l.On,l.F,T.w9]})}return s})();function Q(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"h6"),e._uU(2,"Choose a flight"),e.qZA(),e.TgZ(3,"button",5),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.registerDate())}),e.qZA(),e.TgZ(4,"button",6),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.close())}),e.qZA()()}}function K(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div")(1,"input",20),e.NdJ("ngModelChange",function(i){const a=e.CHM(t).$implicit;return e.KtG(a.checked=i)})("click",function(){const o=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.selectedClicked(o))}),e.qZA(),e.TgZ(2,"input",21),e.NdJ("ngModelChange",function(i){const a=e.CHM(t).$implicit;return e.KtG(a.airportOfDestination=i)}),e.qZA(),e.TgZ(3,"input",21),e.NdJ("ngModelChange",function(i){const a=e.CHM(t).$implicit;return e.KtG(a.airportOfBoarding=i)}),e.qZA(),e.TgZ(4,"input",22),e.NdJ("ngModelChange",function(i){const a=e.CHM(t).$implicit;return e.KtG(a.flightNo=i)}),e.qZA(),e.TgZ(5,"input",23),e.NdJ("ngModelChange",function(i){const a=e.CHM(t).$implicit;return e.KtG(a.eTD_Boarding=i)}),e.qZA(),e.TgZ(6,"input",23),e.NdJ("ngModelChange",function(i){const a=e.CHM(t).$implicit;return e.KtG(a.eTA_Destination=i)}),e.qZA(),e.TgZ(7,"input",24),e.NdJ("ngModelChange",function(i){const a=e.CHM(t).$implicit;return e.KtG(a.airportVia=i)}),e.qZA(),e.TgZ(8,"input",24),e.NdJ("ngModelChange",function(i){const a=e.CHM(t).$implicit;return e.KtG(a.flightNoVia=i)}),e.qZA(),e.TgZ(9,"input",25),e.NdJ("ngModelChange",function(i){const a=e.CHM(t).$implicit;return e.KtG(a.eTA_Via=i)}),e.qZA(),e.TgZ(10,"input",25),e.NdJ("ngModelChange",function(i){const a=e.CHM(t).$implicit;return e.KtG(a.eTD_Via=i)}),e.qZA()()}if(2&s){const t=c.$implicit;e.xp6(1),e.Q6J("ngModel",t.checked),e.xp6(1),e.Q6J("ngModel",t.airportOfDestination),e.xp6(1),e.Q6J("ngModel",t.airportOfBoarding),e.xp6(1),e.Q6J("ngModel",t.flightNo),e.xp6(1),e.Q6J("ngModel",t.eTD_Boarding),e.xp6(1),e.Q6J("ngModel",t.eTA_Destination),e.xp6(1),e.Q6J("ngModel",t.airportVia),e.xp6(1),e.Q6J("ngModel",t.flightNoVia),e.xp6(1),e.Q6J("ngModel",t.eTA_Via),e.xp6(1),e.Q6J("ngModel",t.eTD_Via)}}const B=function(){return{dateInputFormat:"YYYY-MM-DD"}};function z(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",7)(1,"label",8),e._uU(2,"Date of the flight"),e.qZA(),e.TgZ(3,"input",9),e.NdJ("ngModelChange",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.flightDate=i)}),e.qZA(),e.TgZ(4,"label",10),e._uU(5,"Destination"),e.qZA(),e.TgZ(6,"input",11),e.NdJ("ngModelChange",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.destinationAirport=i)}),e.qZA(),e.TgZ(7,"input",12),e.NdJ("ngModelChange",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.filterDestination=i)}),e.qZA(),e._uU(8,"Yes "),e.TgZ(9,"input",13),e.NdJ("ngModelChange",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.filterDestination=i)}),e.qZA(),e._uU(10," No "),e.TgZ(11,"button",14),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.filter())}),e.qZA(),e._UZ(12,"hr"),e.TgZ(13,"label",15),e._uU(14,"Sel"),e.qZA(),e.TgZ(15,"label",10),e._uU(16,"Airport"),e._UZ(17,"br"),e._uU(18,"of Destn"),e.qZA(),e.TgZ(19,"label",10),e._uU(20,"Airport"),e._UZ(21,"br"),e._uU(22,"of Boardg"),e.qZA(),e.TgZ(23,"label",16),e._uU(24,"Flight No"),e.qZA(),e.TgZ(25,"label",17),e._uU(26,"ETD"),e._UZ(27,"br"),e._uU(28,"Boarding"),e.qZA(),e.TgZ(29,"label",17),e._uU(30,"ETA"),e._UZ(31,"br"),e._uU(32,"Destin"),e.qZA(),e.TgZ(33,"label",18),e._uU(34,"Via Airport"),e.qZA(),e.TgZ(35,"label",18),e._uU(36,"Flight"),e._UZ(37,"br"),e._uU(38,"No Via"),e.qZA(),e.TgZ(39,"label",18),e._uU(40,"ETA"),e._UZ(41,"br"),e._uU(42,"at Via"),e.qZA(),e.TgZ(43,"label",18),e._uU(44,"ETD"),e._UZ(45,"br"),e._uU(46,"at Via"),e.qZA(),e.YNc(47,K,11,10,"div",19),e.qZA()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("ngModel",t.flightDate)("bsValue",t.bsValueDate)("bsConfig",e.DdM(7,B)),e.xp6(3),e.Q6J("ngModel",t.destinationAirport),e.xp6(1),e.Q6J("ngModel",t.filterDestination),e.xp6(2),e.Q6J("ngModel",t.filterDestination),e.xp6(38),e.Q6J("ngForOf",t.flightdata)}}let j=(()=>{class s{constructor(t,n,i){this.bsModalRef=t,this.confirmService=n,this.service=i,this.updateFlight=new e.vpe,this.selectedEvent=new e.vpe,this.destinationAirport="",this.filterDestination="",this.flightdata=[],this.originalFlightdata=[],this.bsValue=new Date,this.bsRangeValue=new Date,this.maxDate=new Date,this.minDate=new Date,this.bsValueDate=new Date,this.flightDate=new Date,i.getFlightData().subscribe({next:o=>{this.originalFlightdata=o,this.filterDestination="Yes",console.log(o)}})}ngOnInit(){}selectedClicked(t){this.flightSelected=t,this.flightdata.filter(n=>n.id!=t.id).forEach(n=>n.checked=!1)}filter(){this.flightdata="Y"===this.filterDestination?this.flightdata.filter(t=>t.airportOfDestination===this.destinationAirport):this.originalFlightdata}close(){this.updateFlight.emit(void 0),this.bsModalRef.hide()}registerDate(){if(!(this.flightDate.getFullYear()<2e3)&&void 0!==this.flightSelected){let n=new Date(this.flightDate.getTime()),[i,o]=this.flightSelected.eTD_Boarding.toString().split(":");n.setHours(n.getHours()+ +i+5),n.setMinutes(n.getMinutes()+ +o+30);let a=new Date(this.flightDate.getTime()),[r,p]=this.flightSelected.eTA_Destination.toString().split(":");a.setHours(a.getHours()+ +r+5),a.setMinutes(a.getMinutes()+ +p+30),console.log("etd",n,"eta",a),this.updateFlight.emit({dateOfFlight:this.flightDate,flightNo:this.flightSelected.flightNo,airportOfBoarding:this.flightSelected.airportOfBoarding,flightNoVia:this.flightSelected.flightNoVia,depId:0,airportOfDestination:this.flightSelected.airportOfDestination,eTD_Boarding:n,eTA_Destination:a,airportVia:this.flightSelected.airportVia}),this.bsModalRef.hide()}}static#e=this.\u0275fac=function(n){return new(n||s)(e.Y36(C.UZ),e.Y36(b.z),e.Y36(m))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-choose-flight-modal"]],inputs:{updateFlight:"updateFlight"},outputs:{selectedEvent:"selectedEvent"},decls:4,vars:2,consts:[["class","modal-header my-0",4,"ngIf"],["class","modal-body my-0",4,"ngIf"],[1,"modal-footer","my-0"],[2,"font-size","x-small"],[1,"modal-header","my-0"],["title","edit emp data",1,"w35","btn","btn-success","fa","fa-check",2,"margin-left","200px",3,"click"],["title","Close",1,"btn","fa","fa-close","pull-right",3,"click"],[1,"modal-body","my-0"],[1,"lbl","w125"],["type","text","placeholder","Flight Date","bsDatepicker","",1,"stdd","w100",3,"ngModel","bsValue","bsConfig","ngModelChange"],[1,"lbl","w100"],["type","text",1,"stdd","w125",3,"ngModel","ngModelChange"],["type","radio","value","Y","title","filter flight details by the destination",1,"stdd","w50",3,"ngModel","ngModelChange"],["type","radio","value","N","title","show all flight details",1,"stdd","w50",3,"ngModel","ngModelChange"],["title","filter the flight details",1,"btn","fa","fa-filter",3,"click"],[1,"lbl","w20",2,"margin-left","10px !important"],[1,"lbl","w60"],[1,"lbl","w90"],[1,"lbl","blue","w60"],[4,"ngFor","ngForOf"],["type","checkbox",1,"form-check-input","w20","hAlignCenter",2,"margin-left","10px","border-color","black",3,"ngModel","ngModelChange","click"],["type","text",1,"stdd","w100",3,"ngModel","ngModelChange"],["type","text",1,"stdd","w60",3,"ngModel","ngModelChange"],["type","time",1,"stdd","w90",3,"ngModel","ngModelChange"],["type","text",1,"stdd","blue","w60",3,"ngModel","ngModelChange"],["type","time",1,"stdd","blue","w60",3,"ngModel","ngModelChange"]],template:function(n,i){1&n&&(e.YNc(0,Q,5,0,"div",0),e.YNc(1,z,48,8,"div",1),e._UZ(2,"div",2)(3,"div",3)),2&n&&(e.Q6J("ngIf",i.flightdata),e.xp6(1),e.Q6J("ngIf",i.flightdata))},dependencies:[g.sg,g.O5,u.Np,u.Y5,l.Fj,l.Wl,l._,l.JJ,l.On],styles:[".w20[_ngcontent-%COMP%]{width:20px}.w60[_ngcontent-%COMP%]{width:60px}.w75[_ngcontent-%COMP%]{width:75px}.w90[_ngcontent-%COMP%]{width:90px}.w100[_ngcontent-%COMP%]{width:100px}.w125[_ngcontent-%COMP%]{width:125px}.mL120[_ngcontent-%COMP%]{margin-left:120px}.lbl[_ngcontent-%COMP%]{display:inline-block;font-size:small;margin:0 2px;font-weight:700;font-size:smaller;vertical-align:middle;word-wrap:normal}.blue[_ngcontent-%COMP%]{color:#00008b}.stdd[_ngcontent-%COMP%]{display:inline-block;font-size:smaller;margin:0 2px;word-wrap:normal}.line2[_ngcontent-%COMP%]{color:#00008b;display:inline-block;margin:0 2px;font-weight:700;font-size:smaller;vertical-align:middle;word-wrap:normal}"]})}return s})();function $(s,c){1&s&&e._UZ(0,"div",3)}function W(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",21)(1,"label",18),e._uU(2,"Airport Via"),e.qZA(),e.TgZ(3,"input",22),e.NdJ("ngModelChange",function(i){e.CHM(t);const o=e.oxw(3);return e.KtG(o.flight.airportVia=i)}),e.qZA()()}if(2&s){const t=e.oxw(3);e.xp6(3),e.Q6J("ngModel",t.flight.airportVia)}}const M=function(){return{dateInputFormat:"YYYY-MMM-DD hh:nn"}};function X(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",16),e.YNc(1,W,4,1,"div",17),e.TgZ(2,"label",18),e._uU(3,"ETA"),e.qZA(),e.TgZ(4,"input",19),e.NdJ("ngModelChange",function(i){e.CHM(t);const o=e.oxw(2);return e.KtG(o.flight.eTA_Via=i)}),e.qZA(),e.TgZ(5,"input",20),e.NdJ("ngModelChange",function(i){e.CHM(t);const o=e.oxw(2);return e.KtG(o.flight.eTD_Via=i)}),e.qZA()()}if(2&s){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",""!==t.flight.airportVia||null!==t.flight.airportVia),e.xp6(3),e.Q6J("ngModel",t.flight.eTA_Via)("bsValue",t.bsValueDate)("bsConfig",e.DdM(7,M)),e.xp6(1),e.Q6J("ngModel",t.flight.eTD_Via)("bsValue",t.bsValueDate)("bsConfig",e.DdM(8,M))}}function ee(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"form")(2,"div",5)(3,"div",6)(4,"button",7),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.bsModalRef.hide())}),e.qZA(),e.TgZ(5,"button",8),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.deleteCandidateFlight())}),e.qZA(),e.TgZ(6,"button",9),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.saveCandidateFlight())}),e.qZA()(),e._UZ(7,"br"),e.TgZ(8,"label",10),e._uU(9,"Airport of Boarding"),e.qZA(),e.TgZ(10,"input",11),e.NdJ("ngModelChange",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.flight.airportOfBoarding=i)}),e.qZA(),e.TgZ(11,"label",10),e._uU(12,"ETD at Boarding Port "),e.qZA(),e.TgZ(13,"input",12),e.NdJ("ngModelChange",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.flight.eTD_Boarding=i)}),e.qZA(),e.YNc(14,X,6,9,"div",13),e._UZ(15,"br"),e.TgZ(16,"label",10),e._uU(17,"DestInation Airport"),e.qZA(),e.TgZ(18,"input",14),e.NdJ("ngModelChange",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.flight.airportOfDestination=i)}),e.qZA(),e._UZ(19,"br"),e.TgZ(20,"label",10),e._uU(21,"ETA at Destination"),e.qZA(),e.TgZ(22,"input",15),e.NdJ("ngModelChange",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.flight.eTA_Destination=i)}),e.qZA()()()()}if(2&s){const t=e.oxw();e.xp6(10),e.Q6J("ngModel",t.flight.airportOfBoarding),e.xp6(3),e.Q6J("ngModel",t.flight.eTD_Boarding)("bsValue",t.bsValueDate)("bsConfig",e.DdM(9,M)),e.xp6(1),e.Q6J("ngIf",""!==t.flight.airportVia&&null!==t.flight.airportVia),e.xp6(4),e.Q6J("ngModel",t.flight.airportOfDestination),e.xp6(4),e.Q6J("ngModel",t.flight.eTA_Destination)("bsValue",t.bsValueDate)("bsConfig",e.DdM(10,M))}}let te=(()=>{class s{constructor(t,n,i,o,a){this.bsModalRef=t,this.toastr=n,this.confirm=i,this.service=o,this.fb=a,this.candidteFlightDeleteEvent=new e.vpe,this.candidateFlightEditEvent=new e.vpe,this.bsValue=new Date,this.bsRangeValue=new Date,this.bsValueDate=new Date,this.form=new l.cw({})}ngOnInit(){console.log("candidateflight in modal:",this.flight)}deleteCandidateFlight(){this.confirm.confirm("confirm DELETE","Are you sure you want to delete this candidate Flight?").subscribe(n=>{n&&(this.candidteFlightDeleteEvent.emit(this.flight?.id),this.bsModalRef.hide())})}saveCandidateFlight(){console.log("flight:",this.flight),this.candidateFlightEditEvent.emit(this.flight)}static#e=this.\u0275fac=function(n){return new(n||s)(e.Y36(C.UZ),e.Y36(v._W),e.Y36(b.z),e.Y36(m),e.Y36(l.qu))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-flight-detail-modal"]],outputs:{candidteFlightDeleteEvent:"candidteFlightDeleteEvent",candidateFlightEditEvent:"candidateFlightEditEvent"},decls:3,vars:2,consts:[["class","modal-header",4,"ngIf"],["modal-body","","style","margin-left: 25px;",4,"ngIf"],[1,"modal-footer"],[1,"modal-header"],["modal-body","",2,"margin-left","25px"],[2,"vertical-align","top"],[1,"form-group","pull-right"],[1,"btn","stdd","fa","fa-window-close","fa-2x",3,"click"],[1,"stdd","btn","fa","fa-trash","fa-2x","red",3,"click"],[1,"stdd","btn","fa","fa-save","fa-2x",3,"click"],[1,"lbl","w150"],["type","text","name","boardingairport",1,"form-control","stdd","w150",3,"ngModel","ngModelChange"],["id","eTDBoarding","name","eTDBoarding","type","text","placeholder","ETD at Boarding Port","bsDatepicker","","name","etdBoarding",1,"form-control","stdd","w100",3,"ngModel","bsValue","bsConfig","ngModelChange"],["class","stdd","style","vertical-align: top;",4,"ngIf"],["type","text","id","destinationairport","name","destinationairport",1,"stdd","w150",3,"ngModel","ngModelChange"],["type","text","placeholder","ETA","bsDatepicker","","id","etaDestination","name","etaDestination",1,"stdd","w150",3,"ngModel","bsValue","bsConfig","ngModelChange"],[1,"stdd",2,"vertical-align","top"],["class","form-group","style","border:color(from color srgb r g b); border-width: 1px;",4,"ngIf"],[1,"lbl","w150","gray"],["type","text","placeholder","ETA","bsDatepicker","","id","etaVia","name","etaVia",1,"stdd","w150",3,"ngModel","bsValue","bsConfig","ngModelChange"],["type","text","placeholder","ETA","bsDatepicker","","id","etdVia","name","etdVia",1,"stdd","w150",3,"ngModel","bsValue","bsConfig","ngModelChange"],[1,"form-group",2,"border","color(from color srgb r g b)","border-width","1px"],["type","text","id","airportVia","name","airportVia",1,"form-control","stdd","w150",3,"ngModel","ngModelChange"]],template:function(n,i){1&n&&(e.YNc(0,$,1,0,"div",0),e.YNc(1,ee,23,11,"div",1),e._UZ(2,"div",2)),2&n&&(e.Q6J("ngIf",i.flight),e.xp6(1),e.Q6J("ngIf",i.flight))},dependencies:[g.O5,u.Np,u.Y5,l._Y,l.Fj,l.JJ,l.JL,l.On,l.F],styles:[".stdd[_ngcontent-%COMP%]{display:inline-block;margin-left:1px;margin-right:1px;font-size:smaller}.gray[_ngcontent-%COMP%]{color:gray}.red[_ngcontent-%COMP%]{color:red}.w75[_ngcontent-%COMP%]{width:75px}.w100[_ngcontent-%COMP%]{width:100px}.w150[_ngcontent-%COMP%]{width:150px}.lbl[_ngcontent-%COMP%]{display:inline-block;margin-left:1px;margin-right:1px;font-size:smaller;font-weight:700}"]})}return s})();var ne=d(7012);let ie=(()=>{class s{constructor(){this.statuses=[{sequence:0,status:"None"},{sequence:100,status:"Selected"},{sequence:150,status:"Offer Letter Accepted"},{sequence:200,status:"Document Certificate Initiated"},{sequence:300,status:"Ref For Med Tests"},{sequence:400,status:"Med Fit"},{sequence:500,status:"Med Unfit"},{sequence:550,status:"Visa Documents Prepared"},{sequence:600,status:"Visa Docs submitted"},{sequence:700,status:"Visa Endorsed"},{sequence:800,status:"Visa denied"},{sequence:900,status:"Emig Application Lodged"},{sequence:1e3,status:"Emig Documents Lodged"},{sequence:1100,status:"Emig Granted"},{sequence:1200,status:"Emig Denied"},{sequence:1300,status:"Travel Tkt booked"},{sequence:1400,status:"Docs couriered to candidate"},{sequence:1500,status:"Traveled"},{sequence:1600,status:"Arrival Acknowledged by client"},{sequence:5e3,status:"Concluded"}]}transform(t){return this.statuses.filter(i=>i.sequence===t).map(i=>i.status)[0]??"undefined"}static#e=this.\u0275fac=function(n){return new(n||s)};static#t=this.\u0275pipe=e.Yjl({name:"depStatus",type:s,pure:!0})}return s})();function oe(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",1)(1,"input",2),e.NdJ("ngModelChange",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.dep.checked=i)})("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.selectedClicked())}),e.qZA(),e.TgZ(2,"div",3),e._uU(3),e.qZA(),e.TgZ(4,"div",4),e._uU(5),e.qZA(),e.TgZ(6,"div",4),e._uU(7),e.qZA(),e.TgZ(8,"div",5),e._uU(9),e.qZA(),e.TgZ(10,"div",4),e._uU(11),e.qZA(),e.TgZ(12,"div",6),e._uU(13),e.ALo(14,"date"),e.qZA(),e.TgZ(15,"div",6),e._uU(16),e.ALo(17,"date"),e.qZA(),e.TgZ(18,"div",7),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.showFlight())}),e._uU(19),e.ALo(20,"depStatus"),e.qZA(),e.TgZ(21,"div",4),e._uU(22),e.ALo(23,"depStatus"),e.qZA(),e.TgZ(24,"div",8),e._uU(25),e.ALo(26,"date"),e.qZA(),e.TgZ(27,"button",9),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.editDep())}),e.qZA()()}if(2&s){const t=e.oxw();e.xp6(1),e.Q6J("ngModel",t.dep.checked),e.xp6(2),e.Oqu(t.dep.applicationNo),e.xp6(2),e.Oqu(t.dep.candidateName),e.xp6(2),e.Oqu(t.dep.customerName),e.xp6(2),e.Oqu(t.dep.orderNo),e.xp6(2),e.hij("",t.dep.categoryName," "),e.xp6(2),e.Oqu(e.xi3(14,11,t.dep.referredOn,"dd-MMM")),e.xp6(3),e.Oqu(e.xi3(17,14,t.dep.selectedOn,"dd-MMM")),e.xp6(3),e.Oqu(e.lcZ(20,17,t.dep.deploySequence)),e.xp6(3),e.Oqu(e.lcZ(23,19,t.dep.nextSequence)),e.xp6(3),e.Oqu(e.xi3(26,21,t.dep.nextStageDate,"dd-MMM"))}}let ae=(()=>{class s{constructor(t,n){this.service=t,this.toastr=n,this.editDepEvent=new e.vpe,this.deleteDepEvent=new e.vpe,this.selectedEvent=new e.vpe,this.showTicket=new e.vpe}ngOnInit(){}editDep(){this.dep&&this.service.getDeploymentWithItems(this.dep.depId).subscribe({next:t=>{t&&this.editDepEvent.emit(t)}})}showFlight(){this.dep.deploySequence<1300?this.toastr.warning("This can be called only when there is a ticket booked"):this.showTicket.emit(this.dep?.cvRefId)}deleteDep(){this.deleteDepEvent.emit(this.dep.depId)}selectedClicked(){this.selectedEvent.emit(this.dep)}static#e=this.\u0275fac=function(n){return new(n||s)(e.Y36(m),e.Y36(v._W))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-deploy-line"]],inputs:{dep:"dep"},outputs:{editDepEvent:"editDepEvent",deleteDepEvent:"deleteDepEvent",selectedEvent:"selectedEvent",showTicket:"showTicket"},decls:1,vars:1,consts:[["style","margin-left: 5px;",4,"ngIf"],[2,"margin-left","5px"],["type","checkbox",1,"form-check-input","w20","hAlignCenter",2,"margin-left","50px",3,"ngModel","ngModelChange","click"],[1,"w50",2,"display","inline-block","margin-left","25px"],[1,"stdd","w150"],[1,"stdd","w50"],[1,"stdd","w110"],["title","if ticket booked, press this to display flight details",1,"stdd","w150","cursorPointer",3,"click"],[1,"stdd","w75"],["title","edit Deployment Transactions.  This option also provides for addition of a transaction",1,"btn","fa","fa-pencil","fa-sm",3,"click"]],template:function(n,i){1&n&&e.YNc(0,oe,28,24,"div",0),2&n&&e.Q6J("ngIf",void 0!==i.dep)},dependencies:[g.O5,l.Wl,l.JJ,l.On,g.uU,ie],styles:[".stdd[_ngcontent-%COMP%]{display:inline-block;margin-top:1px;margin-left:1px;margin-right:1px;vertical-align:top;font-size:small;word-break:normal}.w20[_ngcontent-%COMP%]{width:20px}.w50[_ngcontent-%COMP%]{width:50px}.w75[_ngcontent-%COMP%]{width:75px}.w100[_ngcontent-%COMP%]{width:100px}.w110[_ngcontent-%COMP%]{width:110px}.w150[_ngcontent-%COMP%]{width:150px;word-wrap:normal}.w175[_ngcontent-%COMP%]{width:175px}.w200[_ngcontent-%COMP%]{width:200px}input[type=checkbox][_ngcontent-%COMP%]{outline:1px solid #1e5180}.red[_ngcontent-%COMP%]{color:red}  .ng-select-container{height:5px!important;font-size:.8em!important}.cursorPointer[_ngcontent-%COMP%]{cursor:pointer;color:#00008b}"]})}return s})();const se=["search"];function le(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div",8)(1,"h6",9),e._uU(2,"Pending deployments"),e.qZA(),e.TgZ(3,"pagination",10),e.NdJ("pageChanged",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.onPageChanged(i))}),e._uU(4," >"),e.qZA(),e.TgZ(5,"div",11)(6,"input",12,13),e.NdJ("keyup.enter",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onSearch())}),e.qZA(),e.TgZ(8,"button",14),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onSearch())}),e.qZA(),e.TgZ(9,"button",15),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onReset())}),e._uU(10,"Reset"),e.qZA(),e.TgZ(11,"div",16)(12,"ng-select",17),e.NdJ("selected",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.selected(i))})("ngModelChange",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.sequenceSelected=i)}),e.qZA()(),e.TgZ(13,"button",18),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.applyTransactions())}),e.qZA()(),e._UZ(14,"button",19),e.qZA()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("totalItems",t.pagination.totalItems)("itemsPerPage",t.pagination.itemsPerPage)("maxSize",10),e.xp6(9),e.Q6J("items",t.statusNameAndSeq)("ngModel",t.sequenceSelected)}}function de(s,c){1&s&&(e.TgZ(0,"div"),e._uU(1," No pending deployment transactions on record\n"),e.qZA())}function re(s,c){if(1&s){const t=e.EpF();e.TgZ(0,"div")(1,"app-deploy-line",20),e.NdJ("editDepEvent",function(i){const a=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.editDeploymentModal(i,a))})("deleteDepEvent",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.deleteDeployment(i))})("selectedEvent",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.selectionChanged(i))})("showTicket",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.displayCandidateTicket(i))})("candidateFlightDeleteEvent",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.candidateFlightDelete(i))})("candidteFlightEditEvent",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.candidateFlightEdit(i))}),e.qZA()()}if(2&s){const t=c.$implicit;e.xp6(1),e.Q6J("dep",t)}}const ce=[{path:"",component:(()=>{class s{constructor(t,n,i,o,a,r){this.toastr=t,this.confirm=n,this.bsModalService=i,this.activatedRoute=o,this.service=a,this.router=r,this.EditDepEvent=new e.vpe,this.returnUrl="",this.deploys=[],this.deploysSelected=[],this.routeId="",this.totalCount=0,this.depStatuses=[],this.statusNameAndSeq=[],this.sequenceSelected=0,this.currentCVRefId=0,this.dParams=new y,this.newSequence=new Y.x,this.searchOptions=[{name:"Application",value:"applicationno"},{name:"Candidate Name",value:"candidateName"},{name:"Order No",value:"orderNo"},{name:"Category Name",value:"categoryName"},{name:"Date Selected",value:"selectedon"},{name:"Employer Name",value:"customerName"}],this.sortOptions=[{name:"By Application No Asc",value:"appno"},{name:"By Application No Desc",value:"apppnodesc"},{name:"By Profession Asc",value:"prof"},{name:"By Profession Desc",value:"profdesc"},{name:"By Employer",value:"employer"},{name:"By Employer Desc",value:"employerdesc"}];let p=this.router.getCurrentNavigation();p?.extras&&p.extras.state&&(p.extras.state.returnUrl&&(this.returnUrl=p.extras.state.returnUrl),p.extras.state.user&&(this.user=p.extras.state.user))}ngOnInit(){this.getDeployments(),this.activatedRoute.data.subscribe({next:t=>this.statusNameAndSeq=t.statusNameAndSeq}),this.getDeploymentStatuses()}getDeployStatusAndSeq(){this.service.getDepStatusAndNames().subscribe({next:t=>this.statusNameAndSeq=t})}getDeploymentStatuses(){this.service.getDeployStatuses().subscribe({next:t=>this.depStatuses=t,error:t=>console.log(t)})}onPageChanged(t){const n=this.service.getParams();n.pageNumber!==t&&(n.pageNumber=t.page,this.service.setParams(n),this.getDeployments())}getDeployments(){var t=this.service.getParams();this.service.getDeploymentPagedList(t)?.subscribe({next:n=>{null!=n?(this.deploys=n.result,this.totalCount=n?.count,this.pagination=n.pagination):console.log("response is undefined")},error:n=>console.log(n)})}close(){this.currentCVRefId=0}deleteDeployment(t){var n=t;this.confirm.confirm("confirm Delete","Are you sure you want to delete this deployment?  All related transactions will also be deleted").pipe((0,D.h)(o=>o),(0,x.w)(o=>this.service.deleteDeployment(n).pipe((0,S.K)(a=>(this.toastr.error(a,"failed to delete"),(0,_.of)())),(0,R.b)(a=>{this.toastr.error("Deleted the deployment","success in deletion")}),(0,S.K)(a=>(this.toastr.error(a,"Failed to delete the deployment record"),(0,_.of)()))))).subscribe(()=>this.toastr.success("deployment deleted","success"))}onSearch(){const t=this.service.getParams();t.search=this.searchTerm.nativeElement.value,t.pageNumber=1,this.service.setParams(t),this.getDeployments()}onReset(){this.searchTerm.nativeElement.value="",this.dParams=new y,this.service.setParams(this.dParams),this.getDeployments()}editDeploymentModal(t,n){null!==t?(this.bsModalRef=this.bsModalService.show(P,{class:"modal-dialog-centered modal-lg",initialState:{dep:t,depStatusAndNames:this.statusNameAndSeq,candidateName:n.applicationNo+"-"+n.candidateName,categoryRef:n.categoryName,companyName:n.customerName}}),this.bsModalRef.content.updateDep.pipe((0,D.h)(a=>null!==a),(0,x.w)(a=>this.service.updateDeployment(a))).subscribe(a=>{""===a?this.toastr.success("Deployment updated","Success"):this.toastr.warning(a,"Failure")})):this.toastr.warning("No Deployment object returned from the modal form")}addNewDeployment(t){this.bsModalRef=this.bsModalService.show(L,{class:"modal-dialog-centered modal-lg",initialState:{cvRefId:t.cvRefId,depStatuses:this.depStatuses,candidateName:t.applicationNo+"-"+t.customerName,categoryRef:t.categoryName,companyName:t.customerName,ecnr:t.ecnr}}),this.bsModalRef.content.updateDep.pipe((0,D.h)(o=>null!==o),(0,x.w)(o=>this.service.updateDeploymentItem(o))).subscribe(o=>{""===o?this.toastr.success("Deployment Item inserted","Success"):this.toastr.warning(o,"Failure")})}navigateByRoute(t,n,i,o){this.router.navigate([n+"/"+t],{state:{user:this.user,toedit:i,returnUrl:"/processing/list",depStages:o}})}getNextSeqForNextTransaction(t){var n=this.depStatuses.find(i=>i.sequence==t)?.nextSequence??0;return console.log("Next Sequence for next Transaction:",n),n}getSequenceForNextTransaction(t){var n=this.findMaxSeq(t),i=this.depStatuses.find(o=>o.sequence==n)?.nextSequence;return console.log("next sequence:",i),i??0}findMaxSeq(t){return t.deploySequence}getNextStageDateForNextTransaction(t,n){var i=new Date(t.currentSeqDate),o=this.depStatuses.find(a=>a.sequence==n)?.estimatedDaysToCompleteThisStage;return new Date(i.setDate(i.getDate()+o))}selectionChanged(t){if(console.log("selection change:",t),void 0!==t){var n;n=!0!==t.checked;var i=this.deploysSelected.findIndex(o=>o.depId===t.depId);n?this.deploysSelected.push(t):this.deploysSelected.splice(i,1)}}applyTransactions(){if(0===this.sequenceSelected)return void this.toastr.warning("Deployment Stage not selected","Please select the deployment transaction you want to apply");if(0===this.deploysSelected.length)return void this.toastr.warning("Deployment items not selected","Please select the items that you want to apply the transactions");let t=[];if(this.deploysSelected.forEach(i=>{t.push({id:0,depId:i.depId,transactionDate:new Date,sequence:this.sequenceSelected,nextSequence:0})}),1300===this.sequenceSelected){var n=[...new Set(this.deploysSelected.map(a=>a.cityOfWorking))];if(n.length>1)return void this.toastr.warning("The deployment items selected by you have more than one destination airports to travel to. Pl select the group with common destination airport, with common airport of Departure also.  Else, choose one candidate at a time","Incorrect selections for travel booking");this.bsModalRef=this.bsModalService.show(j,{class:"modal-dialog-centered modal-lg",initialState:{destinationAirport:n[0]}}),this.bsModalRef.content.updateFlight.pipe((0,D.h)(a=>void 0!==a),(0,x.w)(a=>{if(void 0!==a){var r=[],p=[];return t.forEach(h=>{let ue={id:0,depId:h.depId,sequence:h.sequence,nextSequence:h.nextSequence,transactionDate:h.transactionDate,nextSequenceDate:new Date},F={id:0,depId:h.depId,depItemId:0,cvRefId:0,applicationNo:0,candidateName:"",customerName:"",customerCity:"",dateOfFlight:a.dateOfFlight,flightNo:a.flightNo,airportOfBoarding:a.airportOfBoarding,airportOfDestination:a.airportOfDestination,eTD_Boarding:a.eTD_Boarding,eTA_Destination:a.eTA_Destination,airportVia:a.airportVia,flightNoVia:a.flightNoVia,eTA_Via:a.eTA_Via,eTD_Via:a.eTD_Via};p.push(F),r.push({depItem:ue,candidateFlight:F})}),this.service.insertDepItemsWithTravelBooked(r)}return(0,_.of)(void 0)})).subscribe(a=>{if(null!==a){for(const p of a){var r=this.deploys.findIndex(h=>h.depId==h.depId);this.deploys[r]=p,this.newSequence.next(p.deploySequence)}this.toastr.success("Success","Inserted "+a.length+" number of deployment transactions")}})}else this.service.InsertDepItems(t).subscribe({next:i=>{if(console.log("itemsAdded returned from api",i),null===i)this.toastr.warning("Failed to insert","Failed to insert any dep Transaction"),this.sequenceSelected=-1,t=[],this.deploys.forEach(a=>{});else{for(const a of i){var o=this.deploys.findIndex(r=>r.depId==r.depId);this.deploys[o]=a,this.newSequence.next(a.deploySequence)}this.toastr.success("Success","Inserted "+i+" number of deployment transactions")}}})}selected(t){this.sequenceSelected=t}displayCandidateTicket(t){this.service.getCandidateFlight(t).pipe((0,D.h)(o=>null!=o),(0,x.w)(o=>(this.bsModalRef=this.bsModalService.show(te,{class:"modal-dialog-centered modal-md",initialState:{flight:o}}),this.bsModalRef.content.candidateFlightDelete))).subscribe(o=>{console.log("inner response:",o)})}candidateFlightDelete(t){this.service.deleteCandidateFlight(t).subscribe(i=>{i?this.toastr.success("Candidate Flight Detail deleted","Deleted successfully"):this.toastr.warning("Failed to delete the Candidate Flight","Failed to delete")})}candidateFlightEdit(t){null!=t?this.service.editCandidateFlight(t).subscribe({next:i=>{""==i?this.toastr.success("The Candidate Flight was successfully updated","Success"):this.toastr.warning(i,"failed to update the candidate flight object")}}):this.toastr.warning("null object received from CAndidate Flight modal")}static#e=this.\u0275fac=function(n){return new(n||s)(e.Y36(v._W),e.Y36(b.z),e.Y36(C.tT),e.Y36(f.gz),e.Y36(m),e.Y36(f.F0))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-deploy-listing"]],viewQuery:function(n,i){if(1&n&&e.Gf(se,5),2&n){let o;e.iGM(o=e.CRH())&&(i.searchTerm=o.first)}},inputs:{EditDepEvent:"EditDepEvent"},decls:26,vars:3,consts:[["class","d-flex justify-contents-between align-items-center","style","display: inline-block; margin-left: 15px; vertical-align: top;",4,"ngIf"],[1,"my-2",2,"margin-left","50px"],[1,"stdd","w50"],[1,"stdd","w150"],[1,"stdd","w110"],[1,"stdd","w75"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"d-flex","justify-contents-between","align-items-center",2,"display","inline-block","margin-left","15px","vertical-align","top"],[1,"mx-5"],["previousText","\u2039","nextText","\u203a","firstText","\xab","lastText","\xbb",3,"totalItems","itemsPerPage","maxSize","pageChanged"],[1,"form-inline",2,"margin-left","50px !important"],["type","text","placeholder","Search",1,"stdd","form-control","w250",3,"keyup.enter"],["search",""],[1,"btn","btn-outline-primary","mx-1","fa","fa-search",3,"click"],[1,"btn","btn-outline-success","mx-1",3,"click"],[1,"stdd"],["bindLabel","name","bindValue","id","labelForId","id","clearAllText","Clear",2,"border-style","double","width","250px","font-size","small",3,"items","ngModel","selected","ngModelChange"],["title","Press to insert transactions for the items selected",1,"btn","btn-outline-success","fa","fa-check","mx-1",3,"click"],["routerLink","/administration",1,"btn","btn-outline-success","mx-1","fa","fa-window-close"],[3,"dep","editDepEvent","deleteDepEvent","selectedEvent","showTicket","candidateFlightDeleteEvent","candidteFlightEditEvent"]],template:function(n,i){1&n&&(e.YNc(0,le,15,5,"div",0),e.TgZ(1,"div",1)(2,"label",2),e._uU(3,"Sel"),e.qZA(),e.TgZ(4,"label",2),e._uU(5,"App#"),e.qZA(),e.TgZ(6,"label",3),e._uU(7,"Candidate Name"),e.qZA(),e.TgZ(8,"label",3),e._uU(9,"Customer Name"),e.qZA(),e.TgZ(10,"label",2),e._uU(11,"Order#"),e.qZA(),e.TgZ(12,"label",3),e._uU(13,"Category"),e.qZA(),e.TgZ(14,"label",4),e._uU(15,"Referred On"),e.qZA(),e.TgZ(16,"label",4),e._uU(17,"Selected On"),e.qZA(),e.TgZ(18,"label",3),e._uU(19,"Current Dep Status"),e.qZA(),e.TgZ(20,"label",3),e._uU(21,"Next Dep Status"),e.qZA(),e.TgZ(22,"label",5),e._uU(23,"Estimated Date"),e.qZA()(),e.YNc(24,de,2,0,"div",6),e.YNc(25,re,2,1,"div",7)),2&n&&(e.Q6J("ngIf",i.deploys&&i.pagination),e.xp6(24),e.Q6J("ngIf",!i.deploys),e.xp6(1),e.Q6J("ngForOf",i.deploys))},dependencies:[g.sg,g.O5,ne.Qt,l.JJ,l.On,T.w9,f.rH,ae],styles:[".stdd[_ngcontent-%COMP%]{display:inline-block;margin-top:1px;margin-left:1px;margin-right:1px;vertical-align:top;font-size:small;word-break:normal;font-weight:700}.w30[_ngcontent-%COMP%]{width:30px}.w50[_ngcontent-%COMP%]{width:50px}.w75[_ngcontent-%COMP%]{width:75px}.w100[_ngcontent-%COMP%]{width:100px}.w110[_ngcontent-%COMP%]{width:110px}.w150[_ngcontent-%COMP%]{width:150px}.w175[_ngcontent-%COMP%]{width:175px}.w200[_ngcontent-%COMP%]{width:200px}.w250[_ngcontent-%COMP%]{width:250px}  .ng-select .ng-select-container,   .ng-select.ng-select-single .ng-select-container{min-height:25px;font-size:.8em;font-weight:400}"]})}return s})(),resolve:{statusNameAndSeq:()=>(0,e.f3M)(m).getDepStatusAndNames()}}];let pe=(()=>{class s{static#e=this.\u0275fac=function(n){return new(n||s)};static#t=this.\u0275mod=e.oAB({type:s});static#n=this.\u0275inj=e.cJS({imports:[g.ez,f.Bz.forChild(ce),f.Bz]})}return s})(),ge=(()=>{class s{static#e=this.\u0275fac=function(n){return new(n||s)};static#t=this.\u0275mod=e.oAB({type:s});static#n=this.\u0275inj=e.cJS({imports:[g.ez,I.m,pe]})}return s})()}}]);