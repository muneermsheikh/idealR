"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[136],{3574:(x,M,l)=>{l.d(M,{C:()=>O});var t=l(7328),c=l(2096),f=l(7398),R=l(5516),C=l(3976),u=l(9468),h=l(9862);let O=(()=>{class g{constructor(r){this.http=r,this.apiUrl=R.N.apiUrl,this.currentUserSource=new t.t(1),this.currentUser$=this.currentUserSource.asObservable(),this.cache=new Map}getHistories(r){const _=this.cache.get(Object.values(r).join("-"));if(_)return(0,c.of)(_);let p=(0,C.qb)(r);return(0,C.Tr)(this.apiUrl+"userHistory/pagedlist",p,this.http).pipe((0,f.U)(s=>(this.cache.set(Object.values(r).join("-"),s),s)))}getCallRecordWithItems(r,_,p,s){return this.http.get(this.apiUrl+"CallRecord/callRecordWithItems/"+r+"/"+_+"/"+p+"/"+s)}updateHistoryItem(r){return this.http.post(this.apiUrl+"userHistory/userhistoryitem",r)}setParams(r){this.hParams=r}getParams(){return this.hParams}updateCallRecord(r){return this.http.put(this.apiUrl+"CallRecord",r)}updateCallRecordObject(r){return this.http.put(this.apiUrl+"CallRecord/UpdateNewItem",r)}deleteHistory(r){return this.http.delete(this.apiUrl+"userHistory/"+r)}deleteHistoryItem(r){return this.http.delete(this.apiUrl+"userHistory/historyItemId/"+r)}static#t=this.\u0275fac=function(_){return new(_||g)(u.LFG(h.eN))};static#e=this.\u0275prov=u.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"})}return g})()},1986:(x,M,l)=>{l.d(M,{Y:()=>e});var t=l(9468),c=l(2181),f=l(4664),R=l(6306),C=l(2096),u=l(2051),h=l(7411),O=l(3574),g=l(8763),v=l(6814),r=l(3593),_=l(95),p=l(8806);const s=function(){return{dateInputFormat:"YYYY-MM-DD"}};function b(o,m){if(1&o){const n=t.EpF();t.TgZ(0,"div",5)(1,"label",6),t._uU(2,"Person Name"),t.qZA(),t.TgZ(3,"label",6),t._uU(4),t.qZA(),t._UZ(5,"br"),t.TgZ(6,"label",6),t._uU(7,"Regd On"),t.qZA(),t.TgZ(8,"label",7),t._uU(9),t.ALo(10,"date"),t.qZA(),t.TgZ(11,"label",8),t._uU(12,"Status"),t.qZA(),t.TgZ(13,"ng-select",9),t.NdJ("ngModelChange",function(d){t.CHM(n);const a=t.oxw();return t.KtG(a.callRecord.callRecordItems[0].contactResult=d)}),t.qZA(),t._UZ(14,"br"),t.TgZ(15,"label",10),t._uU(16,"Phone No"),t.qZA(),t.TgZ(17,"input",11),t.NdJ("ngModelChange",function(d){t.CHM(n);const a=t.oxw();return t.KtG(a.callRecord.callRecordItems[0].phoneNo=d)}),t.qZA(),t.TgZ(18,"label",8),t._uU(19,"Email"),t.qZA(),t.TgZ(20,"input",12),t.NdJ("ngModelChange",function(d){t.CHM(n);const a=t.oxw();return t.KtG(a.callRecord.callRecordItems[0].email=d)}),t.qZA(),t._UZ(21,"br"),t.TgZ(22,"label",13),t._uU(23,"Contact On"),t.qZA(),t.TgZ(24,"input",14),t.NdJ("ngModelChange",function(d){t.CHM(n);const a=t.oxw();return t.KtG(a.callRecord.callRecordItems[0].dateOfContact=d)}),t.qZA(),t.TgZ(25,"label",8),t._uU(26,"Incoming/Outgoing"),t.qZA(),t.TgZ(27,"input",15),t.NdJ("ngModelChange",function(d){t.CHM(n);const a=t.oxw();return t.KtG(a.callRecord.callRecordItems[0].incomingOutgoing=d)}),t.qZA(),t._uU(28," In "),t.TgZ(29,"input",16),t.NdJ("ngModelChange",function(d){t.CHM(n);const a=t.oxw();return t.KtG(a.callRecord.callRecordItems[0].incomingOutgoing=d)}),t.qZA(),t._uU(30,"Out "),t.TgZ(31,"input",17),t.NdJ("ngModelChange",function(d){t.CHM(n);const a=t.oxw();return t.KtG(a.callRecord.callRecordItems[0].incomingOutgoing=d)}),t.qZA(),t._uU(32,"Both "),t._UZ(33,"br"),t.TgZ(34,"label",13),t._uU(35,"Summary of discussion"),t.qZA(),t.TgZ(36,"textarea",18),t.NdJ("ngModelChange",function(d){t.CHM(n);const a=t.oxw();return t.KtG(a.callRecord.callRecordItems[0].gistOfDiscussions=d)}),t.qZA(),t._UZ(37,"br"),t.TgZ(38,"label",19),t._uU(39,"Send Advisory By"),t.qZA(),t.TgZ(40,"input",20),t.NdJ("ngModelChange",function(d){t.CHM(n);const a=t.oxw();return t.KtG(a.callRecord.callRecordItems[0].advisoryBy=d)}),t.qZA(),t._uU(41,"Email "),t.TgZ(42,"input",21),t.NdJ("ngModelChange",function(d){t.CHM(n);const a=t.oxw();return t.KtG(a.callRecord.callRecordItems[0].advisoryBy=d)}),t.qZA(),t._uU(43,"SMS "),t.TgZ(44,"input",22),t.NdJ("ngModelChange",function(d){t.CHM(n);const a=t.oxw();return t.KtG(a.callRecord.callRecordItems[0].advisoryBy=d)}),t.qZA(),t._uU(45,"Both "),t.qZA()}if(2&o){const n=t.oxw();t.xp6(4),t.Oqu(n.callRecord.personName),t.xp6(5),t.Oqu(t.xi3(10,16,n.dateRegistered,"dd-MMM-yy")),t.xp6(4),t.Q6J("items",n.contactResults)("ngModel",n.callRecord.callRecordItems[0].contactResult),t.xp6(4),t.Q6J("ngModel",n.callRecord.callRecordItems[0].phoneNo),t.xp6(3),t.Q6J("ngModel",n.callRecord.callRecordItems[0].email),t.xp6(4),t.Q6J("ngModel",n.callRecord.callRecordItems[0].dateOfContact)("bsValue",n.bsValueDate)("bsConfig",t.DdM(19,s)),t.xp6(3),t.Q6J("ngModel",n.callRecord.callRecordItems[0].incomingOutgoing),t.xp6(2),t.Q6J("ngModel",n.callRecord.callRecordItems[0].incomingOutgoing),t.xp6(2),t.Q6J("ngModel",n.callRecord.callRecordItems[0].incomingOutgoing),t.xp6(5),t.Q6J("ngModel",n.callRecord.callRecordItems[0].gistOfDiscussions),t.xp6(4),t.Q6J("ngModel",n.callRecord.callRecordItems[0].advisoryBy),t.xp6(2),t.Q6J("ngModel",n.callRecord.callRecordItems[0].advisoryBy),t.xp6(2),t.Q6J("ngModel",n.callRecord.callRecordItems[0].advisoryBy)}}let e=(()=>{class o{constructor(n,i,d,a){this.bsModalRef=n,this.confirm=i,this.service=d,this.toastr=a,this.callRecordAddEvent=new t.vpe,this.contactResult="",this.dateRegistered=new Date,this.contactResults=[],this.bsValueDate=new Date,this.bsValue=new Date}ngOnInit(){this.callRecord&&(this.callRecord.callRecordItems[0].dateOfContact=new Date)}updateClicked(){const i=this.service.updateCallRecord(this.callRecord);this.confirm.confirm("confirm Update","confirm update this Call Record. ").pipe((0,c.h)(a=>a),(0,f.w)(a=>i),(0,R.K)(a=>(this.toastr.error(a,"Error in updating the record"),(0,C.of)()))).subscribe(a=>{a?(this.callRecordAddEvent.emit(a),this.bsModalRef.hide()):this.toastr.warning("Failed to update the Call Record")})}static#t=this.\u0275fac=function(i){return new(i||o)(t.Y36(u.UZ),t.Y36(h.z),t.Y36(O.C),t.Y36(g._W))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-call-record-add-modal"]],outputs:{callRecordAddEvent:"callRecordAddEvent"},decls:6,vars:1,consts:[[1,"modal-header"],[2,"display","inline-block"],["title","update the Call Record",1,"lbl","w35","btn","btn-success","fa","fa-check",2,"margin-left","400px !important",3,"click"],["title","Close",1,"lbl","btn","fa","fa-close","pull-right",3,"click"],["class","modal-body",4,"ngIf"],[1,"modal-body"],[1,"lbl","mL2mR2","w125"],[1,"stdd","mL2mR2","w125"],[1,"lbl","mL10mR2","w150"],["bindLabel","status","bindValue","status","labelForId","status",1,"stdd","w200",2,"height","fit-content","border-color","black",3,"items","ngModel","ngModelChange"],["mL2mR2","",1,"lbl","w125"],["type","text",1,"stdd","mL2mR2","w125",3,"ngModel","ngModelChange"],["type","text",1,"stdd","w200",3,"ngModel","ngModelChange"],[1,"lbl","w125"],["type","text","placeholder","Contacted On","name","dateOfContact","bsDatepicker","",1,"stdd","w125",3,"ngModel","bsValue","bsConfig","ngModelChange"],["type","radio","name","inout","id","inout","value","in",1,"stdd","w35",2,"vertical-align","middle !important",3,"ngModel","ngModelChange"],["type","radio","name","inout","id","inout","value","out",1,"stdd","w35",2,"vertical-align","middle !important",3,"ngModel","ngModelChange"],["type","radio","name","inout","id","inout","value","both",1,"stdd","w35",2,"vertical-align","middle !important",3,"ngModel","ngModelChange"],["name","disc","id","disc","cols","80","rows","2",1,"stdd",3,"ngModel","ngModelChange"],["title","sends an email or sms to the party, confirming this conversation, by mail or sms",1,"lbl","w125"],["type","radio","name","advisoryBy","id","advisoryBy","value","email",1,"stdd","w35",2,"vertical-align","middle !important",3,"ngModel","ngModelChange"],["type","radio","name","advisoryBy","id","advisoryBy","value","sms",1,"stdd","w35",2,"vertical-align","middle !important",3,"ngModel","ngModelChange"],["type","radio","name","advisoryBy","id","advisoryBy","value","both",1,"stdd","w35",2,"vertical-align","middle !important",3,"ngModel","ngModelChange"]],template:function(i,d){1&i&&(t.TgZ(0,"div",0)(1,"h6",1),t._uU(2,"Add a new Transaction for Call Record Item"),t.qZA(),t.TgZ(3,"button",2),t.NdJ("click",function(){return d.updateClicked()}),t.qZA(),t.TgZ(4,"button",3),t.NdJ("click",function(){return d.bsModalRef.hide()}),t.qZA()(),t.YNc(5,b,46,20,"div",4)),2&i&&(t.xp6(5),t.Q6J("ngIf",void 0!==d.callRecord))},dependencies:[v.O5,r.Np,r.Y5,_.Fj,_._,_.JJ,_.On,p.w9,v.uU],styles:[".lbl[_ngcontent-%COMP%]{display:inline-block;font-size:smaller;font-weight:700;vertical-align:middle;word-wrap:normal;margin-top:5px;margin-bottom:5px}.stdd[_ngcontent-%COMP%]{display:inline-block;font-size:smaller;vertical-align:top;word-wrap:normal;margin-top:5px;margin-bottom:5px}.mL2mR2[_ngcontent-%COMP%]{margin-left:2px;margin-right:2px}.mL10mR2[_ngcontent-%COMP%]{margin-left:10px;margin-right:2px}.w35[_ngcontent-%COMP%]{width:35px}.w100[_ngcontent-%COMP%]{width:100px}.w125[_ngcontent-%COMP%]{width:125px}.w150[_ngcontent-%COMP%]{width:150px}.w175[_ngcontent-%COMP%]{width:175px}.w200[_ngcontent-%COMP%]{width:200px}.b[_ngcontent-%COMP%]{font-weight:700}"]})}return o})()},369:(x,M,l)=>{l.d(M,{h:()=>p});var t=l(9468),c=l(95),f=l(2051),R=l(8763),C=l(7411),u=l(6814),h=l(3593),O=l(8806);function g(s,b){1&s&&(t.TgZ(0,"div")(1,"h6"),t._uU(2,"No Call Records on record matching your instructions"),t.qZA()())}const v=function(){return{dateInputFormat:"YYYY-MM-DD"}};function r(s,b){if(1&s){const e=t.EpF();t.TgZ(0,"div")(1,"div",22),t._UZ(2,"input",23)(3,"input",24)(4,"input",25)(5,"textarea",26)(6,"ng-select",27)(7,"ng-select",28)(8,"input",29),t.TgZ(9,"button",30),t.NdJ("click",function(){const n=t.CHM(e).index,i=t.oxw(2);return t.KtG(i.removeDepItem(n))}),t.qZA()()()}if(2&s){const e=b.index,o=t.oxw(2);t.xp6(1),t.Q6J("formGroupName",e),t.xp6(1),t.Q6J("bsValue",o.bsValueDate)("bsConfig",t.DdM(7,v)),t.xp6(4),t.Q6J("items",o.contactResults),t.xp6(1),t.Q6J("items",o.contactResults),t.xp6(1),t.Q6J("bsValue",o.bsValueDate)("bsConfig",t.DdM(8,v))}}function _(s,b){if(1&s){const e=t.EpF();t.TgZ(0,"div")(1,"form",6)(2,"label",7),t._uU(3,"Name of the Person:"),t.qZA(),t.TgZ(4,"div",8),t._uU(5),t.qZA(),t.TgZ(6,"label",9),t._uU(7,"CategoryRef:"),t.qZA(),t.TgZ(8,"div",10),t._uU(9),t.qZA(),t._UZ(10,"br"),t.TgZ(11,"label",11),t._uU(12,"Subject:"),t.qZA(),t.TgZ(13,"div",10),t._uU(14),t.qZA(),t.TgZ(15,"label",9),t._uU(16,"Status:"),t.qZA(),t.TgZ(17,"div",12),t._uU(18),t.qZA(),t._UZ(19,"hr",13),t.TgZ(20,"label",14),t._uU(21,"Date"),t.qZA(),t.TgZ(22,"label",15),t._uU(23,"In/Out"),t.qZA(),t.TgZ(24,"label",14),t._uU(25,"Phone"),t.qZA(),t.TgZ(26,"label",11),t._uU(27,"Gist of discussions"),t.qZA(),t.TgZ(28,"label",16),t._uU(29,"Result"),t.qZA(),t.TgZ(30,"label",16),t._uU(31,"Next action"),t.qZA(),t.TgZ(32,"label",17),t._uU(33,"On"),t.qZA(),t.TgZ(34,"button",18),t.NdJ("click",function(){t.CHM(e);const m=t.oxw();return t.KtG(m.addCallRecordItem())}),t.qZA(),t._UZ(35,"hr",19),t.TgZ(36,"div",20),t.YNc(37,r,10,9,"div",21),t.qZA()()()}if(2&s){const e=t.oxw();t.xp6(1),t.Q6J("formGroup",e.form),t.xp6(4),t.Oqu(e.callRecord.personName),t.xp6(4),t.Oqu(e.callRecord.categoryRef),t.xp6(5),t.Oqu(e.callRecord.subject),t.xp6(4),t.Oqu(e.callRecord.status),t.xp6(19),t.Q6J("ngForOf",e.callRecordItems.controls)}}let p=(()=>{class s{constructor(e,o,m,n){this.bsModalRef=e,this.toastr=o,this.fb=m,this.confirm=n,this.updateCallRecordEvent=new t.vpe,this.candidatName="",this.bsValueDate=new Date,this.bsValue=new Date,this.form=new c.cw({}),this.contactResults=[],this.advisoriesBy=[{status:"Mail"},{status:"SMS"},{status:"Both"}],this.inOutList=[{status:"In"},{status:"Out"}]}ngOnInit(){this.callRecord&&this.InitializeForm(this.callRecord)}InitializeForm(e){this.form=this.fb.group({id:e.id,categoryRef:e.categoryRef,personId:e.personId,personName:e.personName,personType:e.personType,username:e.username,status:e.status,statusDate:e.statusDate,email:e.Email,phoneNo:e.phoneNo,subject:e.subject,concludedOn:e.concludedOn,callRecordItems:this.fb.array(e.callRecordItems.map(o=>this.fb.group({id:o.id,callRecordId:o.callRecordId,incomingOutgoing:o.incomingOutgoing,dateOfContact:o.dateOfContact,username:o.username,phoneNo:o.phoneNo,contactResult:o.contactResult,gistOfDiscussions:o.gistOfDiscussions,nextAction:o.nextAction,nextActionOn:o.nextActionOn,email:o.email,advisoryBy:o.advisoryBy,composeSMS:o.advisoryBy})))})}get callRecordItems(){return this.form.get("callRecordItems")}newCallRecordItem(){var e=this.callRecordItems.at(this.callRecordItems.length-1);return this.fb.group({id:0,callRecordId:this.callRecord?.id,incomingOutgoing:"out",dateOfContact:new Date,username:this.user?.userName??"",contactResult:"",gistOfDiscussions:"",advoryBy:"mail",nextAction:"",nextActionOn:new Date,phoneNo:e.get("phoneNo")?.value,email:e.get("email")?.value})}addCallRecordItem(){this.callRecordItems.push(this.newCallRecordItem())}removeDepItem(e){this.confirm.confirm("Confirm Delete","This will also delete the selected Call Record Item. If you confirm to delete, remember to save this transaction").subscribe({next:o=>{o&&this.callRecordItems.removeAt(e)}})}updateCallRecord(){this.updateCallRecordEvent.emit(this.form.value),this.bsModalRef.hide()}close(){this.bsModalRef.hide()}static#t=this.\u0275fac=function(o){return new(o||s)(t.Y36(f.UZ),t.Y36(R._W),t.Y36(c.qu),t.Y36(C.z))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-call-records-edit-modal"]],inputs:{updateCallRecordEvent:"updateCallRecordEvent"},decls:9,vars:2,consts:[[1,"modal-header","my-0"],[1,"btn","btn-success","w35","fa","fa-save",2,"margin-left","400px",3,"click"],[1,"btn","fa","fa-window-close","fa-2x","pull-right",3,"click"],[1,"modal-body","my-0"],[4,"ngIf"],[1,"modal-footer"],[3,"formGroup"],[1,"lbl","w150","fSmaller"],[1,"stdd","w150","fSmaller"],[1,"lbl","w125","fSmaller","mL15"],[1,"stdd","fSmaller","w150"],[1,"lbl","fSmaller","w150"],[1,"stdd","fSmaller","w100"],[1,"my-1"],[1,"lbl","fSmaller","w80"],[1,"lbl","fSmaller","w50"],[1,"lbl","fSmaller","w125"],[1,"lbl","fSmaller","w100"],[1,"btn","w25","fa","fa-plus",3,"click"],[1,"my-0"],["formArrayName","callRecordItems"],[4,"ngFor","ngForOf"],[3,"formGroupName"],["type","text","placeholder","Date","formControlName","dateOfContact","bsDatepicker","",1,"stdd","fSmaller","w80",3,"bsValue","bsConfig"],["type","text","formControlName","incomingOutgoing",1,"stdd","fSmaller","w50"],["type","text","formControlName","phoneNo",1,"stdd","fSmaller","w80"],["formControlName","gistOfDiscussions","cols","20","rows","2",1,"stdd","fSmaller"],["bindLabel","status","bindValue","status","labelForId","status","formControlName","contactResult",1,"stdd","w125","fSmaller",2,"border-color","black",3,"items"],["bindLabel","status","bindValue","status","labelForId","status","formControlName","nextAction",1,"stdd","w125","fSmaller",2,"border-color","black",3,"items"],["type","text","placeholder","Date","formControlName","nextActionOn","bsDatepicker","",1,"stdd","w75","fSmaller",3,"bsValue","bsConfig"],[1,"btn","w25","fa","fa-trash","fa-sm","red",3,"click"]],template:function(o,m){1&o&&(t.TgZ(0,"div",0)(1,"h6"),t._uU(2,"Edit Call Record"),t.qZA(),t.TgZ(3,"button",1),t.NdJ("click",function(){return m.updateCallRecord()}),t.qZA(),t.TgZ(4,"button",2),t.NdJ("click",function(){return m.close()}),t.qZA()(),t.TgZ(5,"div",3),t.YNc(6,g,3,0,"div",4),t.YNc(7,_,38,6,"div",4),t.qZA(),t._UZ(8,"div",5)),2&o&&(t.xp6(6),t.Q6J("ngIf",!m.callRecord),t.xp6(1),t.Q6J("ngIf",m.callRecord))},dependencies:[u.sg,u.O5,h.Np,h.Y5,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,c.x0,c.CE,O.w9],styles:[".stdd[_ngcontent-%COMP%]{display:inline-block;margin-left:2px;margin-right:1px;vertical-align:top}.stddY0[_ngcontent-%COMP%]{display:inline-block;margin:0 1px 0 2px;vertical-align:top}.lbl[_ngcontent-%COMP%]{display:inline-block;margin-left:2px;margin-right:1px;font-weight:700;vertical-align:top}.mL15[_ngcontent-%COMP%]{margin-left:15px!important}.mL40[_ngcontent-%COMP%]{margin-left:40px!important}.mL110[_ngcontent-%COMP%]{margin-left:110px!important}.mL460[_ngcontent-%COMP%]{margin-left:460px!important}.fSmallest[_ngcontent-%COMP%]{font-size:xx-small;font-weight:700}.fSmaller[_ngcontent-%COMP%]{font-size:smaller}.red[_ngcontent-%COMP%]{color:red}.w25[_ngcontent-%COMP%]{width:25px}.w35[_ngcontent-%COMP%]{width:35px}.w50[_ngcontent-%COMP%]{width:50px}.w75[_ngcontent-%COMP%]{width:75px}.w80[_ngcontent-%COMP%]{width:80px}.w100[_ngcontent-%COMP%]{width:100px}.w125[_ngcontent-%COMP%]{width:125px}.w140[_ngcontent-%COMP%]{width:140px}.w150[_ngcontent-%COMP%]{width:150px}.w250[_ngcontent-%COMP%]{width:250px}.cursorPointer[_ngcontent-%COMP%]{cursor:pointer;color:#00008b}  .ng-select .ng-select-container,   .ng-select.ng-select-single .ng-select-container{min-height:25px;font-size:.8em;font-weight:400;width:auto!important}"]})}return s})()}}]);