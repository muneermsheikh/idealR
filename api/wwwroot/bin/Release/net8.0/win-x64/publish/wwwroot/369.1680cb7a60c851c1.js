"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[369],{3574:(O,R,a)=>{a.d(R,{C:()=>g});var t=a(7328),n=a(2096),v=a(7398),b=a(5516),u=a(1436),p=a(5879),m=a(9862);let g=(()=>{class c{constructor(s){this.http=s,this.apiUrl=b.N.apiUrl,this.currentUserSource=new t.t(1),this.currentUser$=this.currentUserSource.asObservable(),this.cache=new Map,this.callRecordStatus=[{status:"wrong number"},{status:"Not Responding"},{status:"Will Revert later"},{status:"Declined-Family issues"},{status:"Declined for overseas"},{status:"Declined-Low remuneration"},{status:"Declined - SC Not agreed"},{status:"Interested - to negotiate remuneration"},{status:"Interested, and keen"},{status:"Interested, but doubtful"},{status:"Declined - other reasons"}]}getHistories(s){const l=this.cache.get(Object.values(s).join("-"));if(l)return(0,n.of)(l);let h=(0,u.qb)(s);return(0,u.Tr)(this.apiUrl+"userHistory/pagedlist",h,this.http).pipe((0,v.U)(f=>(this.cache.set(Object.values(s).join("-"),f),f)))}getCallRecordReport(s){let l=(0,u.qb)(s);return this.http.get(this.apiUrl+"CallRecord/report",{params:l})}getCallRecordWithItems(s,l){return this.http.get(this.apiUrl+"CallRecord/callRecordWithItems/"+s+"/"+l)}getCallRecordStatus(){return this.callRecordStatus}updateHistoryItem(s){return this.http.post(this.apiUrl+"userHistory/userhistoryitem",s)}insertNewCallRecordItem(s){return this.http.post(this.apiUrl+"CallRecord/CallRecorditem",s)}setParams(s){this.hParams=s}getParams(){return this.hParams}updateCallRecord(s){return this.http.put(this.apiUrl+"CallRecord",s)}updateCallRecordObject(s){return this.http.put(this.apiUrl+"CallRecord/UpdateNewItem",s)}updateCallRecordItem(s){return console.log("updatecallrecorditem, model"),this.http.put(this.apiUrl+"CallRecord/InsertCallRecordItem",s)}deleteHistory(s){return this.http.delete(this.apiUrl+"userHistory/"+s)}deleteHistoryItem(s){return this.http.delete(this.apiUrl+"userHistory/historyItemId/"+s)}getCallRecordFromPhoneNo(s){return this.http.get(this.apiUrl+"callRecord/callRecordFromPhoneNo/"+s)}getCallRecordsOfACandidate(s,l){return this.http.get(this.apiUrl+"callRecord/CallRecordSummary/"+s+"/"+l)}static#t=this.\u0275fac=function(l){return new(l||c)(p.LFG(m.eN))};static#e=this.\u0275prov=p.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})()},369:(O,R,a)=>{a.d(R,{h:()=>x});var t=a(5879),n=a(6223),v=a(2051),b=a(8763),u=a(7411),p=a(3574),m=a(6814),g=a(3593),c=a(4807),I=a(7114);function s(r,C){1&r&&(t.TgZ(0,"div",34),t._uU(1," Contact Result not selected "),t.qZA())}function l(r,C){if(1&r&&(t.TgZ(0,"div"),t.YNc(1,s,2,0,"div",33),t.qZA()),2&r){const e=t.oxw(3);t.xp6(1),t.Q6J("ngIf",e.form.controls.contactResult.touched&&e.form.controls.contactResult.invalid&&e.form.controls.contactResult.errors&&e.form.controls.contactResult.errors.required)}}const h=function(){return{dateInputFormat:"YYYY-MM-DD"}};function f(r,C){if(1&r){const e=t.EpF();t.TgZ(0,"div")(1,"div",23),t._UZ(2,"input",24)(3,"app-text-input",25)(4,"app-text-input",26),t.TgZ(5,"ng-select",27),t.NdJ("change",function(i){const _=t.CHM(e).index,E=t.oxw(2);return t.KtG(E.contactResultChanged(i,_))}),t.qZA(),t.YNc(6,l,2,1,"div",5),t._UZ(7,"ng-select",28)(8,"input",29),t.TgZ(9,"button",30),t.NdJ("click",function(){const d=t.CHM(e).index,_=t.oxw(2);return t.KtG(_.removeDepItem(d))}),t.qZA(),t._UZ(10,"br",20),t.TgZ(11,"label",31),t._uU(12,"Discussions"),t.qZA(),t._UZ(13,"app-text-input",32),t.qZA()()}if(2&r){const e=C.index,o=t.oxw(2);t.xp6(1),t.Q6J("formGroupName",e),t.xp6(1),t.Q6J("bsValue",o.bsValueDate)("bsConfig",t.DdM(10,h)),t.xp6(2),t.Q6J("label","Phone No"),t.xp6(1),t.Q6J("items",o.contactResults),t.xp6(1),t.Q6J("ngIf",o.form.controls.contactResult),t.xp6(1),t.Q6J("items",o.nextAction),t.xp6(1),t.Q6J("bsValue",o.bsValueDate)("bsConfig",t.DdM(11,h)),t.xp6(5),t.Q6J("label","Discussions")}}function M(r,C){if(1&r){const e=t.EpF();t.TgZ(0,"div")(1,"form",8)(2,"label",9),t._uU(3,"Name of the Person:"),t.qZA(),t.TgZ(4,"div",10),t._uU(5),t.qZA(),t.TgZ(6,"label",11),t._uU(7,"CategoryRef:"),t.qZA(),t.TgZ(8,"div",12),t._uU(9),t.qZA(),t._UZ(10,"br"),t.TgZ(11,"label",9),t._uU(12,"Subject:"),t.qZA(),t.TgZ(13,"div",10),t._uU(14),t.qZA(),t.TgZ(15,"label",11),t._uU(16,"Status:"),t.qZA(),t.TgZ(17,"div",13),t._uU(18),t.qZA(),t._UZ(19,"hr",14),t.TgZ(20,"label",15),t._uU(21,"Date"),t.qZA(),t.TgZ(22,"label",16),t._uU(23,"In / Out"),t.qZA(),t.TgZ(24,"label",17),t._uU(25,"Phone"),t.qZA(),t.TgZ(26,"label",18),t._uU(27,"Result of disc"),t.qZA(),t.TgZ(28,"label",9),t._uU(29,"Next action"),t.qZA(),t.TgZ(30,"label",16),t._uU(31,"By"),t.qZA(),t.TgZ(32,"button",19),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.addCallRecordItem())}),t.qZA(),t._UZ(33,"hr",20),t.TgZ(34,"div",21),t.YNc(35,f,14,12,"div",22),t.qZA()()()}if(2&r){const e=t.oxw();t.xp6(1),t.Q6J("formGroup",e.form),t.xp6(4),t.Oqu(e.callRecord.personName),t.xp6(4),t.Oqu(e.callRecord.categoryRef),t.xp6(5),t.Oqu(e.callRecord.subject),t.xp6(4),t.Oqu(e.callRecord.status),t.xp6(17),t.Q6J("ngForOf",e.callRecordItems.controls)}}let x=(()=>{class r{constructor(e,o,i,d,_){this.bsModalRef=e,this.toastr=o,this.fb=i,this.confirm=d,this.service=_,this.passCallRecordEvent=new t.vpe,this.candidatName="",this.bsValueDate=new Date,this.bsValue=new Date,this.userName="",this.form=new n.cw({}),this.contactResults=[],this.nextAction=[{status:"Call again"},{status:"Correct Phone No"},{status:"Escalate To Supervisor"},{status:"Conclude"}],this.advisoriesBy=[{status:"Mail"},{status:"SMS"},{status:"Both"}],this.inOutList=[{status:"In"},{status:"Out"}],this.contactResults=this.service.getCallRecordStatus()}ngOnInit(){this.callRecord&&this.InitializeForm(this.callRecord)}InitializeForm(e){this.form=this.fb.group({id:e.id,categoryRef:e.categoryRef,personId:[e.personId,n.kI.required],personName:e.personName,personType:e.personType,username:[e.username??this.userName],status:e.status,statusDate:e.statusDate,email:e.Email,phoneNo:e.phoneNo,subject:[e.subject,n.kI.required],concludedOn:e.concludedOn,callRecordItems:this.fb.array(e.callRecordItems.map(o=>this.fb.group({id:o.id,callRecordId:o.callRecordId,incomingOutgoing:[o.incomingOutgoing,[n.kI.required,n.kI.maxLength(3)]],dateOfContact:[o.dateOfContact,n.kI.required],username:[o.username??this.userName],phoneNo:o.phoneNo,contactResult:[o.contactResult,n.kI.required],gistOfDiscussions:[o.gistOfDiscussions],nextAction:o.nextAction,nextActionOn:o.nextActionOn,email:o.email,advisoryBy:o.advisoryBy,composeSMS:o.advisoryBy})))})}get callRecordItems(){return this.form.get("callRecordItems")}newCallRecordItem(){var e=this.callRecordItems.at(this.callRecordItems.length-1);return this.fb.group({id:0,callRecordId:this.callRecord?.id,incomingOutgoing:["out",n.kI.required],dateOfContact:[new Date,n.kI.required],username:[this.userName??"",n.kI.required],contactResult:["",n.kI.required],gistOfDiscussions:"",advisoryBy:"mail",nextAction:"",nextActionOn:new Date,phoneNo:e.get("phoneNo")?.value,email:e.get("email")?.value})}addCallRecordItem(){this.callRecordItems.push(this.newCallRecordItem())}removeDepItem(e){this.confirm.confirm("Confirm Delete","This will also delete the selected Call Record Item. If you confirm to delete, remember to save this transaction").subscribe({next:o=>{o&&this.callRecordItems.removeAt(e)}})}updateCallRecord(){this.form.get("username")?.setValue(this.userName),this.passCallRecordEvent.emit(this.form.value),this.bsModalRef.hide()}contactResultChanged(e,o){switch(e.status.toLowerCase()){case"not responding":case"will revert later":this.callRecordItems.at(o).get("nextAction")?.setValue("Call Again");break;case"wrong number":this.callRecordItems.at(o).get("nextAction")?.setValue("Correct Phone Number");break;case"not interested":case"declined-family issues":case"declined for overseas":case"declined-low remuneration":default:this.callRecordItems.at(o).get("nextAction")?.setValue("Concluded");break;case"declined - sc not agreed":this.callRecordItems.at(o).get("nextAction")?.setValue("Escalate To Supervisor")}}close(){this.passCallRecordEvent.emit(null),this.bsModalRef.hide()}static#t=this.\u0275fac=function(o){return new(o||r)(t.Y36(v.UZ),t.Y36(b._W),t.Y36(n.qu),t.Y36(u.z),t.Y36(p.C))};static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["app-call-records-edit-modal"]],outputs:{passCallRecordEvent:"passCallRecordEvent"},decls:11,vars:4,consts:[[1,"modal-header","my-0"],[2,"font-size","bold"],[1,"btn","btn-success","w30","fa","fa-save",2,"margin-left","400px",3,"click"],[1,"btn","fa","fa-window-close","fa-2x","pull-right",3,"click"],[1,"modal-body","my-0"],[4,"ngIf"],[1,"modal-footer"],[2,"font-size","smaller"],[3,"formGroup"],[1,"lbl","w150"],[1,"stdd","w250"],[1,"lbl","w125","mL15"],[1,"stdd","w150"],[1,"stdd","w100"],[1,"my-1"],[1,"lbl","w80"],[1,"lbl","w75"],[1,"lbl","w125"],[1,"lbl","w175"],[1,"btn","w25","fa","fa-plus",3,"click"],[1,"my-0"],["formArrayName","callRecordItems"],[4,"ngFor","ngForOf"],[3,"formGroupName"],["type","text","placeholder","Date","formControlName","dateOfContact","bsDatepicker","",1,"stdd","w80","fSmaller",3,"bsValue","bsConfig"],["formControlName","incomingOutgoing",1,"stdd","fSmaller","w75"],["formControlName","phoneNo",1,"stdd","fSmallest","w125",3,"label"],["bindLabel","status","bindValue","status","labelForId","status","formControlName","contactResult",1,"select",2,"border-color","black","width","175px",3,"items","change"],["bindLabel","status","bindValue","status","labelForId","status","formControlName","nextAction",1,"select","w150",2,"border-color","black",3,"items"],["type","text","placeholder","Date","formControlName","nextActionOn","bsDatepicker","",1,"stdd","w75",3,"bsValue","bsConfig"],[1,"btn","w25","fa","fa-trash","fa-sm","red",3,"click"],[1,"stdd","fSmallest","b","w75","alignR"],["formControlName","gistOfDiscussions",1,"stdd","fSmallest","w600",3,"label"],["class","alert alert-danger",4,"ngIf"],[1,"alert","alert-danger"]],template:function(o,i){1&o&&(t.TgZ(0,"div",0)(1,"h4",1),t._uU(2,"Edit Call Record"),t.qZA(),t.TgZ(3,"button",2),t.NdJ("click",function(){return i.updateCallRecord()}),t.qZA(),t.TgZ(4,"button",3),t.NdJ("click",function(){return i.close()}),t.qZA()(),t.TgZ(5,"div",4),t.YNc(6,M,36,6,"div",5),t.qZA(),t._UZ(7,"div",6),t.TgZ(8,"div",7),t._uU(9),t.ALo(10,"json"),t.qZA()),2&o&&(t.xp6(6),t.Q6J("ngIf",i.callRecord),t.xp6(3),t.hij(" ",t.lcZ(10,2,i.form.value),"\n"))},dependencies:[m.sg,m.O5,g.Np,g.Y5,n._Y,n.Fj,n.JJ,n.JL,n.sg,n.u,n.x0,n.CE,c.w9,I.t,m.Ts],styles:[".stdd[_ngcontent-%COMP%]{display:inline-block;margin-left:2px;margin-right:1px;vertical-align:top;font-size:smaller}.select[_ngcontent-%COMP%]{display:inline-block;margin-left:2px;margin-right:1px;vertical-align:top;font-size:smaller;font-weight:700}.stddY0[_ngcontent-%COMP%]{display:inline-block;margin:0 1px 0 2px;vertical-align:top}.lbl[_ngcontent-%COMP%]{display:inline-block;margin-left:2px;margin-right:1px;font-weight:700;vertical-align:top;font-size:smaller}.mL15[_ngcontent-%COMP%]{margin-left:15px!important}.mL40[_ngcontent-%COMP%]{margin-left:40px!important}.mL110[_ngcontent-%COMP%]{margin-left:110px!important}.mL460[_ngcontent-%COMP%]{margin-left:460px!important}.fSmallest[_ngcontent-%COMP%]{font-size:x-small;font-weight:700}.fSmaller[_ngcontent-%COMP%]{font-size:smaller}.b[_ngcontent-%COMP%]{font-weight:700}.red[_ngcontent-%COMP%]{color:red}.alignR[_ngcontent-%COMP%]{text-align:right}.w25[_ngcontent-%COMP%]{width:25px}.w30[_ngcontent-%COMP%]{width:30px}.w50[_ngcontent-%COMP%]{width:50px}.w75[_ngcontent-%COMP%]{width:75px}.w80[_ngcontent-%COMP%]{width:80px}.w100[_ngcontent-%COMP%]{width:100px}.w125[_ngcontent-%COMP%]{width:125px}.w150[_ngcontent-%COMP%]{width:150px}.w175[_ngcontent-%COMP%]{width:175px}.w250[_ngcontent-%COMP%]{width:250px}.w600[_ngcontent-%COMP%]{width:600px}.cursorPointer[_ngcontent-%COMP%]{cursor:pointer;color:#00008b}  .ng-select .ng-select-container,   .ng-select.ng-select-single .ng-select-container{min-height:25px;font-size:.8em;font-weight:400;width:auto!important}"]})}return r})()}}]);