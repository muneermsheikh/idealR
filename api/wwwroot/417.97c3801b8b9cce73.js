"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[417],{7114:(Z,v,r)=>{r.d(v,{t:()=>d});var e=r(5879),g=r(6223),C=r(6814);function b(a,l){if(1&a&&(e.TgZ(0,"div",3),e._uU(1),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.hij(" Please enter a ",t.label," ")}}function p(a,l){if(1&a&&(e.TgZ(0,"div",3),e._uU(1),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.AsE(" ",t.label," must be at least ",null==t.control.errors?null:t.control.errors.minlength.requiredLength," characters ")}}function m(a,l){if(1&a&&(e.TgZ(0,"div",3),e._uU(1),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.AsE(" ",t.label," must be at most ",null==t.control.errors?null:t.control.errors.maxlength.requiredLength," characters ")}}function c(a,l){if(1&a&&(e.TgZ(0,"div",3),e._uU(1),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.hij(" ",t.label," do not match ")}}let d=(()=>{class a{constructor(t){this.ngControl=t,this.label="",this.type="text",this.width="",this.ngControl.valueAccessor=this}writeValue(t){}registerOnChange(t){}registerOnTouched(t){}get control(){return this.ngControl.control}static#t=this.\u0275fac=function(h){return new(h||a)(e.Y36(g.a5,2))};static#e=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-text-input"]],inputs:{label:"label",type:"type",width:"width"},decls:6,vars:10,consts:[[1,"mb-3",2,"vertical-align","top"],[1,"form-control",2,"font-size","small","word-wrap","normal","height","auto","margin-top","0px","margin-bottom","0px","padding-top","0px","padding-bottom","0px","background-color","darkgrey",3,"type","width","formControl","placeholder"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"]],template:function(h,u){1&h&&(e.TgZ(0,"div",0),e._UZ(1,"input",1),e.YNc(2,b,2,1,"div",2),e.YNc(3,p,2,2,"div",2),e.YNc(4,m,2,2,"div",2),e.YNc(5,c,2,1,"div",2),e.qZA()),2&h&&(e.xp6(1),e.ekj("is-invalid",u.control.touched&&u.control.invalid),e.s9C("type",u.type),e.s9C("width",u.width),e.s9C("placeholder",u.label),e.Q6J("formControl",u.control),e.xp6(1),e.Q6J("ngIf",null==u.control.errors?null:u.control.errors.required),e.xp6(1),e.Q6J("ngIf",null==u.control.errors?null:u.control.errors.minlength),e.xp6(1),e.Q6J("ngIf",null==u.control.errors?null:u.control.errors.maxlength),e.xp6(1),e.Q6J("ngIf",null==u.control.errors?null:u.control.errors.isMatching))},dependencies:[C.O5,g.Fj,g.JJ,g.oH]})}return a})()},7411:(Z,v,r)=>{r.d(v,{z:()=>c});var e=r(5879),g=r(2051);let C=(()=>{class d{constructor(l){this.bsModalRef=l,this.title="",this.message="",this.btnOkText="",this.btnCancelText="",this.result=!1}confirm(){this.result=!0,this.bsModalRef.hide()}decline(){this.bsModalRef.hide()}static#t=this.\u0275fac=function(t){return new(t||d)(e.Y36(g.UZ))};static#e=this.\u0275cmp=e.Xpm({type:d,selectors:[["app-confirm-dialog"]],decls:11,vars:4,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],[1,"modal-body"],[1,"modal-footer"],["type","button",1,"btn","btn-success",3,"click"],["type","button",1,"btn","btn-danger",3,"click"]],template:function(t,h){1&t&&(e.TgZ(0,"div",0)(1,"h4",1),e._uU(2),e.qZA()(),e.TgZ(3,"div",2)(4,"p"),e._uU(5),e.qZA()(),e.TgZ(6,"div",3)(7,"button",4),e.NdJ("click",function(){return h.confirm()}),e._uU(8),e.qZA(),e.TgZ(9,"button",5),e.NdJ("click",function(){return h.decline()}),e._uU(10),e.qZA()()),2&t&&(e.xp6(2),e.Oqu(h.title),e.xp6(3),e.Oqu(h.message),e.xp6(3),e.Oqu(h.btnOkText),e.xp6(2),e.Oqu(h.btnCancelText))}})}return d})();var b=r(7398),p=r(5516),m=r(9862);let c=(()=>{class d{constructor(l,t){this.modalService=l,this.http=t,this.baseUrl=p.N.apiUrl}confirm(l="Confirmation",t="Are you sure you want to do this?",h="Ok",u="Cancel"){return this.bsModelRef=this.modalService.show(C,{initialState:{title:l,message:t,btnOkText:h,btnCancelText:u}}),this.bsModelRef.onHidden.pipe((0,b.U)(()=>this.bsModelRef.content.result))}getHelp(l){return this.http.get(this.baseUrl+"Help/help/"+l)}static#t=this.\u0275fac=function(t){return new(t||d)(e.LFG(g.tT),e.LFG(m.eN))};static#e=this.\u0275prov=e.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})()},8729:(Z,v,r)=>{r.r(v),r.d(v,{CallRecordModule:()=>K});var e=r(6814),g=r(3983),C=r(8180),b=r(2181),p=r(4664),m=r(6306),c=r(2096),d=r(9397),a=r(369);class l{constructor(){this.id=0,this.personType="",this.incomingOutgoing="",this.dateOfContact=new Date,this.personId="",this.mobileNo="",this.emailId="",this.categoryRef="",this.status="",this.statusClass="Active",this.username="",this.gistOfDiscussions="",this.advisoryBy="",this.nextAction="",this.nextActionOn=new Date,this.subject="",this.search="",this.sort="",this.pageNumber=1,this.pageSize=15}}var t=r(5879),h=r(7328),u=r(7398),w=r(5516),y=r(1436),I=r(9862),U=r(8763);let E=(()=>{class s{constructor(n,i){this.http=n,this.toastr=i,this.apiUrl=w.N.apiUrl,this.currentUserSource=new h.t(1),this.currentUser$=this.currentUserSource.asObservable(),this.histParams=new l,this.categoryRefDtos=[],this.cache=new Map,this.contactResults=[{status:"Not Reachable"},{status:"Wrong Number"},{status:"Declined-Family Issues"},{status:"Declined-Low Remuneration"},{status:"Declined-Other Reasons"},{status:"Will Call later"},{status:"Not interested for overseas"},{status:"Declined-Service Charges"}]}getContactResults(){return this.contactResults}setParams(n){this.histParams=n}getParams(){return this.histParams}getCategoryRefDetails(){return this.http.get(this.apiUrl+"categoryrefdetails").pipe((0,u.U)(n=>(this.categoryRefDtos=n,n)))}getCandidateHistory(n){return this.http.get(this.apiUrl+"CallRecord/bycandidateid/"+n)}getOrAddCallRecord(n){var i=(0,y.qb)(n);return this.http.get(this.apiUrl+"CallRecord/getOrAddHistoryWithItems",{observe:"response",params:i})}getHistoryByParams(n){let i=(0,y.qb)(n);return this.http.get(this.apiUrl+"CallRecord/dto",{observe:"response",params:i})}getUserHistoryPaged(n){const i=this.cache.get(Object.values(n).join("-"));if(i)return(0,c.of)(i);let o=(0,y.qb)(n);return(0,y.Tr)(this.apiUrl+"CallRecord/pagedlist",o,this.http).pipe((0,u.U)(f=>(this.cache.set(Object.values(n).join("-"),f),f)))}deleteUserHistoryById(n){return this.http.delete(this.apiUrl+"CallRecord/deletehist/"+n)}updateUserHistory(n){return this.http.put(this.apiUrl+"CallRecord",n)}composeEmailMessageOfConsent(){}static#t=this.\u0275fac=function(i){return new(i||s)(t.LFG(I.eN),t.LFG(U._W))};static#e=this.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var N=r(7411),O=r(2051),M=r(7783),R=r(7850),L=r(7012),S=r(3574);function k(s,T){if(1&s){const n=t.EpF();t.TgZ(0,"div")(1,"div",1),t._uU(2),t.qZA(),t.TgZ(3,"div",2),t._uU(4),t.qZA(),t.TgZ(5,"div",3),t._uU(6),t.qZA(),t.TgZ(7,"div",1),t._uU(8),t.qZA(),t.TgZ(9,"div",3),t._uU(10),t.qZA(),t.TgZ(11,"div",2),t._uU(12),t.qZA(),t.TgZ(13,"button",4),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.editClicked())}),t.qZA(),t.TgZ(14,"button",5),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.callByPhone())}),t.qZA(),t.TgZ(15,"button",6),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.sendEmail())}),t.qZA(),t.TgZ(16,"button",7),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.deleteClicked())}),t.qZA()()}if(2&s){const n=t.oxw();t.xp6(2),t.Oqu(n.hist.personName),t.xp6(2),t.Oqu(n.hist.categoryRef),t.xp6(2),t.Oqu(n.hist.source),t.xp6(2),t.Oqu(n.hist.email),t.xp6(2),t.Oqu(n.hist.phoneNo),t.xp6(2),t.Oqu(n.hist.status)}}let H=(()=>{class s{constructor(n,i){this.service=n,this.toastr=i,this.editEvent=new t.vpe,this.deleteEvent=new t.vpe}ngOnInit(){}editClicked(){this.service.getCallRecordWithItems(this.hist.personType,this.hist.personId).subscribe({next:n=>{this.editEvent.emit(n)},error:n=>this.toastr.warning(n.error.text,"Failed to retrieve the call record")})}deleteClicked(){this.deleteEvent.emit(this.hist?.id)}callByPhone(){}sendEmail(){}static#t=this.\u0275fac=function(i){return new(i||s)(t.Y36(S.C),t.Y36(U._W))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-call-records-item"]],inputs:{hist:"hist"},outputs:{editEvent:"editEvent",deleteEvent:"deleteEvent"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"stdd","w175"],[1,"stdd","w150"],[1,"stdd","w100"],["title","click to add/edit transations",1,"btn","btn","fa","fa-pencil",3,"click"],["title","register conversation by phone",1,"btn","btn","fa","fa-phone",3,"click"],["title","advise conversation to the person by email",1,"btn","btn","fa","fa-envelope",3,"click"],["title","click to delete this record along with all its related child records",1,"btn","btn","fa","fa-trash","red",3,"click"]],template:function(i,o){1&i&&t.YNc(0,k,17,6,"div",0),2&i&&t.Q6J("ngIf",null!=o.hist)},dependencies:[e.O5],styles:[".stdd[_ngcontent-%COMP%]{display:inline-block;vertical-align:top;font-size:smaller;margin:0 2px;word-wrap:normal}.w100[_ngcontent-%COMP%]{width:100px}.w150[_ngcontent-%COMP%]{width:150px}.w175[_ngcontent-%COMP%]{width:175px}.red[_ngcontent-%COMP%]{color:red}.btn[_ngcontent-%COMP%]{color:#f0f8ff}"]})}return s})();const J=["search"];function F(s,T){if(1&s){const n=t.EpF();t.TgZ(0,"div",8)(1,"pagination",9),t.NdJ("pageChanged",function(o){t.CHM(n);const f=t.oxw();return t.KtG(f.onPageChanged(o))}),t._uU(2," >"),t.qZA(),t.TgZ(3,"input",10,11),t.NdJ("keyup.enter",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.onSearch())}),t.qZA(),t.TgZ(5,"button",12),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.onSearch())}),t.qZA(),t.TgZ(6,"button",13),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.onReset())}),t.qZA(),t._UZ(7,"button",14),t.qZA()}if(2&s){const n=t.oxw();t.xp6(1),t.Q6J("totalItems",n.pagination.totalItems)("itemsPerPage",n.pagination.itemsPerPage)("maxSize",10)}}function D(s,T){1&s&&(t.TgZ(0,"div",15)(1,"h4",16),t._uU(2,"No call records on record as per parameters given"),t.qZA()())}function B(s,T){if(1&s){const n=t.EpF();t.TgZ(0,"div")(1,"app-call-records-item",18),t.NdJ("editEvent",function(o){const _=t.CHM(n).$implicit,x=t.oxw(2);return t.KtG(x.editCallRecord(o,_))})("deleteEvent",function(o){t.CHM(n);const f=t.oxw(2);return t.KtG(f.deleteCallRecord(o))}),t.qZA()()}if(2&s){const n=T.$implicit;t.xp6(1),t.Q6J("hist",n)}}function q(s,T){if(1&s&&(t.TgZ(0,"div"),t.YNc(1,B,2,1,"div",17),t.qZA()),2&s){const n=t.oxw();t.xp6(1),t.Q6J("ngForOf",n.callRecords)}}let P=(()=>{class s{constructor(n,i,o,f,_,x,A){this.service=n,this.confirm=i,this.toastr=o,this.bsModalRef=f,this.accountService=_,this.bsModalService=x,this.router=A,this.callRecords=[],this.oParams=new l,this.totalCount=0,this.contactResults=[],this.userHistoryParams=new l,this.accountService.currentUser$.pipe((0,C.q)(1)).subscribe(W=>this.user=W)}ngOnInit(){this.getCallRecords(this.userHistoryParams),this.contactResults=this.service.getContactResults()}getCallRecords(n){this.service.getUserHistoryPaged(n).subscribe({next:i=>{i.result&&i.pagination&&(this.callRecords=i.result,this.pagination=i.pagination,this.totalCount=i.count)}})}onPageChanged(n){const i=this.service.getParams()??new l;i.pageNumber!==n&&(i.pageNumber=n.page,this.service.setParams(i),this.getCallRecords(i))}deleteCallRecord(n){this.confirm.confirm("confirm delete this Order","confirm delete order").pipe((0,b.h)(o=>o),(0,p.w)(o=>this.service.deleteUserHistoryById(n).pipe((0,m.K)(f=>(console.log("Error in deleting the Call Record",f),(0,c.of)())),(0,d.b)(f=>this.toastr.success("deleted the Call Recorrd")))),(0,m.K)(o=>(this.toastr.error("Error in getting delete confirmation",o),(0,c.of)()))).subscribe(()=>{console.log("delete succeeded"),this.toastr.success("Call Record deleted")},o=>{console.log("any error NOT handed in catchError() or if throwError() is returned instead of of() inside catcherror()",o)})}editCallRecord(n,i){null!==n?(this.bsModalRef=this.bsModalService.show(a.h,{class:"modal-dialog-centered modal-lg",initialState:{callRecord:n,status:i.status,candidateName:i.personName,categoryRef:i.categoryName}}),this.bsModalRef.content.updateCallRecordEvent.subscribe({next:_=>{if(""===_.strError){i.status=_.status;var x=this.callRecords.findIndex(A=>A.id==i.id);x>=0&&(this.callRecords[x]=i),this.toastr.success("The Call Record was updated","success")}else this.toastr.warning("Failed to update the call Record","Failed")},error:_=>this.toastr.error(_,"Error encountered")})):this.toastr.warning("No Call Record object returned by call record item")}onSearch(){const n=this.service.getParams();n.search=this.searchTerm?.nativeElement.value,n.pageNumber=1,this.service.setParams(n),this.getCallRecords(n)}onReset(){}static#t=this.\u0275fac=function(i){return new(i||s)(t.Y36(E),t.Y36(N.z),t.Y36(U._W),t.Y36(O.UZ),t.Y36(M.B),t.Y36(O.tT),t.Y36(R.F0))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-call-records-list"]],viewQuery:function(i,o){if(1&i&&t.Gf(J,5),2&i){let f;t.iGM(f=t.CRH())&&(o.searchTerm=f.first)}},decls:18,vars:3,consts:[[2,"display","inline-block","font-size","bold"],["style","display: inline-block; margin-left: 15px; vertical-align: top;",4,"ngIf"],[1,"form-inline",2,"margin-left","50px"],[1,"lbl","w175"],[1,"lbl","w150"],[1,"lbl","w100"],["class","my-2",4,"ngIf"],[4,"ngIf"],[2,"display","inline-block","margin-left","15px","vertical-align","top"],["previousText","\u2039","nextText","\u203a","firstText","\xab","lastText","\xbb",2,"display","inline-block",3,"totalItems","itemsPerPage","maxSize","pageChanged"],["type","text","placeholder","Search",1,"stdd","form-control","w175",3,"keyup.enter"],["search",""],["title","search the records based upon search string entered",1,"btn","fa","fa-search","fa-2x","mx-1",3,"click"],["title","clears all search parameters",1,"btn","fa","fa-refresh","fa-2x","mx-1",3,"click"],["title","go back to Administration Menu","routerLink","/",1,"btn","fa","fa-window-close","fa-2x","mx-1"],[1,"my-2"],[1,"red"],[4,"ngFor","ngForOf"],[3,"hist","editEvent","deleteEvent"]],template:function(i,o){1&i&&(t.TgZ(0,"h4",0),t._uU(1,"Call Records Listing"),t.qZA(),t.YNc(2,F,8,3,"div",1),t.TgZ(3,"div",2)(4,"label",3),t._uU(5,"Name"),t.qZA(),t.TgZ(6,"label",4),t._uU(7,"CategoryRef"),t.qZA(),t.TgZ(8,"label",5),t._uU(9,"Source"),t.qZA(),t.TgZ(10,"label",3),t._uU(11,"Email"),t.qZA(),t.TgZ(12,"label",5),t._uU(13,"Phone No"),t.qZA(),t.TgZ(14,"label",4),t._uU(15,"Status"),t.qZA(),t.YNc(16,D,3,0,"div",6),t.YNc(17,q,2,1,"div",7),t.qZA()),2&i&&(t.xp6(2),t.Q6J("ngIf",void 0!==o.pagination),t.xp6(14),t.Q6J("ngIf",!o.callRecords||0===o.callRecords.length),t.xp6(1),t.Q6J("ngIf",o.callRecords))},dependencies:[e.sg,e.O5,L.Qt,R.rH,H],styles:[".lbl[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;font-weight:700;font-size:smaller;margin:0 2px;word-wrap:normal}.stdd[_ngcontent-%COMP%]{display:inline-block!important}.b[_ngcontent-%COMP%]{font-weight:700}.w100[_ngcontent-%COMP%]{width:100px}.w150[_ngcontent-%COMP%]{width:150px}.w175[_ngcontent-%COMP%]{width:175px}.red[_ngcontent-%COMP%]{color:red}.btn[_ngcontent-%COMP%]{color:#f0f8ff}"]})}return s})();const Y=[{path:"",component:(()=>{class s{constructor(n){this.accountService=n,this.hasAdminRole=!1,this.accountService.currentUser$.pipe((0,C.q)(1)).subscribe(i=>this.user=i),this.hasAdminRole=void 0!==this.user&&this.user.roles.includes("Admin")}static#t=this.\u0275fac=function(i){return new(i||s)(t.Y36(M.B))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-call-record-menu"]],decls:13,vars:2,consts:[[1,"container","d-flex","justify-contents-between","align-items-center","mt-5"],["routerLink","/callRecords/callRecordList","title","List of Pending Call Records - for admin role",3,"disabled"],["routerLink","/callRecords/callRecordListLoggedinUsername","title","Display active Call Records for logged in User"],["routerLink","/candidates/candidatehistory","title","Candidate history"]],template:function(i,o){1&i&&(t.TgZ(0,"div",0)(1,"button",1),t._uU(2,"Active Call Records"),t._UZ(3,"br"),t._uU(4,"of All users"),t.qZA(),t.TgZ(5,"button",2),t._uU(6,"Active Call Records"),t._UZ(7,"br"),t._uU(8),t.qZA(),t.TgZ(9,"button",3),t._uU(10,"Candidate History"),t.qZA(),t.TgZ(11,"button",3),t._uU(12,"Candidate History"),t.qZA()()),2&i&&(t.xp6(1),t.Q6J("disabled",!o.hasAdminRole),t.xp6(7),t.hij("Of ",o.user.knownAs,""))},dependencies:[R.rH]})}return s})()},{path:"callRecordList",component:P},{path:"callRecordListLoggedinUsername",component:P}];let j=(()=>{class s{static#t=this.\u0275fac=function(i){return new(i||s)};static#e=this.\u0275mod=t.oAB({type:s});static#n=this.\u0275inj=t.cJS({imports:[e.ez,R.Bz.forChild(Y),R.Bz]})}return s})();var z=r(617);let K=(()=>{class s{static#t=this.\u0275fac=function(i){return new(i||s)};static#e=this.\u0275mod=t.oAB({type:s});static#n=this.\u0275inj=t.cJS({imports:[e.ez,g.m,j,z.Ps]})}return s})()},7328:(Z,v,r)=>{r.d(v,{t:()=>C});var e=r(8645),g=r(4552);class C extends e.x{constructor(p=1/0,m=1/0,c=g.l){super(),this._bufferSize=p,this._windowTime=m,this._timestampProvider=c,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=m===1/0,this._bufferSize=Math.max(1,p),this._windowTime=Math.max(1,m)}next(p){const{isStopped:m,_buffer:c,_infiniteTimeWindow:d,_timestampProvider:a,_windowTime:l}=this;m||(c.push(p),!d&&c.push(a.now()+l)),this._trimBuffer(),super.next(p)}_subscribe(p){this._throwIfClosed(),this._trimBuffer();const m=this._innerSubscribe(p),{_infiniteTimeWindow:c,_buffer:d}=this,a=d.slice();for(let l=0;l<a.length&&!p.closed;l+=c?1:2)p.next(a[l]);return this._checkFinalizedStatuses(p),m}_trimBuffer(){const{_bufferSize:p,_timestampProvider:m,_buffer:c,_infiniteTimeWindow:d}=this,a=(d?1:2)*p;if(p<1/0&&a<c.length&&c.splice(0,c.length-a),!d){const l=m.now();let t=0;for(let h=1;h<c.length&&c[h]<=l;h+=2)t=h;t&&c.splice(0,t+1)}}}}}]);