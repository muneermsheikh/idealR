"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[544],{7114:(W,I,l)=>{l.d(I,{t:()=>O});var s=l(5879),m=l(6223),V=l(6814);function t(h,C){if(1&h&&(s.TgZ(0,"div",3),s._uU(1),s.qZA()),2&h){const u=s.oxw();s.xp6(1),s.hij(" Please enter a ",u.label," ")}}function v(h,C){if(1&h&&(s.TgZ(0,"div",3),s._uU(1),s.qZA()),2&h){const u=s.oxw();s.xp6(1),s.AsE(" ",u.label," must be at least ",null==u.control.errors?null:u.control.errors.minlength.requiredLength," characters ")}}function E(h,C){if(1&h&&(s.TgZ(0,"div",3),s._uU(1),s.qZA()),2&h){const u=s.oxw();s.xp6(1),s.AsE(" ",u.label," must be at most ",null==u.control.errors?null:u.control.errors.maxlength.requiredLength," characters ")}}function S(h,C){if(1&h&&(s.TgZ(0,"div",3),s._uU(1),s.qZA()),2&h){const u=s.oxw();s.xp6(1),s.hij(" ",u.label," do not match ")}}let O=(()=>{class h{constructor(u){this.ngControl=u,this.label="",this.type="text",this.width="",this.ngControl.valueAccessor=this}writeValue(u){}registerOnChange(u){}registerOnTouched(u){}get control(){return this.ngControl.control}static#t=this.\u0275fac=function(T){return new(T||h)(s.Y36(m.a5,2))};static#e=this.\u0275cmp=s.Xpm({type:h,selectors:[["app-text-input"]],inputs:{label:"label",type:"type",width:"width"},decls:6,vars:10,consts:[[1,"mb-3",2,"vertical-align","middle"],[1,"form-control",2,"font-size","small","word-wrap","normal","height","auto","margin-top","0px","margin-bottom","0px","padding-top","0px","padding-bottom","0px",3,"type","width","formControl","placeholder"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"]],template:function(T,g){1&T&&(s.TgZ(0,"div",0),s._UZ(1,"input",1),s.YNc(2,t,2,1,"div",2),s.YNc(3,v,2,2,"div",2),s.YNc(4,E,2,2,"div",2),s.YNc(5,S,2,1,"div",2),s.qZA()),2&T&&(s.xp6(1),s.ekj("is-invalid",g.control.touched&&g.control.invalid),s.s9C("type",g.type),s.s9C("width",g.width),s.s9C("placeholder",g.label),s.Q6J("formControl",g.control),s.xp6(1),s.Q6J("ngIf",null==g.control.errors?null:g.control.errors.required),s.xp6(1),s.Q6J("ngIf",null==g.control.errors?null:g.control.errors.minlength),s.xp6(1),s.Q6J("ngIf",null==g.control.errors?null:g.control.errors.maxlength),s.xp6(1),s.Q6J("ngIf",null==g.control.errors?null:g.control.errors.isMatching))},dependencies:[V.O5,m.Fj,m.JJ,m.oH]})}return h})()},2544:(W,I,l)=>{l.r(I),l.d(I,{FinanceModule:()=>le});var s=l(6814),m=l(7133),V=l(8180),t=l(5879),v=l(8763),E=l(7783);let S=(()=>{class o{constructor(e,n,i){this.toastr=e,this.accountService=n,this.router=i,this.accountService.currentUser$.pipe((0,V.q)(1)).subscribe({next:a=>{a&&(this.user=a)}})}close(){}navigateByRoute(e,n){this.router.navigate([n+"/"+e],{state:{user:this.user,returnUrl:"/administration/customers"}})}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(v._W),t.Y36(E.B),t.Y36(m.F0))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-finance-menu"]],decls:11,vars:0,consts:[[1,"container","d-flex","justify-contents-between","align-items-center","mt-5"],["title","a list of all account names",1,"nav-item","menuStdd"],["routerLink","/finance/coalist","routerLinkActive","active",1,"nav-item","menuStdd"],["title","listing of Orders",1,"nav-item","menuStdd"],["routerLink","/finance/voucherlist","routerLinkActive","active",1,"nav-link"],[1,"nav-item","menuStdd"],["routerLink","/finance/receiptspendingconfirmation","title","Receipt of funds through cash/bank - confirm their receipts","routerLinkActive","active"],["title","go back to home",1,"stdd","fa","fa-undo",3,"click"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"a",2),t._uU(3,"Chart Of Accounts"),t.qZA()(),t.TgZ(4,"div",3)(5,"a",4),t._uU(6,"List of Vouchers"),t.qZA()(),t.TgZ(7,"div",5)(8,"a",6),t._uU(9,"Receipt of Funds pending approval"),t.qZA()(),t.TgZ(10,"button",7),t.NdJ("click",function(){return i.close()}),t.qZA()())},dependencies:[m.rH,m.Od],styles:[".menuStdd[_ngcontent-%COMP%]{display:inline-block;width:150px;margin:0 10px;word-wrap:break-word;text-align:center;vertical-align:middle;border:2px;cursor:pointer}"]})}return o})();var O=l(2181),h=l(4664),C=l(6306),u=l(2096),T=l(9397);class g{constructor(){this.cOAId=0,this.accountName="",this.amount=0,this.cVRefId=0,this.voucherNo=0,this.voucherDated="",this.pageNumber=1,this.pageSize=10,this.sort="voucherNo",this.search=""}}var _=l(9862),R=l(7328),F=l(7398),J=l(5516),Y=l(3976);let P=(()=>{class o{constructor(e){this.http=e,this.apiUrl=J.N.apiUrl,this.currentUserSource=new R.t(1),this.currentUser$=this.currentUserSource.asObservable(),this.sParams=new g,this.vouchers=[],this.count=0,this.cache=new Map}getVouchers(){const e=this.cache.get(Object.values(this.sParams).join("-"));if(e)return(0,u.of)(e);var n=this.sParams;let i=new _.LE;return i=i.append("pageNumber",n.pageNumber.toString()),i=i.append("pageSize",n.pageSize.toString()),0!==n.cOAId&&(i=i.append("coaId",n.cOAId.toString())),0!==n.voucherNo&&(i=i.append("voucherNo",n.voucherNo.toString())),""!==n.voucherDated&&(i=i.append("vocherDated",n.voucherDated)),0!==n.cVRefId&&(i=i.append("cVRefId",n.cVRefId.toString())),0!==n.amount&&(i=i.append("amount",n.amount.toString())),""===n.accountName&&(i=i.append("accountName",n.accountName)),n.search&&(i=i.append("search",n.search)),i=i.append("sort",this.sParams.sort),(0,Y.Tr)(this.apiUrl+"finance/voucherspagedlist",i,this.http).pipe((0,F.U)(a=>(console.log("response in voucherservice:",a),this.cache.set(Object.values(n).join("-"),a),a)))}getVoucherFromId(e){return 0===e?(0,u.of)(void 0):this.http.get(this.apiUrl+"finance/voucher/"+e)}deleteVoucher(e){return this.http.delete(this.apiUrl+"finance/deletevoucher/"+e)}insertVoucherWithUploads(e){return this.http.post(this.apiUrl+"finance/newvoucherwithattachment",e,{reportProgress:!0,observe:"events"})}updateWithFiles(e){return this.http.put(this.apiUrl+"finance/updateVoucherwithattachment",e,{reportProgress:!0,observe:"events"})}getNextVoucherNo(){return this.http.get(this.apiUrl+"finance/nextvoucherno")}getStatementOfAccount(e,n,i){return this.http.get(this.apiUrl+"finance/soa/"+e+"/"+n+"/"+i)}deleteVoucherFromCache(e){this.cache.delete(e),this.pagination.totalItems--}setParams(e){this.sParams=e}getParams(){return this.sParams}static#t=this.\u0275fac=function(n){return new(n||o)(t.LFG(_.eN))};static#e=this.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var y=l(7411),L=l(7012);function X(o,r){1&o&&(t.TgZ(0,"div"),t._uU(1," No Financial tranaction on record "),t.qZA())}function $(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"div",2)(1,"div",3)(2,"div",4),t._uU(3),t.qZA(),t.TgZ(4,"div",5),t._uU(5),t.ALo(6,"date"),t.qZA(),t.TgZ(7,"div",6),t._uU(8),t.qZA(),t.TgZ(9,"div",7),t._uU(10),t.qZA(),t.TgZ(11,"div",8),t._uU(12),t.qZA(),t.TgZ(13,"div",9),t._uU(14),t.qZA(),t.TgZ(15,"div",9),t._uU(16),t.qZA(),t.TgZ(17,"div",10),t._uU(18),t.ALo(19,"date"),t.qZA(),t.TgZ(20,"div",11),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.editTransaction(i.t.id))}),t.qZA(),t.TgZ(21,"div",12),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.deleteTransaction(i.t.id))}),t.qZA()()()}if(2&o){const e=t.oxw();t.xp6(3),t.Oqu(e.t.voucherNo),t.xp6(2),t.Oqu(t.xi3(6,8,e.t.voucherDated,"dd-MMM-yy")),t.xp6(3),t.Oqu(e.t.accountName),t.xp6(2),t.Oqu(e.t.amount.toLocaleString()),t.xp6(2),t.Oqu(e.t.narration),t.xp6(2),t.hij("",e.t.approved?"Y":"N"," "),t.xp6(2),t.hij("",null===e.t.reviewedByName?"--":e.t.reviewedByName," "),t.xp6(2),t.hij("",null===e.t.reviewedOn?"--":t.xi3(19,11,e.t.reviewedOn,"ddMMMyy")," ")}}let tt=(()=>{class o{constructor(){this.editEvent=new t.vpe,this.deleteEvent=new t.vpe}editTransaction(e){this.editEvent.emit(e)}deleteTransaction(e){this.deleteEvent.emit(e)}static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-voucher-item"]],inputs:{t:"t"},outputs:{editEvent:"editEvent",deleteEvent:"deleteEvent"},decls:2,vars:2,consts:[[4,"ngIf"],["class","col-12",4,"ngIf"],[1,"col-12"],[1,"container","stdd","row","mb-0"],["title","edit the transaction",1,"stdd","w90"],[1,"stdd","w100"],["title","view this transaction",1,"stdd","w200"],[1,"stdd","w90","alignRight"],[1,"stdd","fSmall","w250"],[1,"stdd","w100","hM","w60",2,"border","aqua"],[1,"stdd","w100","hM","w75",2,"border","aqua"],["title","edit this Voucher",1,"stdd","w30","mx-2","fa","fa-pencil",3,"click"],["title","delete this Voucher",1,"stdd","w30","mx-2","fa","fa-trash","red",3,"click"]],template:function(n,i){1&n&&(t.YNc(0,X,2,0,"div",0),t.YNc(1,$,22,14,"div",1)),2&n&&(t.Q6J("ngIf",null===i.t),t.xp6(1),t.Q6J("ngIf",null!=i.t))},dependencies:[s.O5,s.uU],styles:[".stdd[_ngcontent-%COMP%]{display:inline-block;vertical-align:top;word-wrap:break-word}.alignRight[_ngcontent-%COMP%]{text-align:right}.hM[_ngcontent-%COMP%]{text-align:center}.fSmall[_ngcontent-%COMP%]{font-size:small}.red[_ngcontent-%COMP%]{color:red}.w30[_ngcontent-%COMP%]{width:30px}.w60[_ngcontent-%COMP%]{width:60px}.w75[_ngcontent-%COMP%]{width:75px}.w90[_ngcontent-%COMP%]{width:90px}.w100[_ngcontent-%COMP%]{width:100px}.w200[_ngcontent-%COMP%]{width:200px}.w250[_ngcontent-%COMP%]{width:250px}.cr[_ngcontent-%COMP%]{padding-left:90px;width:75px;padding-right:50px;text-align:right}.dr[_ngcontent-%COMP%]{padding-left:10x;width:75px;padding-right:130px;text-align:right}"]})}return o})();const et=["search"];function nt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"pagination",18),t.NdJ("pageChanged",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.onPageChanged(i))}),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("totalItems",e.pagination.totalItems)("itemsPerPage",e.pagination.itemsPerPage)("maxSize",10)}}function it(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"app-voucher-item",19),t.NdJ("editEvent",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.editTransaction(i,!0))})("deleteEvent",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.deleteVoucher(i))}),t.qZA()()}if(2&o){const e=r.$implicit;t.xp6(1),t.Q6J("t",e)}}let ot=(()=>{class o{constructor(e,n,i,a){this.service=e,this.toastr=n,this.router=i,this.confirmService=a,this.sParams=new g,this.totalCount=0,this.vouchers=[],this.bolNavigationExtras=!1,this.returnUrl="";let c=this.router.getCurrentNavigation();c?.extras&&c.extras.state&&(this.bolNavigationExtras=!0,c.extras.state.returnUrl&&(this.returnUrl=c.extras.state.returnUrl),c.extras.state.userobject&&(this.user=c.extras.state.userobject))}ngOnInit(){this.getVouchers()}getVouchers(){this.service.setParams(this.sParams),this.service.getVouchers().subscribe({next:e=>{this.vouchers=e.result,this.pagination=e.pagination,this.totalCount=e.count}})}onReset(){this.searchTerm.nativeElement.value="",this.sParams=new g,this.getVouchers()}onPageChanged(e){this.sParams.pageNumber!==e.page&&(this.sParams.pageNumber=e.page,this.getVouchers())}onSearch(){}addNewFinanceTransaction(){this.router.navigate(["/finance/voucherEdit/0"],{state:{toedit:!0,returnUrl:"/finance/voucherlist"}})}editTransaction(e,n){this.router.navigate(["/finance/voucherEdit/"+e],{state:{toedit:n,returnUrl:"/finance/voucherlist",userObject:this.user}})}deleteVoucher(e){this.confirmService.confirm("confirm delete this voucher","confirm delete voucher").pipe((0,O.h)(n=>n),(0,h.w)(n=>this.service.deleteVoucher(e).pipe((0,C.K)(i=>(console.log("Error in deleting the voucher",i),(0,u.of)())),(0,T.b)(i=>this.toastr.success("deleted voucher")))),(0,C.K)(n=>(this.toastr.error("Error in getting delete confirmation",n),(0,u.of)()))).subscribe(n=>{console.log("deete succeeded"),this.toastr.success("voucher deleted")},n=>{console.log("any error NOT handed in catchError() or if throwError() is returned instead of of() inside catcherror()",n)})}removeTaskFromCache(e){this.service.deleteVoucherFromCache(e);var n=this.vouchers.findIndex(i=>i.id==e);this.vouchers.splice(n,1),this.toastr.success("task deleted")}returnToCaller(){this.router.navigateByUrl(this.returnUrl||"")}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(P),t.Y36(v._W),t.Y36(m.F0),t.Y36(y.z))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-voucher-list"]],viewQuery:function(n,i){if(1&n&&t.Gf(et,5),2&n){let a;t.iGM(a=t.CRH())&&(i.searchTerm=a.first)}},decls:28,vars:2,consts:[[2,"margin-right","15px","display","inline-block"],["class","stdd","previousText","\u2039","nextText","\u203a","firstText","\xab","lastText","\xbb",3,"totalItems","itemsPerPage","maxSize","pageChanged",4,"ngIf"],["type","text","placeholder","Search",1,"stdd","w200",2,"margin-left","15px",3,"keyup.enter"],["search",""],["title","search the text entered",1,"stdd","btn","fa-solid","fa-find","mx-2",3,"click"],["title","add a new Finance Voucher",1,"btn","mx-2","fa","fa-plus","mx-2",2,"display","inline-block",3,"click"],["title","return to calling program",1,"btn","mx-2","fa","fa-window-close",2,"display","inline-block",3,"click"],[2,"padding-top","0px","padding-bottom","0px","margin-top","0px","margin-bottom","0px","margin-left","10px","padding-right","10px"],[1,"container","displayInBlockV","my-0","py-0","ml-5"],[1,"stdd","vAlignM","w90","b"],[1,"stdd","vAlignM","w100","b"],[1,"stdd","vAlignM","mx-1","w200","b"],[1,"stdd","vAlignM","w90","b",2,"text-align","center"],[1,"stdd","vAlignM","w250","b"],[1,"stdd","vAlignM","hM","w60","b"],[1,"stdd","vAlignM","hM","w75","b"],[1,"my-0","py-0","ml-5"],[4,"ngFor","ngForOf"],["previousText","\u2039","nextText","\u203a","firstText","\xab","lastText","\xbb",1,"stdd",3,"totalItems","itemsPerPage","maxSize","pageChanged"],[3,"t","editEvent","deleteEvent"]],template:function(n,i){1&n&&(t.TgZ(0,"h4",0),t._uU(1,"Voucher Lists"),t.qZA(),t.YNc(2,nt,1,3,"pagination",1),t.TgZ(3,"input",2,3),t.NdJ("keyup.enter",function(){return i.onSearch()}),t.qZA(),t.TgZ(5,"button",4),t.NdJ("click",function(){return i.onSearch()}),t.qZA(),t.TgZ(6,"button",5),t.NdJ("click",function(){return i.addNewFinanceTransaction()}),t.qZA(),t.TgZ(7,"button",6),t.NdJ("click",function(){return i.returnToCaller()}),t.qZA(),t._UZ(8,"hr",7),t.TgZ(9,"div",8)(10,"div",9),t._uU(11,"Voucher No"),t.qZA(),t.TgZ(12,"div",10),t._uU(13,"Dated"),t.qZA(),t.TgZ(14,"div",11),t._uU(15,"Account Name"),t.qZA(),t.TgZ(16,"div",12),t._uU(17,"Amount"),t.qZA(),t.TgZ(18,"div",13),t._uU(19,"Narration"),t.qZA(),t.TgZ(20,"div",14),t._uU(21,"Approved"),t.qZA(),t.TgZ(22,"div",14),t._uU(23,"By"),t.qZA(),t.TgZ(24,"div",15),t._uU(25,"On"),t.qZA(),t._UZ(26,"hr",16),t.YNc(27,it,2,1,"div",17),t.qZA()),2&n&&(t.xp6(2),t.Q6J("ngIf",void 0!==i.pagination),t.xp6(25),t.Q6J("ngForOf",i.vouchers))},dependencies:[s.sg,s.O5,L.Qt,tt],styles:[".stdd[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle}.b[_ngcontent-%COMP%]{font-weight:700}.VAlignM[_ngcontent-%COMP%]{vertical-align:middle}.hM[_ngcontent-%COMP%]{text-align:center}.w60[_ngcontent-%COMP%]{width:60px}.w65[_ngcontent-%COMP%]{width:65px}.w75[_ngcontent-%COMP%]{width:75px}.w90[_ngcontent-%COMP%]{width:90px}.w100[_ngcontent-%COMP%]{width:100px}.w125[_ngcontent-%COMP%]{width:125px}.w150[_ngcontent-%COMP%]{width:150px}.w200[_ngcontent-%COMP%]{width:200px}.w250[_ngcontent-%COMP%]{width:250px}"]})}return o})();class x{constructor(){this.id=0,this.accountName="",this.accountId=0,this.accountType="",this.accountClass="",this.pageNumber=1,this.pageSize=10,this.sort="accountName",this.search=""}}class at{constructor(){this.applicationNo=0,this.passportNo="",this.mobileNo=""}}let N=(()=>{class o{constructor(e){this.http=e,this.apiUrl=J.N.apiUrl,this.currentUserSource=new R.t(1),this.currentUser$=this.currentUserSource.asObservable(),this.sParams=new x,this.coalists=[],this.cache=new Map,this.candidateCOAParams=new at}getCoaList(){return this.http.get(this.apiUrl+"finance/coalist")}createCandidateCOA(e){return this.http.get(this.apiUrl+"finance/candidateCOA/"+e+"/"+!0)}getCoas(){var e=this.getParams();const n=this.cache.get(Object.values(e).join("-"));if(n)return(0,u.of)(n);let i=this.getHttpParamsForCOA(e);return(0,Y.Tr)(this.apiUrl+"Finance/coapagedlist",i,this.http).pipe((0,F.U)(a=>(this.cache.set(Object.values(e).join("-"),a),a)))}editCOA(e){return this.http.put(this.apiUrl+"finance/coa",e)}addNewCOA(e){return this.http.post(this.apiUrl+"finance/coa",e)}deleteCOA(e){return this.http.delete(this.apiUrl+"finance/coa/"+e)}updateCOA(e){return this.http.put(this.apiUrl+"finance/coa",e)}getMatchingCOAs(e){return this.http.get(this.apiUrl+"finance/matchingcoas/"+e)}deleteFromCache(e){this.cache.delete(e),this.pagination.totalItems--}getGroupOfCOAs(e){return this.http.get(this.apiUrl+"Finance/coabygroup/"+e)}getCandidateCOAs(e){return this.http.get(this.apiUrl+"Finance/coasforpayment/"+e)}getHttpParamsForCOA(e){let n=new _.LE;return n=n.append("pageSize",e.pageSize),n=n.append("pageNumber",e.pageNumber),e.search&&(n=n.append("search",e.search)),""!==e.accountName&&(n=n.append("coaId",e.accountName)),""!==e.sort&&(n=n.append("sort",e.sort)),0!==e.accountId&&(n=n.append("accountId",e.accountId.toString())),""!==e.accountType&&(n=n.append("accountType",e.accountType)),""!==e.accountClass&&(n=n.append("accountClass",e.accountClass)),n}setParams(e){this.sParams=e}getParams(){return this.sParams}static#t=this.\u0275fac=function(n){return new(n||o)(t.LFG(_.eN))};static#e=this.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();class Q{constructor(){this.id=0,this.divn="",this.accountType="",this.accountName="",this.accountClass="",this.opBalance=0}}var U=l(2051),d=l(6223),G=l(4807);function rt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ng-select",15),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.classChanged())})("ngModelChange",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.coa.accountClass=i)}),t.qZA()}if(2&o){const e=t.oxw(2);t.Q6J("items",e.accountClasses)("ngModel",e.coa.accountClass)}}function ct(o,r){1&o&&(t.TgZ(0,"div"),t._uU(1,"No matching Accounts exist"),t.qZA())}function lt(o,r){if(1&o&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&o){const e=r.$implicit;t.xp6(1),t.hij(" ",e," ")}}function dt(o,r){if(1&o&&(t.TgZ(0,"div"),t.YNc(1,lt,2,1,"div",16),t.qZA()),2&o){const e=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",e.matchingNames)}}function ut(o,r){if(1&o&&(t.TgZ(0,"div"),t.YNc(1,ct,2,0,"div",11),t.YNc(2,dt,2,1,"div",11),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",0===e.matchingNames.length),t.xp6(1),t.Q6J("ngIf",e.matchingNames.length>0)}}function ht(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"div",6)(1,"div",7)(2,"label",8),t._uU(3,"Account Class"),t.qZA(),t.YNc(4,rt,1,2,"ng-select",9),t._UZ(5,"br"),t.TgZ(6,"label",8),t._uU(7,"Account Name: "),t.qZA(),t.TgZ(8,"input",10),t.NdJ("change",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.checkExists())})("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.coa.accountName=i)}),t.qZA(),t._UZ(9,"br"),t.TgZ(10,"div",7),t.YNc(11,ut,3,2,"div",11),t.qZA(),t._UZ(12,"br"),t.TgZ(13,"label",8),t._uU(14,"Account Type: "),t.qZA(),t.TgZ(15,"input",12),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.coa.accountType=i)}),t.qZA(),t._UZ(16,"br"),t.TgZ(17,"label",8),t._uU(18,"Division: "),t.qZA(),t.TgZ(19,"input",12),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.coa.divn=i)}),t.qZA(),t._UZ(20,"br"),t.TgZ(21,"label",8),t._uU(22,"Opening Balance"),t.qZA(),t.TgZ(23,"input",13),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.coa.opBalance=i)}),t.qZA()(),t._UZ(24,"div",14),t.qZA()}if(2&o){const e=t.oxw();t.xp6(4),t.Q6J("ngIf",e.accountClasses),t.xp6(4),t.Q6J("ngModel",e.coa.accountName),t.xp6(3),t.Q6J("ngIf",!e.coa.accountName),t.xp6(4),t.Q6J("ngModel",e.coa.accountType),t.xp6(4),t.Q6J("ngModel",e.coa.divn),t.xp6(4),t.Q6J("ngModel",e.coa.opBalance)}}let z=(()=>{class o{constructor(e,n,i){this.bsModalRef=e,this.coaService=n,this.toastr=i,this.editCOAEvent=new t.vpe,this.matchingCOA="",this.matchingNames=[],this.title="",this.accountClasses=[{accountClass:"exp"},{accountClass:"banks"},{accountClass:"salesiata"},{accountClass:"personalaccount"},{accountClass:"sales"},{accountClass:"candidate"},{accountClass:"asset"}]}ngOnInit(){this.checkExists()}checkExists(){null===this.coa||""===this.coa.accountName||(this.matchingNames=[],this.coaService.getMatchingCOAs(this.coa.accountName).subscribe(e=>{this.matchingNames=e},e=>{this.matchingNames=[]}))}updateCOA(){""!==this.coa.accountClass&&""!==this.coa.accountName&&""!==this.coa.accountType&&""!==this.coa.divn?(this.editCOAEvent.emit(this.coa),this.bsModalRef.hide()):this.toastr.warning("all properties except Opening Balance are mandatory")}classChanged(){}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(U.UZ),t.Y36(N),t.Y36(v._W))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-coa-edit-modal"]],outputs:{editCOAEvent:"editCOAEvent"},decls:7,vars:2,consts:[[1,"modal-header"],[1,"b"],["type","button","title","submit",1,"stdd","btn","btn-default","green","fa","fa-2x","fa-check",3,"click"],["type","button","aria-label","Close",1,"stdd","close","pull-right","fa","fa-2x","fa-close",3,"click"],["class","modal-body",4,"ngIf"],[1,"modal-footer"],[1,"modal-body"],[1,"stdd"],[1,"stdd","w150","b"],["class","stdd w150","bindLabel","accountClass","bindValue","accountClass","labelForId","accountClass","placeholder","Select Account Class","clearAllText","Clear",3,"items","ngModel","click","ngModelChange",4,"ngIf"],["type","text",1,"stdd","w250",3,"ngModel","change","ngModelChange"],[4,"ngIf"],["type","text",1,"stdd","w25",3,"ngModel","ngModelChange"],["type","text",1,"stdd","w90",3,"ngModel","ngModelChange"],[1,"stdd","col-4",2,"vertical-align","top"],["bindLabel","accountClass","bindValue","accountClass","labelForId","accountClass","placeholder","Select Account Class","clearAllText","Clear",1,"stdd","w150",3,"items","ngModel","click","ngModelChange"],[4,"ngFor","ngForOf"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"div",1),t._uU(2),t.qZA(),t.TgZ(3,"button",2),t.NdJ("click",function(){return i.updateCOA()}),t.qZA(),t.TgZ(4,"button",3),t.NdJ("click",function(){return i.bsModalRef.hide()}),t.qZA()(),t.YNc(5,ht,25,6,"div",4),t._UZ(6,"div",5)),2&n&&(t.xp6(2),t.Oqu(i.title),t.xp6(3),t.Q6J("ngIf",void 0!==i.coa))},dependencies:[s.sg,s.O5,d.Fj,d.JJ,d.On,G.w9],styles:[".stdd[_ngcontent-%COMP%]{display:inline-block}.w25[_ngcontent-%COMP%]{width:25px}.w90[_ngcontent-%COMP%]{width:90px}.w150[_ngcontent-%COMP%]{width:150px}.w250[_ngcontent-%COMP%]{width:250px}.b[_ngcontent-%COMP%]{font-weight:700}.green[_ngcontent-%COMP%]{color:green}.red[_ngcontent-%COMP%]{color:red}"]})}return o})(),pt=(()=>{class o{constructor(e,n){this.toastr=e,this.bsModalRef=n,this.outputEvent=new t.vpe,this.inputValue="",this.title=""}ngOnInit(){}returnInputValue(){""!==this.inputValue?(this.outputEvent.emit(this.inputValue),this.bsModalRef.hide()):this.toastr.warning("no value entered")}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(v._W),t.Y36(U.UZ))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-input-modal"]],outputs:{outputEvent:"outputEvent"},decls:10,vars:2,consts:[[1,"modal-header"],[1,"b"],["type","button","title","submit",1,"stdd","btn","btn-default","green","fa","fa-2x","fa-check",3,"click"],["type","button","aria-label","Close",1,"stdd","close","pull-right","fa","fa-2x","fa-close",3,"click"],[1,"modal-body"],[1,"stdd","w75","b"],["type","text",1,"stdd","w110",3,"ngModel","ngModelChange"],[1,"modal-footer"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"div",1),t._uU(2),t.qZA(),t.TgZ(3,"button",2),t.NdJ("click",function(){return i.returnInputValue()}),t.qZA(),t.TgZ(4,"button",3),t.NdJ("click",function(){return i.bsModalRef.hide()}),t.qZA()(),t.TgZ(5,"div",4)(6,"label",5),t._uU(7,"Enter the value: "),t.qZA(),t.TgZ(8,"input",6),t.NdJ("ngModelChange",function(c){return i.inputValue=c}),t.qZA()(),t._UZ(9,"div",7)),2&n&&(t.xp6(2),t.Oqu(i.title),t.xp6(6),t.Q6J("ngModel",i.inputValue))},dependencies:[d.Fj,d.JJ,d.On],styles:[".stdd[_ngcontent-%COMP%]{display:inline-block;font-size:medium}.w75[_ngcontent-%COMP%]{width:75px}.w110[_ngcontent-%COMP%]{width:110px}"]})}return o})();class mt{constructor(){this.fromDate=new Date,this.uptoDate=new Date}}var k=l(3593);const j=function(){return{dateInputFormat:"YYYY-MM-DD"}};let gt=(()=>{class o{constructor(e,n){this.toastr=e,this.bsModalRef=n,this.returnDateRangeEvent=new t.vpe,this.title="",this.bsValue=new Date,this.bsRangeValue=new Date,this.maxDate=new Date,this.minDate=new Date,this.bsValueDate=new Date,this.minDate.setDate(this.minDate.getDate()-30)}returnDateRange(){if(this.minDate>this.maxDate)this.toastr.warning("End Date should be equal to or later than from Date");else{var e=new mt;e.fromDate=this.minDate,e.uptoDate=this.maxDate,this.returnDateRangeEvent.emit(e),this.bsModalRef.hide()}}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(v._W),t.Y36(U.UZ))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-date-input-range-modal"]],outputs:{returnDateRangeEvent:"returnDateRangeEvent"},decls:13,vars:9,consts:[[1,"modal-header"],[1,"b"],["type","button","title","submit",1,"stdd","btn","btn-default","green","fa","fa-2x","fa-check",3,"click"],["type","button","aria-label","Close",1,"stdd","close","pull-right","fa","fa-2x","fa-close",3,"click"],[1,"modal-body"],[1,"stdd","w75","b"],["type","text","placeholder","First Date","bsDatepicker","",1,"stdd","w110",3,"ngModel","bsValue","bsConfig","ngModelChange"],[1,"stdd","w90","b","rAlign","mx-2"],["type","text","placeholder","Second Date","bsDatepicker","",1,"stdd","w110",3,"ngModel","bsValue","bsConfig","ngModelChange"],[1,"modal-footer"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"div",1),t._uU(2),t.qZA(),t.TgZ(3,"button",2),t.NdJ("click",function(){return i.returnDateRange()}),t.qZA(),t.TgZ(4,"button",3),t.NdJ("click",function(){return i.bsModalRef.hide()}),t.qZA()(),t.TgZ(5,"div",4)(6,"label",5),t._uU(7,"First Date: "),t.qZA(),t.TgZ(8,"input",6),t.NdJ("ngModelChange",function(c){return i.minDate=c}),t.qZA(),t.TgZ(9,"label",7),t._uU(10,"Second Date: "),t.qZA(),t.TgZ(11,"input",8),t.NdJ("ngModelChange",function(c){return i.maxDate=c}),t.qZA()(),t._UZ(12,"div",9)),2&n&&(t.xp6(2),t.Oqu(i.title),t.xp6(6),t.Q6J("ngModel",i.minDate)("bsValue",i.bsValueDate)("bsConfig",t.DdM(7,j)),t.xp6(3),t.Q6J("ngModel",i.maxDate)("bsValue",i.bsValueDate)("bsConfig",t.DdM(8,j)))},dependencies:[k.Np,k.Y5,d.Fj,d.JJ,d.On],styles:[".w75[_ngcontent-%COMP%]{width:75px}.w90[_ngcontent-%COMP%]{width:90px}.w110[_ngcontent-%COMP%]{width:110px}.b[_ngcontent-%COMP%]{font-weight:700}.rAlign[_ngcontent-%COMP%]{text-align:right}.green[_ngcontent-%COMP%]{color:green}.stdd[_ngcontent-%COMP%]{display:inline-block}"]})}return o})();function ft(o,r){1&o&&(t.TgZ(0,"div"),t._uU(1," No Chart of Accounts data on record "),t.qZA())}function _t(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"div",9),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.updateCandidateAccountName())}),t.qZA()}}function vt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"div",1)(2,"div",2),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.viewCOA(i.t))}),t._uU(3),t.qZA(),t.TgZ(4,"div",3),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.updateCOA(i.t))}),t._uU(5),t.qZA(),t.TgZ(6,"div",4),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.statementOfAccount(i.t.id))}),t._uU(7),t.qZA(),t.TgZ(8,"div",5),t._uU(9),t.qZA(),t.TgZ(10,"div",6),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.statementOfAccount(i.t.id))}),t.qZA(),t.YNc(11,_t,1,0,"div",7),t.TgZ(12,"div",8),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.deleteTransaction(i.t.id))}),t.qZA()()()}if(2&o){const e=t.oxw();t.xp6(3),t.Oqu(e.t.divn),t.xp6(2),t.Oqu(e.t.accountName),t.xp6(2),t.Oqu(e.t.accountType),t.xp6(2),t.hij("",e.t.opBalance.toLocaleString()," "),t.xp6(2),t.Q6J("ngIf","candidate"===e.t.accountClass)}}let Ct=(()=>{class o{constructor(e){this.confirmService=e,this.editEvent=new t.vpe,this.viewEvent=new t.vpe,this.deleteEvent=new t.vpe,this.statementOfAccountEvent=new t.vpe,this.updateCandidateAccountEvent=new t.vpe}statementOfAccount(e){this.statementOfAccountEvent.emit(e)}updateCandidateAccountName(){this.updateCandidateAccountEvent.emit(this.t)}updateCOA(e){this.editEvent.emit(e)}viewCOA(e){this.viewEvent.emit(e)}deleteCOA(e){this.confirmService.confirm("deleting this account will also delete all its transactions.  Do you really want to continue with the deletion?","confirm DELETE a chart of account along with all its transactions").subscribe(n=>{}),this.deleteEvent.emit(e)}deleteTransaction(e){}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(y.z))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-coa-item"]],inputs:{t:"t"},outputs:{editEvent:"editEvent",viewEvent:"viewEvent",deleteEvent:"deleteEvent",statementOfAccountEvent:"statementOfAccountEvent",updateCandidateAccountEvent:"updateCandidateAccountEvent"},decls:2,vars:2,consts:[[4,"ngIf"],[1,"stdd","row","mb-0"],["title","view this account",1,"stdd","w100",3,"click"],["title","edit this account",1,"stdd","w300",3,"click"],["title","click to display statement of account of this account",1,"stdd","w75","alignRight",3,"click"],[1,"stdd","w100","rAlign",2,"border","aqua"],["title","statement of account",1,"stdd","w30","fa","fa-table",3,"click"],["class","stdd w30 green fa fa-pencil","title","update accountname to include application number",3,"click",4,"ngIf"],["title","delete this account along with all its tranactions",1,"stdd","w30","fa","fa-trash","red",3,"click"],["title","update accountname to include application number",1,"stdd","w30","green","fa","fa-pencil",3,"click"]],template:function(n,i){1&n&&(t.YNc(0,ft,2,0,"div",0),t.YNc(1,vt,13,5,"div",0)),2&n&&(t.Q6J("ngIf",null===i.t),t.xp6(1),t.Q6J("ngIf",null!=i.t))},dependencies:[s.O5],styles:[".stdd[_ngcontent-%COMP%]{display:inline-block;margin:0 2px;vertical-align:top}.red[_ngcontent-%COMP%]{color:red}.rAlign[_ngcontent-%COMP%]{text-align:right}.w30[_ngcontent-%COMP%]{width:30px}.w75[_ngcontent-%COMP%]{width:75px}.w100[_ngcontent-%COMP%]{width:100px}.w300[_ngcontent-%COMP%]{width:300px}"]})}return o})();const xt=["search"];function wt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"pagination",11),t.NdJ("pageChanged",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.onPageChanged(i))}),t._uU(1," >"),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("totalItems",e.pagination.totalItems)("itemsPerPage",e.pagination.itemsPerPage)("maxSize",10)}}function At(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"div",12)(1,"app-coa-item",13),t.NdJ("editEvent",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.editCOAModal(i))})("deleteEvent",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.deleteCoa(i))})("statementOfAccountEvent",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.statementOfAccount(i))}),t.qZA()()}if(2&o){const e=r.$implicit;t.xp6(1),t.Q6J("t",e)}}let bt=(()=>{class o{constructor(e,n,i,a,c){this.service=e,this.toastr=n,this.router=i,this.confirmService=a,this.modalService=c,this.sParams=new x,this.totalCount=0,this.coas=[],this.bolNavigationExtras=!1,this.returnUrl="",this.inputApplicationNo=0,this.sortOptions=[{name:"By Account Name Asc",value:"name"},{name:"By Account Name Desc",value:"namedesc"},{name:"By Account Type Asc",value:"type"},{name:"By Account Type Desc",value:"typedesc"},{name:"By Division Asc",value:"divn"},{name:"By Division Desc",value:"divndesc"}];let p=this.router.getCurrentNavigation();p?.extras&&p.extras.state&&(this.bolNavigationExtras=!0,p.extras.state.returnUrl&&(this.returnUrl=p.extras.state.returnUrl),p.extras.state.userobject&&(this.user=p.extras.state.userobject))}ngOnInit(){this.getCOAs()}getCOAs(){return this.service.setParams(this.sParams),this.service.getCoas().subscribe({next:e=>{null!=e&&(this.coas=e.result,this.totalCount=e.count,this.pagination=e.pagination),console.log("coas",this.coas)},error:e=>console.log(e)})}onReset(){this.searchTerm.nativeElement.value="",this.sParams=new x,this.service.setParams(this.sParams),this.getCOAs()}onPageChanged(e){const n=this.service.getParams();n.pageNumber!==e.page&&(n.pageNumber=e.page,this.service.setParams(n),this.getCOAs())}onSearch(){this.sParams.search!==this.searchTerm.nativeElement.value&&(this.sParams.search=this.searchTerm.nativeElement.value,this.sParams.pageNumber=1,this.service.setParams(this.sParams),this.getCOAs())}addNewCOA(){this.router.navigate(["/finance/addaccount"],{state:{coatoedit:void 0,userobject:this.user,toedit:!1,returnUrl:"/finance/coalist"}})}editCOAModal(e){null===e&&(e=new Q),this.bsModalRef=this.modalService.show(z,{class:"modal-dialog-centered modal-lg",initialState:{title:"edit Chart of account",coa:e}}),this.bsModalRef.content.editCOAEvent.pipe((0,O.h)(i=>null!=i),(0,h.w)(i=>this.service.editCOA(i))).subscribe(i=>{i?this.toastr.success("COA was edited","Success"):this.toastr.warning("Failed to update the COA","Failure")})}updateCandidateAccountName(e){if(this.bsModalRef=this.modalService.show(pt,{class:"modal-dialog-centered modal-md",initialState:{title:"get Application Number to include in the Account Name"}}),this.bsModalRef.content.outputEvent.subscribe(a=>{this.inputApplicationNo=a}),e.accountName.includes("Application")){var i=e.accountName.indexOf("Application");e.accountName=e.accountName.substring(1,i+10)+this.inputApplicationNo}else e.accountName=e.accountName+"-Application "+this.inputApplicationNo;this.service.editCOA(e).subscribe(a=>{var c=this.coas.findIndex(p=>p.id===e.id);this.coas[c]=a})}statementOfAccount(e){this.bsModalRef=this.modalService.show(gt,{class:"modal-dialog-centered modal-md",initialState:{title:"get Date Range Input for Statement of Account"}}),this.bsModalRef.content.returnDateRangeEvent.subscribe(i=>{if(i.fromDate.getFullYear<2e3||i.uptoDate.getFullYear<2e3)return void this.toastr.warning("failed to get the date range");let a="/finance/soa/"+e+"/"+i.fromDate.toISOString()+"/"+i.uptoDate.toISOString();this.router.navigate([a],{state:{userobject:this.user,dateRange:i,returnUrl:"/finance/coalist"}})},i=>{console.log("error in invoking Date Range input modal",i)})}deleteCoa(e){this.confirmService.confirm("Do you want to delete the Chart of Account?  You may want to rename it, instead of deleting it!","confirm Delete Chart of account").subscribe(n=>{n||this.toastr.info("deletion request canceled")})&&this.service.deleteCOA(e).subscribe(n=>{n?this.removeFromCache(e):this.toastr.error("failed to delete the Chart of Account")},n=>{this.toastr.error("failed to delete the Chart of Account",n)})}removeFromCache(e){this.service.deleteFromCache(e);var n=this.coas.findIndex(i=>i.id==e);this.coas.splice(n,1),this.toastr.success("Chart of account deleted")}onSortSelected(e){this.sParams.sort!==e&&(this.sParams.sort=e,this.service.setParams(this.sParams),this.getCOAs())}returnToCaller(){this.router.navigateByUrl(this.returnUrl||"")}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(N),t.Y36(v._W),t.Y36(m.F0),t.Y36(y.z),t.Y36(U.tT))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-coa-list"]],viewQuery:function(n,i){if(1&n&&t.Gf(xt,5),2&n){let a;t.iGM(a=t.CRH())&&(i.searchTerm=a.first)}},decls:20,vars:2,consts:[["class","stdd","previousText","\u2039","nextText","\u203a","firstText","\xab","lastText","\xbb",3,"totalItems","itemsPerPage","maxSize","pageChanged",4,"ngIf"],["type","text","placeholder","Search",1,"stdd","fa-solid","fa-magnifying-glass","w200",3,"keyup.enter"],["search",""],["title","search the text entered",1,"stdd","btn","fa-solid","fa-search",3,"click"],["title","resets search parameters",1,"btn","btn-outline-success","fa","fa-refresh","mx-1",3,"click"],["title","close this page",1,"btn","btn-outline-success","fa","fa-window-close","mx-1",3,"click"],[1,"container"],[1,"stdd","w100","b"],[1,"stdd","w300","b"],[1,"stdd","w75","b"],["class","row",4,"ngFor","ngForOf"],["previousText","\u2039","nextText","\u203a","firstText","\xab","lastText","\xbb",1,"stdd",3,"totalItems","itemsPerPage","maxSize","pageChanged"],[1,"row"],[3,"t","editEvent","deleteEvent","statementOfAccountEvent"]],template:function(n,i){1&n&&(t.TgZ(0,"h4"),t._uU(1,"Chart of Account Listing"),t.qZA(),t.YNc(2,wt,2,3,"pagination",0),t.TgZ(3,"input",1,2),t.NdJ("keyup.enter",function(){return i.onSearch()}),t.qZA(),t.TgZ(5,"button",3),t.NdJ("click",function(){return i.onSearch()}),t._uU(6,"Search"),t.qZA(),t.TgZ(7,"button",4),t.NdJ("click",function(){return i.onReset()}),t.qZA(),t.TgZ(8,"button",5),t.NdJ("click",function(){return i.returnToCaller()}),t.qZA(),t._UZ(9,"hr"),t.TgZ(10,"div",6)(11,"div",7),t._uU(12,"Divn"),t.qZA(),t.TgZ(13,"div",8),t._uU(14,"Account Name"),t.qZA(),t.TgZ(15,"div",9),t._uU(16,"Type"),t.qZA(),t.TgZ(17,"div",7),t._uU(18,"Op Balance"),t.qZA(),t.YNc(19,At,2,1,"div",10),t.qZA()),2&n&&(t.xp6(2),t.Q6J("ngIf",void 0!==i.pagination),t.xp6(17),t.Q6J("ngForOf",i.coas))},dependencies:[s.sg,s.O5,L.Qt,Ct],styles:[".stdd[_ngcontent-%COMP%]{display:inline-block}.w50[_ngcontent-%COMP%]{width:50px}.w75[_ngcontent-%COMP%]{width:75px}.w100[_ngcontent-%COMP%]{width:100px}.w150[_ngcontent-%COMP%]{width:150px}.w300[_ngcontent-%COMP%]{width:300px}.b[_ngcontent-%COMP%]{font-weight:700}.rAlign[_ngcontent-%COMP%]{text-align:right}.fontSmall[_ngcontent-%COMP%]{font-size:small}"]})}return o})();class Zt{constructor(){this.divn="",this.coaId=0,this.accountName="",this.transDate=new Date,this.amount=0,this.sort="transDate",this.pageNumber=1,this.pageSize=10,this.search=""}}function Mt(o,r){1&o&&(t.TgZ(0,"div",7),t._uU(1,"--"),t.qZA())}function Ot(o,r){if(1&o&&(t.TgZ(0,"div",7),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Oqu(e.soaItem.dr.toLocaleString())}}function yt(o,r){1&o&&(t.TgZ(0,"div",7),t._uU(1,"--"),t.qZA())}function Nt(o,r){if(1&o&&(t.TgZ(0,"div",7),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Oqu(e.soaItem.cr.toLocaleString())}}function Ut(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"div",1)(2,"div",2),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.displayVoucher())}),t._uU(3),t.qZA(),t.TgZ(4,"div",3),t._uU(5),t.ALo(6,"date"),t.qZA(),t.TgZ(7,"div",4),t._uU(8),t.qZA(),t.YNc(9,Mt,2,0,"div",5),t.YNc(10,Ot,2,1,"div",5),t.YNc(11,yt,2,0,"div",5),t.YNc(12,Nt,2,1,"div",5),t.TgZ(13,"div",6),t._uU(14),t.qZA()()()}if(2&o){const e=t.oxw();t.xp6(3),t.hij(" ",e.soaItem.voucherNo," "),t.xp6(2),t.Oqu(t.xi3(6,8,e.soaItem.transDate,"dd-MMM-yy")),t.xp6(3),t.Oqu(e.soaItem.accountName),t.xp6(1),t.Q6J("ngIf",0===e.soaItem.dr),t.xp6(1),t.Q6J("ngIf",0!==e.soaItem.dr),t.xp6(1),t.Q6J("ngIf",0===e.soaItem.cr),t.xp6(1),t.Q6J("ngIf",0!==e.soaItem.cr),t.xp6(2),t.Oqu(e.soaItem.narration)}}let Dt=(()=>{class o{constructor(){this.displayVoucherEvent=new t.vpe}displayVoucher(){this.displayVoucherEvent.emit(this.soaItem.voucherNo)}static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-soa-line"]],inputs:{soaItem:"soaItem"},outputs:{displayVoucherEvent:"displayVoucherEvent"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"stdd","row","mb-0"],["title","click to display voucher",1,"stdd","w100","vAlignTop",2,"vertical-align","top",3,"click"],[1,"stdd","w100"],[1,"stdd","w150"],["class","numberStdd w75",4,"ngIf"],[1,"w300",2,"font-size","x-small","margin","0 1px 0 1px","word-wrap","break-word"],[1,"numberStdd","w75"]],template:function(n,i){1&n&&t.YNc(0,Ut,15,11,"div",0),2&n&&t.Q6J("ngIf",null!=i.soaItem)},dependencies:[s.O5,s.uU],styles:[".stdd[_ngcontent-%COMP%]{display:inline-block;margin:0 1px;word-wrap:break-word;font-size:small;vertical-align:top}.numberStdd[_ngcontent-%COMP%]{display:inline-block;margin:0 1px;vertical-align:top;text-align:right;font-size:small}.tAlignRight[_ngcontent-%COMP%]{text-align:right}.fontSmaller[_ngcontent-%COMP%]{font-size:smaller}.vAlignTop[_ngcontent-%COMP%]{vertical-align:top}.w75[_ngcontent-%COMP%]{width:75px}.w100[_ngcontent-%COMP%]{width:100px}.w150[_ngcontent-%COMP%]{width:150px}.w300[_ngcontent-%COMP%]{width:300px}"]})}return o})();const It=["search"];function Et(o,r){1&o&&(t.TgZ(0,"div"),t._uU(1," no data available\n"),t.qZA())}function Pt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"div"),t._uU(1," Extract of transactions of: "),t.TgZ(2,"strong"),t._uU(3),t.qZA(),t._uU(4),t.ALo(5,"date"),t.ALo(6,"date"),t.TgZ(7,"button",2),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.returnToCaller())}),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(3),t.hij(" ",e.soa.accountName," "),t.xp6(1),t.AsE(" for the period between ",t.xi3(5,3,e.soa.fromDate,"dd-MMM-yy")," and ",t.xi3(6,6,e.soa.uptoDate,"dd-MMM-yy")," ")}}function kt(o,r){if(1&o&&(t.TgZ(0,"div",6),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Oqu(e.soa.opBalance)}}function qt(o,r){if(1&o&&(t.TgZ(0,"div",6),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Oqu(e.soa.opBalance)}}function Vt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"app-soa-line",13),t.NdJ("displayVoucherEvent",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.displayVoucherClicked(i))}),t.qZA()()}if(2&o){const e=r.$implicit;t.xp6(1),t.Q6J("soaItem",e)}}function St(o,r){if(1&o&&(t.TgZ(0,"div",3)(1,"label",4),t._uU(2,"Voucher No "),t.qZA(),t.TgZ(3,"label",4),t._uU(4,"Date"),t.qZA(),t.TgZ(5,"label",5),t._uU(6,"Account"),t.qZA(),t.TgZ(7,"label",6),t._uU(8,"Debit"),t.qZA(),t.TgZ(9,"label",7),t._uU(10,"Credit"),t.qZA(),t._UZ(11,"hr"),t.TgZ(12,"div",8),t._uU(13,"Opening Balance"),t.qZA(),t.YNc(14,kt,2,1,"div",9),t.YNc(15,qt,2,1,"div",9),t.YNc(16,Vt,2,1,"div",10),t._UZ(17,"br"),t.TgZ(18,"div",8),t._uU(19,"Overall Total"),t.qZA(),t.TgZ(20,"div",6),t._uU(21),t.qZA(),t.TgZ(22,"div",6),t._uU(23),t.qZA(),t._UZ(24,"br"),t.TgZ(25,"label",11),t._uU(26,"Balance"),t.qZA(),t.TgZ(27,"div",12),t._uU(28),t.qZA()()),2&o){const e=t.oxw();t.xp6(14),t.Q6J("ngIf",e.soa.opBalance>0),t.xp6(1),t.Q6J("ngIf",e.soa.opBalance<=0),t.xp6(1),t.Q6J("ngForOf",e.soa.statementOfAccountItems),t.xp6(5),t.Oqu(e.overallTotalDr.toLocaleString()),t.xp6(2),t.Oqu(e.overallTotalCr.toLocaleString()),t.xp6(5),t.AsE("",e.overallBal.toLocaleString()," ",e.overallBalSuffix,"")}}let Rt=(()=>{class o{constructor(e,n,i,a){this.service=e,this.activatedRoute=n,this.router=i,this.toastr=a,this.routeId="",this.sParams=new Zt,this.totaldr=0,this.totalcr=0,this.thisPeriodSuffix="",this.thisPeriodTotalDr=0,this.thisPeriodTotalCr=0,this.thisPeriodBalance=0,this.thisPeriodDiff=0,this.overallBal=0,this.overallTotalDr=0,this.overallTotalCr=0,this.overallBalSuffix="",this.bolNavigationExtras=!1,this.returnUrl="",this.sortOptions=[{name:"By Account Name Asc",value:"name"},{name:"By Account Name Desc",value:"namedesc"},{name:"By Transaction Date Asc",value:"transdate"},{name:"By Transaction Date Desc",value:"trabsdatedesc"}],this.routeId=this.activatedRoute.snapshot.params.id,null==this.routeId&&(this.routeId="");let c=this.router.getCurrentNavigation();c?.extras&&c.extras.state&&(this.bolNavigationExtras=!0,c.extras.state.returnUrl&&(this.returnUrl=c.extras.state.returnUrl),c.extras.state.userobject&&(this.user=c.extras.state.userobject))}ngOnInit(){this.activatedRoute.data.subscribe(e=>{this.soa=e.soa,null!=this.soa?(this.thisPeriodTotalDr=this.soa.statementOfAccountItems.map(n=>n.dr).reduce((n,i)=>n+i,0),this.thisPeriodTotalCr=this.soa.statementOfAccountItems.map(n=>n.cr).reduce((n,i)=>n+i,0),this.thisPeriodDiff=this.thisPeriodTotalDr-this.thisPeriodTotalCr,this.thisPeriodSuffix=this.thisPeriodBalance>0?" DR":" CR",this.thisPeriodBalance=Math.abs(this.thisPeriodTotalDr-this.thisPeriodTotalCr),this.soa.opBalance>0?(this.overallTotalDr=this.thisPeriodTotalDr+this.soa.opBalance,this.overallTotalCr=this.thisPeriodTotalCr):(this.overallTotalCr=this.thisPeriodTotalCr+this.soa.opBalance,this.overallTotalDr=this.thisPeriodTotalDr),this.overallBal=this.overallTotalDr-this.overallTotalCr,this.overallBalSuffix=this.overallBal>0?" DR":" CR",this.overallBal=Math.abs(this.overallBal)):(this.toastr.warning("No statement of account could be generated agaisnt the inputs"),this.router.navigateByUrl(this.returnUrl))})}returnToCaller(){this.router.navigateByUrl(this.returnUrl||"")}displayVoucherClicked(e){this.router.navigate(["/finance/editfinancewithobject/"+e],{state:{toedit:!1,returnUrl:"/finance/voucherlist"}})}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(N),t.Y36(m.gz),t.Y36(m.F0),t.Y36(v._W))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-soa"]],viewQuery:function(n,i){if(1&n&&t.Gf(It,5),2&n){let a;t.iGM(a=t.CRH())&&(i.searchTerm=a.first)}},decls:4,vars:3,consts:[[4,"ngIf"],["class","container",4,"ngIf"],[1,"btn","stdd","ml-15","fa","fa-2x","fa-undo",3,"click"],[1,"container"],[1,"stdd","w100"],[1,"stdd","w150"],[1,"stdd","w75","tAlignRight"],[1,"stdd","mx-2","w75","tAlignRight"],[1,"opBal"],["class","stdd w75 tAlignRight",4,"ngIf"],[4,"ngFor","ngForOf"],[2,"margin","1px 1px 1px 322px","font-size","small","font-weight","bold","text-align","right"],[1,"stdd","w75","b","tAlignRight"],[3,"soaItem","displayVoucherEvent"]],template:function(n,i){1&n&&(t.YNc(0,Et,2,0,"div",0),t.YNc(1,Pt,8,9,"div",0),t._UZ(2,"br"),t.YNc(3,St,29,7,"div",1)),2&n&&(t.Q6J("ngIf",void 0===i.soa),t.xp6(1),t.Q6J("ngIf",null!=i.soa),t.xp6(2),t.Q6J("ngIf",null!=i.soa))},dependencies:[s.sg,s.O5,Dt,s.uU],styles:["label[_ngcontent-%COMP%]{display:inline-block;font-weight:700;margin:0 1px;font-size:small;word-wrap:break-word}.stdd[_ngcontent-%COMP%]{display:inline-block;margin:0 1px;font-size:small;word-wrap:break-word}.opBal[_ngcontent-%COMP%]{display:inline-block;margin:1px 1px 1px 200px;font-size:small;font-weight:700;word-wrap:break-word;width:150px}.b[_ngcontent-%COMP%]{font-weight:700}.tAlignRight[_ngcontent-%COMP%]{text-align:right}.w75[_ngcontent-%COMP%]{width:75px}.w100[_ngcontent-%COMP%]{width:100px}.w150[_ngcontent-%COMP%]{width:150px}.w200[_ngcontent-%COMP%]{width:200px}.w250[_ngcontent-%COMP%]{width:250px}.w300[_ngcontent-%COMP%]{width:300px}"]})}return o})(),H=(()=>{class o{constructor(e){this.http=e,this.apiUrl=J.N.apiUrl,this.currentUserSource=new R.t(1),this.currentUser$=this.currentUserSource.asObservable(),this.cache=new Map,this.oParams=new x,this.pParams=new x}getDebitApprovalsPending(){var e=this.pParams;const n=this.cache.get(Object.values(e).join("-"));if(n)return(0,u.of)(n);let i=this.populateCOAParams(e);return(0,Y.Tr)(this.apiUrl+"finance/DrApprovalsPending",i,this.http).pipe((0,F.U)(a=>(this.cache.set(Object.values(e).join("-"),a),a)))}updatePaymentReceipts(e){return this.http.put(this.apiUrl+"finance/updatePaymentConfirmation",e)}updateVoucher(e){return this.http.put(this.apiUrl+"finance/voucher",e)}deleteVoucher(e){return this.http.delete(this.apiUrl+"finance/deletevoucher/"+e)}setParams(e){this.oParams=e}getParams(){return this.oParams}addNewVoucher(e){return this.http.post(this.apiUrl+"finance/newvocher",e)}populateCOAParams(e){let n=new _.LE;return e.search&&(n=n.append("search",e.search)),""!==e.accountName&&(n=n.append("coaId",e.accountName)),""!==e.sort&&(n=n.append("sort",e.sort)),0!==e.accountId&&(n=n.append("accountId",e.accountId.toString())),""!==e.accountType&&(n=n.append("accountType",e.accountType)),""!==e.accountClass&&(n=n.append("accountClass",e.accountClass)),n}deleteFromCache(e){this.cache.delete(e),this.pagination.totalItems--}static#t=this.\u0275fac=function(n){return new(n||o)(t.LFG(_.eN))};static#e=this.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var Jt=l(4693);function Yt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"input",9),t.NdJ("ngModelChange",function(i){const c=t.CHM(e).$implicit;return t.KtG(c.drEntryApproved=i)})("click",function(){const a=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.selectedClicked(a))}),t.qZA(),t.TgZ(2,"div",10),t._uU(3),t.qZA(),t.TgZ(4,"div",11),t._uU(5),t.ALo(6,"date"),t.qZA(),t.TgZ(7,"div",12),t._uU(8),t.qZA(),t.TgZ(9,"div",13),t._uU(10),t.qZA()()}if(2&o){const e=r.$implicit;t.xp6(1),t.Q6J("ngModel",e.drEntryApproved),t.xp6(2),t.Oqu(e.voucherNo),t.xp6(2),t.Oqu(t.xi3(6,5,e.voucherDated,"dd-MMM-yy")),t.xp6(3),t.Oqu(e.drAccountName),t.xp6(2),t.Oqu(e.drAmount.toLocaleString())}}function Bt(o,r){if(1&o&&(t.TgZ(0,"div"),t.YNc(1,Yt,11,8,"div",8),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.pending)}}let Lt=(()=>{class o{constructor(e,n,i,a,c,p,D,B){this.service=e,this.toastr=n,this.router=i,this.accountService=a,this.confirmService=c,this.activatedRoute=p,this.fb=D,this.msgService=B,this.pending=[],this.pendingSelected=[],this.totalCount=0,this.bolNavigationExtras=!1,this.returnUrl="",this.pParams=new x,this.drEntryReviewedOn=new Date,this.drEntryApproved=!1,this.form=new d.cw({}),this.bsValueDate=new Date,this.MESSAGE_TYPEID_REQUEST_PAYMENT_CONFIRMATION=24,this.MESSAGE_TYPEID_CONFIRM_PAYMENT_RECEIVED=25,this.MESSAGE_TYPEID_CONFIRM_PAYMENT_NOT_RECEIVED=26,this.MESSAGE_POST_ACTION=5;let Z=this.router.getCurrentNavigation();Z?.extras&&Z.extras.state&&(this.bolNavigationExtras=!0,Z.extras.state.returnUrl&&(this.returnUrl=Z.extras.state.returnUrl),this.accountService.currentUser$.subscribe({next:A=>this.user=A}))}ngOnInit(){this.pParams=new x,this.getPendings()}getPendings(){this.service.setParams(this.pParams),this.service.getDebitApprovalsPending().subscribe({next:e=>{this.pending=e.result,this.pagination=e.pagination,this.totalCount=e.count}})}update(){var e=this.pending.filter(n=>!0===n.selected);console.log("all selected",e),this.pendingSelected.length>0&&this.service.updatePaymentReceipts(this.pendingSelected).subscribe(n=>{n?this.toastr.success("selected payments confirmed as received"):this.toastr.warning("failed to register the payment confirmations")},n=>{this.toastr.error("failed to register the payment confirmations")})}selectedClicked(e){var n=this.pending.findIndex(i=>i.id===e.id);console.log("item:",e,"index:",n),!0===e.drEntryApproved?-1===n&&(e.drEntryApprovedByUsername=this.user.userName,e.drEntryApprovedOn=new Date,this.pendingSelected.push(e)):this.pendingSelected.splice(n,1)}PageChanged(e){const n=this.service.getParams();n.pageNumber!==e.page&&(n.pageNumber=e.page,this.service.setParams(n),this.getPendings())}close(){}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(H),t.Y36(v._W),t.Y36(m.F0),t.Y36(E.B),t.Y36(y.z),t.Y36(m.gz),t.Y36(d.qu),t.Y36(Jt.e))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-confirm-fund-receipt"]],decls:17,vars:2,consts:[["stdd",""],[1,"lbl","w200"],["title","Confirm receipt of funds pending for acceptace",1,"lbl","btn","fa","fa-check","fa-2x","green",2,"margin-left","100px",3,"click"],[1,"container","my-2"],[1,"lbl","w100"],[1,"lbl","w75"],[1,"lbl","w100","hAlignCenter"],[4,"ngIf"],[4,"ngFor","ngForOf"],["type","checkbox",1,"form-check-input","w20","hAlignCenter",2,"margin","0 40px 0 40px","border-color","black",3,"ngModel","ngModelChange","click"],[1,"stdd","w75","hAlignCenter"],[1,"stdd","w100","hAlignCenter"],[1,"stdd","w200"],[1,"stdd","w75","hAlignRight"]],template:function(n,i){1&n&&(t.TgZ(0,"h4",0),t._uU(1,"Transactions pending approval"),t.qZA(),t.TgZ(2,"div",1),t._uU(3),t.qZA(),t.TgZ(4,"button",2),t.NdJ("click",function(){return i.update()}),t.qZA(),t.TgZ(5,"div",3)(6,"label",4),t._uU(7,"Approved"),t.qZA(),t.TgZ(8,"label",5),t._uU(9,"Voucher No"),t.qZA(),t.TgZ(10,"label",6),t._uU(11,"Dated"),t.qZA(),t.TgZ(12,"label",1),t._uU(13,"Account Name"),t.qZA(),t.TgZ(14,"label",5),t._uU(15,"Amount"),t.qZA(),t.YNc(16,Bt,2,1,"div",7),t.qZA()),2&n&&(t.xp6(3),t.hij("Logged in User: ",null==i.user?null:i.user.knownAs,""),t.xp6(13),t.Q6J("ngIf",i.pending))},dependencies:[s.sg,s.O5,d.Wl,d.JJ,d.On,s.uU],styles:[".w20[_ngcontent-%COMP%]{width:20px}.w50[_ngcontent-%COMP%]{width:50px}.w75[_ngcontent-%COMP%]{width:75px}.w100[_ngcontent-%COMP%]{width:100px}.w125[_ngcontent-%COMP%]{width:125px}.w200[_ngcontent-%COMP%]{width:200px}.stdd[_ngcontent-%COMP%]{display:inline-block;margin:0 2px;font-size:small;vertical-align:top}.hAlignCenter[_ngcontent-%COMP%]{text-align:center}.hAlignRight[_ngcontent-%COMP%]{text-align:right}.green[_ngcontent-%COMP%]{color:#006400}.lbl[_ngcontent-%COMP%]{display:inline-block;margin:0 2px;font-size:small;font-weight:700;vertical-align:top}"]})}return o})();class Qt{constructor(){this.id=0,this.voucherId=0,this.attachmentSizeInBytes=0,this.fileName="",this.url="",this.dateUploaded=new Date,this.uploadedByUsername=""}}var Gt=l(138),zt=l(7114);function jt(o,r){1&o&&(t.TgZ(0,"div"),t._uU(1," voucher is not defined\n"),t.qZA())}function Ht(o,r){1&o&&(t.TgZ(0,"div",36),t._uU(1,"Create new finance voucher"),t.qZA())}function Kt(o,r){1&o&&(t.TgZ(0,"div",36),t._uU(1," Edit finance voucher"),t.qZA())}function Wt(o,r){if(1&o&&t._UZ(0,"ng-select",37),2&o){const e=t.oxw(2);t.Q6J("items",e.coas)}}function Xt(o,r){1&o&&(t.TgZ(0,"div",38),t._uU(1,'total mismatch" '),t.qZA())}function $t(o,r){if(1&o&&t._UZ(0,"ng-select",54),2&o){const e=t.oxw(3);t.Q6J("items",e.coas)}}const K=function(){return{dateInputFormat:"YYYY-MM-DD"}};function te(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"div",39),t._UZ(1,"hr",40),t.TgZ(2,"div",41),t._UZ(3,"input",42),t.YNc(4,$t,1,1,"ng-select",43),t.TgZ(5,"input",44),t.NdJ("change",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.recalculateTotal())}),t.qZA(),t.TgZ(6,"input",45),t.NdJ("change",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.recalculateTotal())}),t.qZA(),t._UZ(7,"input",46),t.TgZ(8,"button",47),t.NdJ("click",function(){const a=t.CHM(e).index,c=t.oxw(2);return t.KtG(c.removeVoucherEntry(a))}),t.qZA(),t.TgZ(9,"label",48),t._uU(10,"Approved:"),t.qZA(),t._UZ(11,"input",49),t.TgZ(12,"label",50),t._uU(13,"By:"),t.qZA(),t._UZ(14,"input",51),t.TgZ(15,"label",52),t._uU(16,"On:"),t.qZA(),t._UZ(17,"input",53),t.qZA()()}if(2&o){const e=r.index,n=t.oxw(2);t.xp6(2),t.Q6J("formGroupName",e),t.xp6(1),t.Q6J("bsValue",n.bsValueDate)("bsConfig",t.DdM(6,K)),t.xp6(1),t.Q6J("ngIf",n.coas),t.xp6(13),t.Q6J("bsValue",n.bsValueDate)("bsConfig",t.DdM(7,K))}}function ee(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"div",41),t._UZ(1,"input",55),t.TgZ(2,"button",56),t.NdJ("click",function(){const a=t.CHM(e).index,c=t.oxw(2);return t.KtG(c.download(a))}),t.qZA(),t.TgZ(3,"button",57),t.NdJ("click",function(){const a=t.CHM(e).index,c=t.oxw(2);return t.KtG(c.removeVoucherAttachment(a))}),t.qZA()()}2&o&&t.Q6J("formGroupName",r.index)}const ne=function(){return{adaptivePosition:!0,dateInputFormat:"YYYY-MM-DD"}};function ie(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"form",3)(1,"div",4),t.YNc(2,Ht,2,0,"div",5),t.YNc(3,Kt,2,0,"div",5),t._UZ(4,"br"),t.TgZ(5,"label",6),t._uU(6,"Voucher No.:"),t.qZA(),t._UZ(7,"app-text-input",7)(8,"br"),t.TgZ(9,"label",6),t._uU(10,"Dated:"),t.qZA(),t._UZ(11,"input",8,9)(13,"br",10),t.TgZ(14,"label",11),t._uU(15,"Account:"),t.TgZ(16,"b"),t._uU(17,"CR"),t.qZA()(),t.YNc(18,Wt,1,1,"ng-select",12),t.TgZ(19,"div",13),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.addNewCOA())}),t.qZA(),t._UZ(20,"br"),t.TgZ(21,"label",6),t._uU(22,"Divn:"),t.qZA(),t._UZ(23,"app-text-input",14)(24,"br",10),t.TgZ(25,"label",6),t._uU(26,"Narration:"),t.qZA(),t._UZ(27,"textarea",15)(28,"br",10),t.TgZ(29,"label",6),t._uU(30,"Amount:"),t.qZA(),t.TgZ(31,"input",16),t.NdJ("change",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.updateVoucherAmount())}),t.qZA(),t.YNc(32,Xt,2,0,"div",17),t.qZA(),t.TgZ(33,"div",18)(34,"div",19)(35,"div",20),t._uU(36,"Totals:"),t.qZA(),t.TgZ(37,"div",21),t._uU(38),t.qZA(),t.TgZ(39,"div",22),t._uU(40),t.qZA(),t.TgZ(41,"div",23),t._uU(42),t.qZA(),t.TgZ(43,"button",24),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.uploadFileAndFormData())}),t.qZA(),t.TgZ(44,"button",25),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.returnToCaller())}),t.qZA(),t.TgZ(45,"button",26),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.deleteVoucher())}),t.qZA()(),t._UZ(46,"br"),t.TgZ(47,"label",27),t._uU(48,"Date"),t.qZA(),t.TgZ(49,"label",28),t._uU(50,"Account"),t.qZA(),t.TgZ(51,"label",29),t._uU(52,"Debit"),t.qZA(),t.TgZ(53,"label",29),t._uU(54,"Credit"),t.qZA(),t.TgZ(55,"label",30),t._uU(56,"Narration"),t.qZA(),t.TgZ(57,"button",31),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.addVoucherEntry())}),t.qZA(),t._UZ(58,"br"),t.TgZ(59,"div",32),t.YNc(60,te,18,8,"div",33),t.qZA(),t._UZ(61,"br")(62,"hr"),t.TgZ(63,"div",34),t.YNc(64,ee,4,1,"div",35),t.qZA(),t._UZ(65,"hr"),t.qZA()()}if(2&o){const e=t.oxw();t.Q6J("formGroup",e.form),t.xp6(2),t.Q6J("ngIf",0===e.voucher.id),t.xp6(1),t.Q6J("ngIf",e.voucher.id>0),t.xp6(4),t.Q6J("label","Voucher No"),t.xp6(4),t.Q6J("minDate",e.minTransDate)("maxDate",e.maxTransDate)("bsValue",e.bsValue)("bsConfig",t.DdM(17,ne)),t.xp6(7),t.Q6J("ngIf",e.coas),t.xp6(5),t.Q6J("label","Division"),t.xp6(9),t.Q6J("ngIf",0!==e.voucherAmount&&(0!==e.iDiff||e.voucherAmount!==e.totalAmountDR)),t.xp6(6),t.Oqu(e.totalAmountDR),t.xp6(2),t.Oqu(e.totalAmountCR),t.xp6(2),t.hij("Balance: ",e.diff,""),t.xp6(1),t.Q6J("disabled",!e.form.dirty||0!==e.voucherAmount&&(0!==e.iDiff||e.voucherAmount!==e.totalAmountDR)),t.xp6(17),t.Q6J("ngForOf",e.voucherEntries.controls),t.xp6(4),t.Q6J("ngForOf",e.voucherAttachments.controls)}}let oe=(()=>{class o{constructor(e,n,i,a,c,p,D,B,Z){this.service=e,this.coaService=n,this.fileService=i,this.activatedRoute=a,this.router=c,this.toastr=p,this.fb=D,this.modalService=B,this.confirmService=Z,this.onUploadFinished=new t.vpe,this.entries=[],this.coas=[],this.emps=[],this.selectedAccountId=0,this.bsRangeValue=new Date,this.maxDate=new Date,this.minDate=new Date,this.bsValueDate=new Date,this.minTransDate=new Date,this.maxTransDate=new Date,this.returnUrl="",this.routeId="",this.routeResumeId="",this.isAddMode=!1,this.isEditable=!1,this.loading=!1,this.submitted=!1,this.bolNavigationExtras=!1,this.totalAmountDR=0,this.totalAmountCR=0,this.voucherAmount=0,this.diff="",this.iDiff=0,this.form=new d.cw({}),this.suggestedDefaultCoaIdDR=0,this.suggestedDefaultCoaIdCR=0,this.suggestedDefaultAmountDR=0,this.suggestedDefaultAmountCR=0,this.attachmentid=0,this.fileAttachments=[],this.voucherFiles=[],this.progress=0,this.message="",this.isMultipleUploaded=!1,this.isSingleUploaded=!1,this.urlAfterUpload="",this.percentUploaded=[0],this.lastTimeCalled=Date.now(),this.uploadFileAndFormData=()=>{if(this.form.invalid)return void this.toastr.warning("Invalid form");var q=Date.now();if(q<this.lastTimeCalled+28e3)return void console.log("repeat call dialowed at",q," last time called at",this.lastTimeCalled);this.lastTimeCalled=Date.now();const M=new FormData;0===this.voucher.id?(M.append("data",JSON.stringify(this.form.value)),this.service.insertVoucherWithUploads(M).subscribe({next:f=>{f.type===_.dt.UploadProgress?this.progress=Math.round(100*f.loaded/f.total):f.type===_.dt.Response&&(this.message="Upload success.",console.log("event",f),this.form.get("voucherNo")?.setValue(f.body.returnInt),this.returnToCaller(),this.toastr.success("the Voucher is created, and assigned Voucher No. "+f.body.returnInt))},error:f=>console.log(f)})):(M.append("data",JSON.stringify(this.form.value)),this.service.updateWithFiles(M).subscribe({next:f=>{f.type===_.dt.UploadProgress?this.progress=Math.round(100*f.loaded/f.total):f.type===_.dt.Response&&(this.message="Upload success.",this.toastr.success("Voucher Updated and Files uploaded"),this.onUploadFinished.emit(f.body))},error:f=>console.log(f)}))},this.uploadFinished=A=>{this.response=A},this.downloadFile=(A,q)=>{const M=new Blob([A.body],{type:A.body?.type}),b=document.createElement("a");b.setAttribute("style","display:none;"),document.body.appendChild(b),b.download=q,b.href=URL.createObjectURL(M),b.target="_blank",b.click(),document.body.removeChild(b)},this.routeId=this.activatedRoute.snapshot.params.id,null==this.routeId&&(this.routeId=""),""===this.routeId&&(this.isAddMode=!0);let w=this.router.getCurrentNavigation();w?.extras&&w.extras.state&&(this.bolNavigationExtras=!0,w.extras.state.userObject&&(this.user=w.extras.state.userObject),w.extras.state.returnUrl&&(this.returnUrl=w.extras.state.returnUrl),this.isEditable=w.extras.state.toedit||this.isAddMode),this.minDate.setDate(this.minDate.getDate()-365),this.maxDate.setDate(this.maxDate.getDate()+365),this.minTransDate.setDate(this.minTransDate.getDate()-365)}ngOnInit(){this.activatedRoute.data.subscribe(e=>{this.coas=e.coas,this.voucher=e.voucher}),null!=this.voucher&&(this.createForm(this.voucher),this.recalculateTotal())}createForm(e){this.form=this.fb.group({id:e.id,divn:[e.divn,d.kI.maxLength(1)],voucherNo:[e.voucherNo,d.kI.required],voucherDated:[e.voucherDated,d.kI.required],cOAId:[e.cOAId,d.kI.required],amount:[e.amount,[d.kI.required,d.kI.min(1)]],totalAmountDR:[this.totalAmountDR,this.matchValues("amount")],narration:e.narration,username:e.username,voucherEntries:this.fb.array(e.voucherEntries.map(n=>this.fb.group({id:n.id,financeVoucherId:n.voucherId,cOAId:n.cOAId,accountName:n.accountName,transDate:n.transDate,dr:n.dr,cr:n.cr,narration:n.narration,drEntryApproved:n.drEntryApproved,drEntryApprovedOn:n.drEntryApprovedOn,drEntryApprovedByUsername:n.drEntryApprovedByUsername}))),voucherAttachments:this.fb.array(e.voucherAttachments.map(n=>this.fb.group({id:n.id,voucherId:n.voucherId,fileName:n.fileName,url:n.url,uploadedByUsername:n.uploadedByUsername,dateUploaded:n.dateUploaded,attachmentSizeInBytes:n.attachmentSizeInBytes})))})}matchValues(e){return n=>n.value===n.parent?.get(e)?.value?null:{isMatching:!0}}get voucherEntries(){return this.form.get("voucherEntries")}addVoucherEntry(){0==this.voucherEntries.length?(this.setDefaultEntryValues(),this.voucherEntries.push(this.newDRVoucherEntry()),this.voucherEntries.push(this.newCRVoucherEntry())):(this.iDiff=this.totalAmountDR-this.totalAmountCR,this.iDiff<0?(this.suggestedDefaultAmountDR=Math.abs(this.iDiff),this.voucherEntries.push(this.newDRVoucherEntry())):(this.suggestedDefaultAmountCR=Math.abs(this.iDiff),this.suggestedDefaultCoaIdCR=this.form.controls.coa.value,this.voucherEntries.push(this.newCRVoucherEntry()))),this.recalculateTotal()}newDRVoucherEntry(){return this.fb.group({id:0,financeVoucherId:void 0===this.voucher?.id?0:this.voucher.id,transDate:new Date,cOAId:this.suggestedDefaultCoaIdDR,accountName:"",dr:this.suggestedDefaultAmountDR,cr:0,narration:"",drEntryApproved:!1,drEntryApprovedOn:new Date,drEntryApprovedByUsername:this.user?.userName})}newCRVoucherEntry(){var e=this.form.controls.cOAId.value;return this.fb.group({id:0,financeVoucherId:void 0===this.voucher?.id?0:this.voucher.id,transDate:new Date,cOAId:e??this.suggestedDefaultCoaIdCR,accountName:"",cr:this.suggestedDefaultAmountCR,dr:0,narration:"",drEntryApproved:!1,drEntryApprovedOn:new Date,drEntryApprovedByUsername:this.user?.userName})}removeVoucherEntry(e){this.voucherEntries.removeAt(e),this.voucherEntries.markAsDirty(),this.voucherEntries.markAsTouched()}newVoucherAttachment(){return this.fb.group({id:0,voucherId:this.voucher?.id??0,fileName:["",d.kI.required],url:[{value:"",disabled:!0}],attachmentSizInBytes:0,dateUploaded:new Date,uploadedByEmployeeId:0})}addVoucherAttachmnt(){this.voucherAttachments.push(this.newVoucherAttachment())}removeVoucherAttachment(e){this.voucherAttachments.removeAt(e),this.voucherAttachments.markAsDirty(),this.voucherAttachments.markAsTouched()}get voucherAttachments(){return this.form.get("voucherAttachments")}recalculateTotal(){this.totalAmountDR=+this.voucherEntries.value.map(n=>n.dr).reduce((n,i)=>n+i,0),this.totalAmountCR=+this.voucherEntries.value.map(n=>n.cr).reduce((n,i)=>n+i,0);var e=this.totalAmountDR-this.totalAmountCR;this.diff=Math.abs(e).toString(),this.diff+=e>0?" DR":" CR",this.iDiff=Math.abs(e)}updateVoucherAmount(){this.voucherAmount=this.form.controls.amount.value}setDefaultEntryValues(){var e=this.form.controls.cOAId.value,n=+this.form.controls.amount.value,i=this.coas.filter(a=>a.id==e).map(a=>a.accountClass);switch(this.suggestedDefaultAmountCR=n,this.suggestedDefaultAmountDR=n,i[0]){case"exp":this.suggestedDefaultCoaIdCR=this.suggestedDefaultAmountCR>5e3?14:2,this.suggestedDefaultCoaIdDR=e;break;case"salary":case"businessvisit":this.suggestedDefaultCoaIdDR=e,this.suggestedDefaultCoaIdCR=14;break;case"candidate":this.suggestedDefaultCoaIdDR=e,this.suggestedDefaultCoaIdCR=20}}deleteVoucher(){const e=this.service.deleteVoucher(this.voucher.id);this.confirmService.confirm("confirm Delete","Are you sure you want to delete this Voucher, along with all its contents?").pipe((0,O.h)(i=>i),(0,h.w)(()=>e)).subscribe(i=>{i?this.toastr.success("Voucher deleted","deletion successful"):this.toastr.error("Error in deleting the checklist","failed to delete")})}returnToCaller(){this.router.navigateByUrl(this.returnUrl||"")}addNewCOA(){var e=new Q;this.bsModalRef=this.modalService.show(z,{class:"modal-dialog-centered modal-lg",initialState:{title:"add a new Chart Of Account",coa:e}}),this.bsModalRef.content.editCOAEvent.pipe((0,h.w)(i=>this.coaService.addNewCOA(i).pipe((0,C.K)(a=>(console.log("Error for coaService.AddNewCOA",a),(0,u.of)())))),(0,C.K)(i=>(0,u.of)())).subscribe(i=>{this.coas.push(i)})}onFileInputChange(e,n){const c=e.target.files[0];var p=new Qt;p.voucherId=n??0,p.fileName=c.name,p.attachmentSizeInBytes=Math.round(c.size/1024),p.dateUploaded=new Date,this.fileAttachments.push(p),this.voucherFiles.push(c);var D=this.fb.group({voucherId:this.voucher?.id??0,fileName:c.name,attachmentSizeInBytes:Math.round(c.size/1024)});this.voucherAttachments.push(D)}download(e){if(this.attachmentid=this.voucherAttachments.at(e).get("id")?.value,0!==this.attachmentid){var n=this.voucherAttachments.at(e).get("fileName")?.value;this.fileService.download(this.attachmentid).subscribe(i=>{i.type===_.dt.DownloadProgress?this.progress=Math.round(100*i.loaded/i.total):i.type===_.dt.Response&&(this.message="download success",this.downloadFile(i,n))})}}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(P),t.Y36(N),t.Y36(Gt.I),t.Y36(m.gz),t.Y36(m.F0),t.Y36(v._W),t.Y36(d.qu),t.Y36(U.tT),t.Y36(y.z))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-voucher-edit"]],outputs:{onUploadFinished:"onUploadFinished"},decls:5,vars:5,consts:[[4,"ngIf"],["autocomplete","off",3,"formGroup",4,"ngIf"],[2,"vertical-align","bottom","font-size","smaller"],["autocomplete","off",3,"formGroup"],[1,"stdd","col-3",2,"vertical-align","top","border-style","inset"],["class","b my-2",4,"ngIf"],[1,"stdd","w100",2,"margin-top","2px"],["formControlName","voucherNo",1,"stdd","w100",3,"label"],["type","text","placeholder","Voucher dated","formControlName","voucherDated","bsDatepicker","","autocomplete","off",1,"stdd","w150",3,"minDate","maxDate","bsValue","bsConfig"],["dp","bsDatepicker"],[1,"my-2"],[1,"lbl","w100",2,"margin-top","2px"],["class","stdd w250","bindLabel","accountName","bindValue","id","labelForId","cOAId","placeholder","Select Account","clearAllText","Clear","formControlName","cOAId",3,"items",4,"ngIf"],["disabled","isAddMode",1,"stdd","w30","fa","fa-plus",3,"click"],["formControlName","divn",1,"stdd","w100",3,"label"],["formControlName","narration","cols","30","rows","3"],["type","number","formControlName","amount",1,"stdd","w100",3,"change"],["class","stdd red",4,"ngIf"],[1,"stdd","col-8",2,"vertical-align","top","margin-left","5px"],[2,"padding-bottom","3px"],[1,"stdd","b",2,"margin-left","350px"],[1,"stdd","w75",2,"text-align","right"],[1,"stdd","w75","mx-2",2,"text-align","right"],[1,"stdd","w150",2,"text-align","right"],[1,"stdd","mx-1","fa","fa-save","green",2,"margin-left","10px !important",3,"disabled","click"],["title","return",1,"btn","btn-secondary","fa","fa-window-close",3,"click"],["disabled","voucher.Id===0",1,"stdd","fa","fa-trash","red","pull-right",3,"click"],[1,"stdd","w90","b"],[1,"stdd","w300","b"],[1,"stdd","w75","b"],[1,"stdd","w200","b"],["title","add a new voucher entry",1,"mx-1","blue","fa","fa-plus",3,"click"],["formArrayName","voucherEntries",1,"my-1","px-0","smallFont","height10px"],[";","",4,"ngFor","ngForOf"],["formArrayName","voucherAttachments",1,"my-1","px-0"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"b","my-2"],["bindLabel","accountName","bindValue","id","labelForId","cOAId","placeholder","Select Account","clearAllText","Clear","formControlName","cOAId",1,"stdd","w250",3,"items"],[1,"stdd","red"],[";",""],[1,"my=0"],[3,"formGroupName"],["type","text","placeholder","Date","formControlName","transDate","bsDatepicker","",1,"stdd","w90",2,"font-size","x-small",3,"bsValue","bsConfig"],["class","stdd w300","style","font-size: x-small;","bindLabel","accountName","bindValue","id","labelForId","cOAId","placeholder","Select Account","clearAllText","Clear","formControlName","cOAId",3,"items",4,"ngIf"],["type","number","formControlName","dr",1,"stdd","w75","tAlignRight",3,"change"],["type","number","formControlName","cr",1,"stdd","w75","tAlignRight",3,"change"],["type","text","formControlName","narration",1,"stdd","w300"],[1,"stdd","red","ml-2","fa","fa-trash",3,"click"],[1,"stdd2","w75",2,"margin-left","400px"],["type","checkbox","formControlName","drEntryApproved",1,"stdd2","form-check-input",2,"border-color","black"],[1,"stdd2","w50","mx-2"],["type","text","formControlName","drEntryApprovedByUsername",1,"stdd2","w100"],[1,"stdd2","w100","mx-5"],["type","text","placeholder","Date","formControlName","drEntryApprovedOn","bsDatepicker","",1,"stdd2","w100",3,"bsValue","bsConfig"],["bindLabel","accountName","bindValue","id","labelForId","cOAId","placeholder","Select Account","clearAllText","Clear","formControlName","cOAId",1,"stdd","w300",2,"font-size","x-small",3,"items"],["formControlName","fileName",1,"stdd","w300"],[1,"stdd","mx-3","fa","fa-download",3,"click"],[1,"stdd","red","fa-trash",3,"click"]],template:function(n,i){1&n&&(t.YNc(0,jt,2,0,"div",0),t.YNc(1,ie,66,18,"form",1),t.TgZ(2,"div",2),t._uU(3),t.ALo(4,"json"),t.qZA()),2&n&&(t.Q6J("ngIf",null==i.voucher),t.xp6(1),t.Q6J("ngIf",i.voucher),t.xp6(2),t.hij(" ",t.lcZ(4,3,i.form.value),"\n"))},dependencies:[s.sg,s.O5,k.Np,k.Y5,d._Y,d.Fj,d.wV,d.Wl,d.JJ,d.JL,d.sg,d.u,d.x0,d.CE,G.w9,zt.t,s.Ts],styles:[".stdd[_ngcontent-%COMP%]{display:inline-block;margin:0 1px;vertical-align:top}.stdd2[_ngcontent-%COMP%]{display:inline-block;margin:0 1px;font-size:x-small;color:gray;vertical-align:top}label[_ngcontent-%COMP%]{font-weight:700;padding-bottom:0;vertical-align:top}.tAlignRight[_ngcontent-%COMP%]{text-align:right}.b[_ngcontent-%COMP%]{font-weight:700}.w60[_ngcontent-%COMP%]{width:60px}.w75[_ngcontent-%COMP%]{width:75px}.w90[_ngcontent-%COMP%]{width:90px}.w100[_ngcontent-%COMP%]{width:100px}.w125[_ngcontent-%COMP%]{width:125px}.w150[_ngcontent-%COMP%]{width:150px}.w175[_ngcontent-%COMP%]{width:175px}.w200[_ngcontent-%COMP%]{width:200px}.w250[_ngcontent-%COMP%]{width:250px}.w300[_ngcontent-%COMP%]{width:300px}input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{appearance:none;margin:0}.footer[_ngcontent-%COMP%]{position:relative;vertical-align:bottom}.displaynone[_ngcontent-%COMP%]{display:none}.fontSmall[_ngcontent-%COMP%]{font-size:small}.height10px[_ngcontent-%COMP%]{height:10px}input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.geeen[_ngcontent-%COMP%]{color:green}.red[_ngcontent-%COMP%]{color:red}"]})}return o})();class ae{constructor(){this.partyName="",this.id=0,this.divn="",this.cOAId=0,this.accountName="",this.voucherNo=0,this.voucherDated=new Date,this.username="",this.reviewedByUsername="",this.reviewedOn=new Date,this.amount=0,this.narration="",this.voucherEntries=[],this.voucherAttachments=[]}}const se=[{path:"",component:S,data:{breadcrumb:"Finances"}},{path:"voucherlist",component:ot},{path:"voucherEdit/:id",component:oe,resolve:{voucher:o=>{var r=o.paramMap.get("id");return""===r||null==r?(0,u.of)(null):"0"===r?(0,u.of)(new ae):(0,t.f3M)(P).getVoucherFromId(+r)},coas:()=>(0,t.f3M)(N).getCoaList()}},{path:"coalist",component:bt,data:{breadcrumb:{alias:"Chart of Account"}}},{path:"soa/:id/:fromDate/:uptoDate",resolve:{soa:o=>{var r=o.paramMap.get("id");if(""===r)return(0,u.of)(void 0);var e=o.paramMap.get("fromDate")||void 0,n=o.paramMap.get("uptoDate");if(""===e||""===n)return(0,u.of)(void 0);var i=new Date(e),a=new Date(n);return void 0!==i&&void 0!==a?(0,t.f3M)(P).getStatementOfAccount(+r,i.toDateString(),a.toDateString()):(0,u.of)(void 0)}},component:Rt,data:{breakcrumb:{alias:"statement of account"}}},{path:"receiptspendingconfirmation",resolve:{confirmationsPending:()=>(new x,(0,t.f3M)(H).getDebitApprovalsPending())},component:Lt}];let re=(()=>{class o{static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275mod=t.oAB({type:o});static#n=this.\u0275inj=t.cJS({imports:[s.ez,m.Bz.forChild(se),m.Bz]})}return o})();var ce=l(3983);let le=(()=>{class o{static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275mod=t.oAB({type:o});static#n=this.\u0275inj=t.cJS({imports:[s.ez,re,ce.m]})}return o})()}}]);