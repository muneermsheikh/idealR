"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[407],{6407:(Ee,E,u)=>{u.r(E),u.d(E,{DeploymentModule:()=>qe});var g=u(6814),R=u(3983),e=u(5879);class N{constructor(){this.cvRefId=0,this.orderItemId=0,this.candidateId=0,this.orderNo=0,this.customerId=0,this.status="",this.applicationNo=0,this.candidateName="",this.categoryName="",this.customerName="",this.selectedOn=new Date,this.search="",this.pageNumber=1,this.pageSize=15}}var l=u(6223),b=u(2051),f=u(8763),v=u(7411),J=u(7328),C=u(2096),y=u(7398),q=u(9862),V=u(5516),w=u(1436);class A{constructor(){this.dateOfFlight=new Date,this.airineName="",this.flightNo="",this.airportOfBoarding="",this.orderNo=0,this.orderItemId=0,this.search="",this.pageNumber=1,this.pageSize=20}}let h=(()=>{class o{getDeployStatusOfASequence(t){return this.deployStatuses.filter(n=>n.Sequence===t).map(n=>n.StatusName)[0]}constructor(t){this.http=t,this.apiUrl=V.N.apiUrl,this.currentUserSource=new J.t(1),this.currentUser$=this.currentUserSource.asObservable(),this.deployStages=[],this.depSeqAndNames=[],this.deploys=[],this.cache=new Map,this.fCache=new Map,this.dParams=new N,this.candFlightParams=new A,this.deployments=[],this.deployStatuses=[{StatusName:"Selected",Sequence:100,NextSequence:300,WorkingDaysReqdForNextStage:0},{StatusName:"Document Certification Initiated",Sequence:200,NextSequence:300,WorkingDaysReqdForNextStage:60},{StatusName:"Refer for Medical Tests",Sequence:300,NextSequence:400,WorkingDaysReqdForNextStage:5},{StatusName:"Medically Fit",Sequence:400,NextSequence:600,WorkingDaysReqdForNextStage:3},{StatusName:"Medically Unfit",Sequence:500,NextSequence:5e3,WorkingDaysReqdForNextStage:0},{StatusName:"Visa Documents submitted",Sequence:600,NextSequence:700,WorkingDaysReqdForNextStage:5},{StatusName:"Visa Issued",Sequence:700,NextSequence:900,WorkingDaysReqdForNextStage:6},{StatusName:"Visa Rejected",Sequence:800,NextSequence:5e3,WorkingDaysReqdForNextStage:0},{StatusName:"Emigration application lodged",Sequence:900,NextSequence:1e3,WorkingDaysReqdForNextStage:2},{StatusName:"Emigration Documents lodged",Sequence:1e3,NextSequence:1100,WorkingDaysReqdForNextStage:2},{StatusName:"Emigration Cleared",Sequence:1100,NextSequence:1300,WorkingDaysReqdForNextStage:5},{StatusName:"Emigration Denied",Sequence:1200,NextSequence:5e3,WorkingDaysReqdForNextStage:0},{StatusName:"Ticket booked",Sequence:1300,NextSequence:1500,WorkingDaysReqdForNextStage:0},{StatusName:"Only Processing - Documents couriered to candidate",Sequence:1400,NextSequence:5e3,WorkingDaysReqdForNextStage:0},{StatusName:"Traveled",Sequence:1500,NextSequence:5e3,WorkingDaysReqdForNextStage:0},{StatusName:"Arrival Acknowledged by Client",Sequence:1600,NextSequence:5e3,WorkingDaysReqdForNextStage:0},{StatusName:"Concluded",Sequence:5e3,NextSequence:0,WorkingDaysReqdForNextStage:0}]}setParams(t){this.dParams=t}getParams(){return this.dParams}getFlightParams(){return this.candFlightParams}setFlightParams(t){this.candFlightParams=t}getCandidateFlightHeadersPagedList(t){const n=this.cache.get(Object.values(t).join("-"));if(n)return(0,C.of)(n);let i=(0,w.y0)(t);return(0,w.Tr)(this.apiUrl+"Deployment/CandidateFlights",i,this.http).pipe((0,y.U)(a=>(this.cache.set(Object.values(t).join("-"),a),a)))}getCandidateFlightCandidates(t){return this.http.get(this.apiUrl+"Deployment/CandidateFlightItems/"+t)}getDeploymentPagedList(t){const n=this.cache.get(Object.values(t).join("-"));if(n)return(0,C.of)(n);let i=(0,w.E2)(t);return(0,w.Tr)(this.apiUrl+"Deployment/deployments",i,this.http).pipe((0,y.U)(a=>(this.cache.set(Object.values(t).join("-"),a),a)))}getDepStatusAndNames(){return this.depSeqAndNames.length>0?(0,C.of)(this.depSeqAndNames):this.http.get(this.apiUrl+"Deployment/deployStatusSeqAndNames").pipe((0,y.U)(t=>(this.depSeqAndNames=t,t)))}getDeployStatuses(){return this.deployStages.length>0?(0,C.of)(this.deployStages):this.http.get(this.apiUrl+"Deployment/deployStatusData").pipe((0,y.U)(t=>(this.deployStages=t,t)))}getDeploymentWithItems(t){return this.http.get(this.apiUrl+"Deployment/deployment/"+t)}updateDeployment(t){return this.http.put(this.apiUrl+"Deployment/deployment",t)}updateDeploymentItem(t){return this.http.put(this.apiUrl+"Deployment/depItem",t)}uploadAttachmentForItem(t){return this.http.post(this.apiUrl+"FileUpload/uploadDepAttachment",t)}insertDepItemsWithTravelBooked(t){return this.http.post(this.apiUrl+"Deployment/insertItemsWithFlight",t)}insertDepItemsWithFlightAttachment(t){return this.http.put(this.apiUrl+"FileUpload/insertItemsWithFlightAttachment",t)}composeTravelAdviseForClient(t){return console.log("fightid",t),this.http.get(this.apiUrl+"Deployment/traveladvise/"+t)}getFlightData(){return this.http.get(this.apiUrl+"Deployment/flightdata")}getCandidateFlightFromId(t){return this.http.get(this.apiUrl+"Deployment/candidateFlightGrp/"+t)}getCandidateFlightIds(t){return this.http.put(this.apiUrl+"Deployment/candidateflightids",{cvrefids:t})}deleteCandidateFlight(t){return this.http.delete(this.apiUrl+"Deployment/CandidateFlight/"+t)}editCandidateFlight(t){return this.http.put(this.apiUrl+"Deployment/CandidateFlight",t)}deleteFlightCandidate(t){return this.http.delete(this.apiUrl+"Deployment/FlightCandidate/"+t)}InsertDepItems(t){return this.http.post(this.apiUrl+"Deployment/depItems",t)}InsertDepItemsAndCandFlights(t){return this.http.post(this.apiUrl+"Deployment/depItemsAndCandFlight",t)}getCVReferredDto(t){return this.http.get(this.apiUrl+"Deployment/bycvrefid/"+t)}getNextDepItemFromCVRefId(t){return this.http.get(this.apiUrl+"Deployment/nextDepItemFromCVRef/"+t)}getNextSequence(t,n){return 700===t?n?1300:900:this.deployStages.find(i=>i.sequence==t)?.nextSequence}NextSequenceProposedIsOkay(t,n,i){var a=this.getNextSequence(t,i);if(n===a)return!0;var s=this.deployStages.find(d=>d.sequence===n);return!(!s?.isOptional||n-t!=200)}getDepStage(t){return this.deployStages.length>0?this.deployStages.filter(n=>n.sequence==t)[0]:null}getNextStage(t,n){if(this.deployStages.length>0){var i=this.getNextSequence(t,n);return this.deployStages.filter(a=>a.sequence===i)[0]}return null}getNextStageDate(t){var n=this.deployStages.find(i=>i.id==t)?.workingDaysReqdForNextStage;return void 0!==n?new Date((new Date).setDate((new Date).getDate()+n)):new Date}deleteDeployment(t){return this.http.delete(this.apiUrl+"Deployment/dep/"+t)}downloadAttachment(t){let n=new q.LE;return n=n.append("fullpath",t),this.http.get(this.apiUrl+"FileUpload/downloadfile",{params:n,responseType:"blob"})}deleteAttachment(t){let n=new q.LE;return n=n.append("fullpath",t),this.http.get(this.apiUrl+"FileUpload/deleteattachmentbyfullpath",{params:n})}static#e=this.\u0275fac=function(n){return new(n||o)(e.LFG(q.eN))};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var m=u(7133),_=u(3593),T=u(4807);function L(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"div",3)(1,"h4"),e._uU(2,"Edit Deployment records"),e.qZA(),e.TgZ(3,"button",4),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.updateDeployment())}),e.qZA(),e.TgZ(4,"button",5),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.close())}),e.qZA()()}}const I=function(){return{dateInputFormat:"YYYY-MM-DD"}};function Q(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"div",21),e._UZ(2,"input",22)(3,"ng-select",23)(4,"ng-select",24)(5,"input",25)(6,"input",26),e.TgZ(7,"button",27),e.NdJ("click",function(){const a=e.CHM(t).index,s=e.oxw(2);return e.KtG(s.download(a))}),e.qZA(),e.TgZ(8,"button",28),e.NdJ("click",function(){const a=e.CHM(t).index,s=e.oxw(2);return e.KtG(s.removeDepItem(a))}),e.qZA()()()}if(2&o){const t=c.index,n=e.oxw(2);e.xp6(1),e.Q6J("formGroupName",t),e.xp6(1),e.Q6J("bsValue",n.bsValueDate)("bsConfig",e.DdM(7,I)),e.xp6(1),e.Q6J("items",n.depStatusAndNames),e.xp6(1),e.Q6J("items",n.depStatusAndNames),e.xp6(1),e.Q6J("bsValue",n.bsValueDate)("bsConfig",e.DdM(8,I))}}function Y(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"div",6)(1,"form",7)(2,"label",8),e._uU(3,"Candidate:"),e.qZA(),e.TgZ(4,"div",9),e._uU(5),e.qZA(),e.TgZ(6,"label",10),e._uU(7,"Customer:"),e.qZA(),e.TgZ(8,"div",9),e._uU(9),e.qZA(),e._UZ(10,"br"),e.TgZ(11,"label",10),e._uU(12,"Category Ref"),e.qZA(),e.TgZ(13,"div",9),e._uU(14),e.qZA(),e.TgZ(15,"label",11),e._uU(16,"ECNR"),e.qZA(),e.TgZ(17,"div",12),e._uU(18),e.qZA(),e._UZ(19,"br"),e.TgZ(20,"label",13),e._uU(21,"Selected On"),e.qZA(),e.TgZ(22,"div",9),e._uU(23),e.ALo(24,"date"),e.qZA(),e.TgZ(25,"label",13),e._uU(26,"Current Status:"),e.qZA(),e.TgZ(27,"div",14),e._uU(28),e.qZA(),e._UZ(29,"hr",15),e.TgZ(30,"label",16),e._uU(31,"Date"),e.qZA(),e.TgZ(32,"label",17),e._uU(33,"Process Name"),e.qZA(),e.TgZ(34,"label",17),e._uU(35,"Next Process"),e.qZA(),e.TgZ(36,"label",16),e._uU(37,"Next Process"),e._UZ(38,"br"),e._uU(39,"Estimated Dt"),e.qZA(),e.TgZ(40,"button",18),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.addDepItem())}),e.qZA(),e.TgZ(41,"div",19),e.YNc(42,Q,9,9,"div",20),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.form),e.xp6(4),e.Oqu(t.candidateName),e.xp6(4),e.Oqu(t.companyName),e.xp6(5),e.Oqu(t.categoryRef),e.xp6(4),e.Oqu(t.dep.ecnr?"Yes":"No"),e.xp6(5),e.Oqu(e.xi3(24,8,t.dep.selectedOn,"dd-MMM-yy")),e.xp6(5),e.Oqu(t.dep.currentStatus),e.xp6(14),e.Q6J("ngForOf",t.depItems.controls)}}let G=(()=>{class o{constructor(t,n,i,a,s,d){this.bsModalRef=t,this.toastr=n,this.confirmService=i,this.fb=a,this.service=s,this.activatedRoute=d,this.updateDep=new e.vpe,this.ecnr=!1,this.form=new l.cw({}),this.candidateName="",this.categoryRef="",this.companyName="",this.depStatusAndNames=[],this.bsValue=new Date,this.bsRangeValue=new Date,this.maxDate=new Date,this.minDate=new Date,this.bsValueDate=new Date}ngOnInit(){this.dep&&this.InitializeForm(this.dep)}InitializeForm(t){this.form=this.fb.group({id:[t.id],cVRefId:[t.cvRefId],orderItemId:[t.orderItemId],customerId:t.customerId,selectedOn:t.selectedOn,currentStatus:t.currentStatus,ecnr:t.ecnr,depItems:this.fb.array(t.depItems.map(n=>this.fb.group({id:n.id,depId:n.depId,transactionDate:[n.transactionDate,l.kI.required],sequence:[n.sequence,l.kI.required],nextSequence:n.nextSequence,nextSequenceDate:n.nextSequenceDate,fullPath:n.fullPath})))})}get depItems(){return this.form.get("depItems")}newDepItem(){return this.fb.group({id:0,depId:this.form.get("id")?.value,transactionDate:[new Date,l.kI.required],sequence:[this.depItems.value[this.depItems.length].map(t=>t.nextSequence),l.kI.required],nextSequence:this.service.getNextSequence(this.depItems.value[this.depItems.length].map(t=>t.nextSequence),this.ecnr),nextSequenceDate:this.service.getNextStageDate(this.depItems.value[this.depItems.length].map(t=>t.nextSequence)),fullPath:""})}addDepItem(){this.depItems.push(this.newDepItem)}removeDepItem(t){var n="This will also delete ";n+=+t+1,this.confirmService.confirm("Confirm Delete",n+=" transactions that are after the date of this transaction.  THE DELETION WILL TAKE EFFECT ONLY AFTER YOU UPDATE THIS FORM").subscribe({next:i=>{if(i)for(let a=+t+1;a--;a<=t)console.log(t,a),this.depItems.removeAt(a)}})}updateDeployment(){this.form.dirty?(this.toastr.info("toaster info","testing"),this.updateDep.emit(this.form.value),this.bsModalRef.hide()):this.toastr.warning("form is not dirty","no changes made",{closeButton:!0,timeOut:0,extendedTimeOut:0})}download(t){var i=this.depItems.at(t).value.fullPath;""!==i?this.service.downloadAttachment(i).subscribe({next:a=>{const s=document.createElement("a"),d=URL.createObjectURL(a);s.href=d;var r=i.lastIndexOf("\\");s.download=-1!==r?i.substring(r+1):"filename.ext",s.click(),URL.revokeObjectURL(d)},error:a=>this.toastr.error(a.error.details,"Error encountered while downloading the file ")}):this.toastr.warning("this transaction has no file uploaded","Invalid selection")}close(){this.bsModalRef.hide()}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(b.UZ),e.Y36(f._W),e.Y36(v.z),e.Y36(l.qu),e.Y36(h),e.Y36(m.gz))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-deploy-edit-modal"]],inputs:{dep:"dep",updateDep:"updateDep"},decls:3,vars:2,consts:[["class","modal-header my-0",4,"ngIf"],["class","modal-body my-0",4,"ngIf"],[1,"modal-footer"],[1,"modal-header","my-0"],["title","edit emp data",1,"btn","fa","fa-save","fa-2x",2,"margin-left","200px",3,"click"],["title","Close",1,"btn","fa","fa-window-close","fa-2x","pull-right","my-0",3,"click"],[1,"modal-body","my-0"],[3,"formGroup"],["for","applicationNo",1,"stdd","w125","b"],[1,"stdd","w150"],["for","customerName",1,"stdd","w125","b"],[1,"stdd","w50","b"],[1,"stdd","w50"],[1,"stdd","w125","b"],[1,"stdd","w250"],[1,"my-0"],[1,"stdd","w90","b","vMiddle"],[1,"stdd","w200","b","vMiddle"],[1,"btn","fa","fa-plus","pull-right",3,"click"],["formArrayName","depItems"],[4,"ngFor","ngForOf"],[3,"formGroupName"],["type","text","placeholder","Selected On","formControlName","transactionDate","bsDatepicker","",1,"stdd","w90",3,"bsValue","bsConfig"],["bindLabel","name","bindValue","id","labelForId","id","formControlName","sequence",1,"stdd","w200",2,"height","fit-content","border-color","black",3,"items"],["bindLabel","name","bindValue","id","labelForId","id","clearAllText","Clear","formControlName","nextSequence",1,"stdd","w200",2,"border","rgb(from color r g b)",3,"items"],["type","text","placeholder","Selected On","formControlName","nextSequenceDate","bsDatepicker","",1,"stdd","w90",3,"bsValue","bsConfig"],["type","text","formControlName","fullPath",1,"stdd","w50",2,"font-size","smaller"],["type","button","title","download the attachment",1,"btn","fa","fa-download",3,"click"],[1,"btn","w25","fa","fa-trash","fa-sm","red",3,"click"]],template:function(n,i){1&n&&(e.YNc(0,L,5,0,"div",0),e.YNc(1,Y,43,11,"div",1),e._UZ(2,"div",2)),2&n&&(e.Q6J("ngIf",i.dep),e.xp6(1),e.Q6J("ngIf",i.dep))},dependencies:[g.sg,g.O5,_.Np,_.Y5,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,l.x0,l.CE,T.w9,g.uU],styles:[".stdd[_ngcontent-%COMP%]{display:inline-block;font-size:small;margin:0 2px;padding:0;vertical-align:top}.vMiddle[_ngcontent-%COMP%]{vertical-align:middle}.b[_ngcontent-%COMP%]{font-weight:700}.red[_ngcontent-%COMP%]{color:red}.w50[_ngcontent-%COMP%]{width:50px}.w90[_ngcontent-%COMP%]{width:90px}.w100[_ngcontent-%COMP%]{width:100px}.w110[_ngcontent-%COMP%]{width:110px}.w150[_ngcontent-%COMP%]{width:150px;word-wrap:normal}.w125[_ngcontent-%COMP%]{width:125px}.w200[_ngcontent-%COMP%]{width:200px}.w250[_ngcontent-%COMP%]{width:250px}"]})}return o})();var H=u(8645),D=u(2181),x=u(4664),O=u(6306),B=u(9397);class z{constructor(){this.id=0,this.depId=0,this.transactionDate=new Date,this.sequence=0,this.nextSequence=0,this.nextSequenceDate=new Date,this.fullPath=""}}const K=["editForm"],F=function(){return{dateInputFormat:"YYYY-MM-DD"}};let W=(()=>{class o{constructor(t,n,i,a){this.bsModalRef=t,this.toastr=n,this.confirmService=i,this.service=a,this.cvRefId=0,this.depItem=new z,this.updateDepItem=new e.vpe,this.candidateName="",this.categoryRef="",this.companyName="",this.ecnr=!1,this.depStatuses=[],this.bsValue=new Date,this.bsRangeValue=new Date,this.maxDate=new Date,this.minDate=new Date,this.bsValueDate=new Date,this.service.getDeployStatuses().subscribe({next:s=>this.depStatuses=s})}ngOnInit(){0!==this.cvRefId&&this.service.getNextDepItemFromCVRefId(this.cvRefId).subscribe({next:t=>{null!==t&&(this.depItem=t)}})}saveDepItem(){this.confirmService.confirm("cofirm Save","Press Ok to proceed").subscribe({next:t=>{t&&(this.updateDepItem.emit(this.editForm?.value),this.bsModalRef.hide())}})}close(){this.bsModalRef.hide()}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(b.UZ),e.Y36(f._W),e.Y36(v.z),e.Y36(h))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-deploy-add-modal"]],viewQuery:function(n,i){if(1&n&&e.Gf(K,5),2&n){let a;e.iGM(a=e.CRH())&&(i.editForm=a.first)}},inputs:{cvRefId:"cvRefId",updateDepItem:"updateDepItem"},decls:37,vars:16,consts:[[1,"modal-header"],["title","edit emp data",1,"w35","btn","btn-success","fa","fa-save",2,"margin-left","200px",3,"click"],["title","Close",1,"btn","fa","fa-close","pull-right",3,"click"],[1,"modal-body"],["for","applicationNo",1,"stdd","w150","b"],[1,"stdd","w200"],["for","customerName",1,"stdd","w150","b"],[1,"stdd","w150"],[1,"stdd","w50"],["id","editForm"],["editForm","ngForm"],[2,"display","inline-block","width","110px"],["type","text","placeholder","Offer accepted On","bsDatepicker","",1,"stdd","w110",3,"ngModel","bsValue","bsConfig","ngModelChange"],[1,"stdd","w125"],["bindLabel","statusName","bindValue","depItem.sequence","labelForId","depItem.statusName","clearAllText","Clear",2,"border","color(from color srgb r g b)","font-size","smaller",3,"items","ngModel","ngModelChange"],["bindLabel","statusName","bindValue","depItem.nextSequence","labelForId","depItem.statusName","clearAllText","Clear",2,"border","color(from color srgb r g b)","font-size","smaller",3,"items","ngModel","ngModelChange"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0)(1,"h6"),e._uU(2,"Add a deployment transaction"),e.qZA(),e.TgZ(3,"button",1),e.NdJ("click",function(){return i.saveDepItem()}),e.qZA(),e.TgZ(4,"button",2),e.NdJ("click",function(){return i.close()}),e.qZA()(),e.TgZ(5,"div",3)(6,"label",4),e._uU(7,"Application No:"),e.qZA(),e.TgZ(8,"div",5),e._uU(9),e.qZA(),e._UZ(10,"br"),e.TgZ(11,"label",6),e._uU(12,"Customer Name"),e.qZA(),e.TgZ(13,"div",5),e._uU(14),e.qZA(),e._UZ(15,"br"),e.TgZ(16,"label",6),e._uU(17,"Category Ref"),e.qZA(),e.TgZ(18,"div",5),e._uU(19),e.qZA(),e._UZ(20,"br"),e.TgZ(21,"label",7),e._uU(22,"Emig Clearance Required"),e.qZA(),e.TgZ(23,"div",8),e._uU(24),e.qZA(),e.TgZ(25,"h6"),e._uU(26,"Deployment Transaction to add:"),e.qZA(),e.TgZ(27,"form",9,10)(29,"div",11)(30,"input",12),e.NdJ("ngModelChange",function(s){return i.depItem.transactionDate=s}),e.qZA()(),e.TgZ(31,"div",13)(32,"ng-select",14),e.NdJ("ngModelChange",function(s){return i.depItem.sequence=s}),e.qZA()(),e.TgZ(33,"div",13)(34,"ng-select",15),e.NdJ("ngModelChange",function(s){return i.depItem.nextSequence=s}),e.qZA()(),e.TgZ(35,"div",11)(36,"input",12),e.NdJ("ngModelChange",function(s){return i.depItem.nextSequenceDate=s}),e.qZA()()()()),2&n&&(e.xp6(9),e.Oqu(i.candidateName),e.xp6(5),e.Oqu(i.companyName),e.xp6(5),e.Oqu(i.categoryRef),e.xp6(5),e.Oqu(i.ecnr?"YES":"NO"),e.xp6(6),e.Q6J("ngModel",i.depItem.transactionDate)("bsValue",i.bsValueDate)("bsConfig",e.DdM(14,F)),e.xp6(2),e.Q6J("items",i.depStatuses)("ngModel",i.depItem.sequence),e.xp6(2),e.Q6J("items",i.depStatuses)("ngModel",i.depItem.nextSequence),e.xp6(2),e.Q6J("ngModel",i.depItem.nextSequenceDate)("bsValue",i.bsValueDate)("bsConfig",e.DdM(15,F)))},dependencies:[_.Np,_.Y5,l._Y,l.Fj,l.JJ,l.JL,l.On,l.F,T.w9]})}return o})();function j(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"div",6)(1,"label",7),e._uU(2,"Airline"),e.qZA(),e.TgZ(3,"input",8),e.NdJ("ngModelChange",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.flightData.airlineName=i)}),e.qZA(),e.TgZ(4,"label",9),e._uU(5,"Flight No"),e.qZA(),e.TgZ(6,"input",10),e.NdJ("ngModelChange",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.flightData.flightNo=i)}),e.qZA(),e._UZ(7,"br"),e.TgZ(8,"label",7),e._uU(9,"Airport of Boarding"),e.qZA(),e.TgZ(10,"input",11),e.NdJ("ngModelChange",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.flightData.airportOfBoarding=i)}),e.qZA(),e.TgZ(11,"label",9),e._uU(12,"ETD Boarding"),e.qZA(),e.TgZ(13,"input",12),e.NdJ("ngModelChange",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.flightData.eTD_BoardingString=i)}),e.qZA(),e._UZ(14,"br"),e.TgZ(15,"label",7),e._uU(16,"Destination Airport"),e.qZA(),e.TgZ(17,"input",13),e.NdJ("ngModelChange",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.flightData.airportOfDestination=i)}),e.qZA(),e.TgZ(18,"label",9),e._uU(19,"ETA Destination"),e.qZA(),e.TgZ(20,"input",14),e.NdJ("ngModelChange",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.flightData.eTA_DestinationString=i)}),e.qZA(),e._UZ(21,"br"),e.TgZ(22,"label",7),e._uU(23,"Via Airport"),e.qZA(),e.TgZ(24,"input",15),e.NdJ("ngModelChange",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.flightData.airportVia=i)}),e.qZA(),e.TgZ(25,"label",9),e._uU(26,"Flight No Via"),e.qZA(),e.TgZ(27,"input",16),e.NdJ("ngModelChange",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.flightData.flightNoVia=i)}),e.qZA(),e._UZ(28,"br"),e.TgZ(29,"label",7),e._uU(30,"ETA at Via Airport"),e.qZA(),e.TgZ(31,"input",17),e.NdJ("ngModelChange",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.flightData.eTA_ViaString=i)}),e.qZA(),e.TgZ(32,"label",7),e._uU(33,"ETD from Via Airport"),e.qZA(),e.TgZ(34,"input",18),e.NdJ("ngModelChange",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.flightData.eTD_ViaString=i)}),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(3),e.Q6J("ngModel",t.flightData.airlineName),e.xp6(3),e.Q6J("ngModel",t.flightData.flightNo),e.xp6(4),e.Q6J("ngModel",t.flightData.airportOfBoarding),e.xp6(3),e.Q6J("ngModel",t.flightData.eTD_BoardingString),e.xp6(4),e.Q6J("ngModel",t.flightData.airportOfDestination),e.xp6(3),e.Q6J("ngModel",t.flightData.eTA_DestinationString),e.xp6(4),e.Q6J("ngModel",t.flightData.airportVia),e.xp6(3),e.Q6J("ngModel",t.flightData.flightNoVia),e.xp6(4),e.Q6J("ngModel",t.flightData.eTA_ViaString),e.xp6(3),e.Q6J("ngModel",t.flightData.eTD_ViaString)}}let U=(()=>{class o{constructor(t,n,i,a){this.bsModalRef=t,this.toastr=n,this.confirmService=i,this.service=a,this.candidateFlightEvent=new e.vpe}ngOnInit(){}close(){this.candidateFlightEvent.emit(null),this.bsModalRef.hide()}registerDate(){this.DataVerified()&&(this.candidateFlightEvent.emit(this.flightData),this.bsModalRef.hide())}DataVerified(){var t="";return(!M(this.flightData.eTA_DestinationString)||!M(this.flightData.eTD_BoardingString))&&(t="Invalid Date - ETA / ETD"),""!==this.flightData?.airlineVia&&(!M(this.flightData.eTD_ViaString)||!M(this.flightData.eTA_ViaString))&&(t+="Invalid Date - ETD"),""==this.flightData?.airlineName&&(t+=" Airline name not mentioned"),""==this.flightData?.airportOfBoarding&&(t+=" Airport of Boarding not mentioned"),""==this.flightData?.airportOfDestination&&(t+=" Airport of destination not provided"),""==this.flightData?.flightNo&&(t+=" Flight No not provided"),""==t||(this.toastr.warning(t,"errors encountered"),!1)}dateChanged(t){return console.log("dateChanged:",t),t?new Date(t):null}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(b.UZ),e.Y36(f._W),e.Y36(v.z),e.Y36(h))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-choose-flight-modal"]],inputs:{flightData:"flightData"},outputs:{candidateFlightEvent:"candidateFlightEvent"},decls:8,vars:1,consts:[[1,"modal-header","my-0"],["title","edit emp data",1,"w35","btn","btn-success","fa","fa-check",2,"margin-left","200px",3,"click"],["title","Close",1,"btn","fa","fa-close","pull-right",3,"click"],["class","modal-body my-0",4,"ngIf"],[1,"modal-footer","my-0"],[2,"font-size","x-small"],[1,"modal-body","my-0"],[1,"lbl","w125"],["type","text","placeholder","Airline Name",1,"stdd","w125",3,"ngModel","ngModelChange"],[1,"lbl","w100","mx-2"],["type","text","placeholder","Flight No",1,"stdd","w150",3,"ngModel","ngModelChange"],["type","text","placeholder","Boarding Airport",1,"stdd","w125",3,"ngModel","ngModelChange"],["type","datetime","placeholder","ETD Boarding",1,"stdd","w150",3,"ngModel","ngModelChange"],["type","text","placeholder","Destination Airport",1,"stdd","w125",3,"ngModel","ngModelChange"],["type","datetime","placeholder","ETA Destination",1,"stdd","w150",3,"ngModel","ngModelChange"],["type","text","placeholder","Via Airport",1,"stdd","w125",3,"ngModel","ngModelChange"],["type","text","placeholder","FlightNo Via",1,"stdd","w125",3,"ngModel","ngModelChange"],["type","datetime","placeholder","ETA Via Airport",1,"stdd","w150",3,"ngModel","ngModelChange"],["type","datetime","placeholder","ETD Via Airport",1,"stdd","w125",3,"ngModel","ngModelChange"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0)(1,"h4"),e._uU(2,"Flight details"),e.qZA(),e.TgZ(3,"button",1),e.NdJ("click",function(){return i.registerDate()}),e.qZA(),e.TgZ(4,"button",2),e.NdJ("click",function(){return i.close()}),e.qZA()(),e.YNc(5,j,35,10,"div",3),e._UZ(6,"div",4)(7,"div",5)),2&n&&(e.xp6(5),e.Q6J("ngIf",i.flightData))},dependencies:[g.O5,l.Fj,l.JJ,l.On],styles:[".w20[_ngcontent-%COMP%]{width:20px}.w60[_ngcontent-%COMP%]{width:60px}.w75[_ngcontent-%COMP%]{width:75px}.w90[_ngcontent-%COMP%]{width:90px}.w100[_ngcontent-%COMP%]{width:100px}.w125[_ngcontent-%COMP%]{width:125px}.w150[_ngcontent-%COMP%]{width:150px}.w200[_ngcontent-%COMP%]{width:200px}.mL120[_ngcontent-%COMP%]{margin-left:120px}.lbl[_ngcontent-%COMP%]{display:inline-block;font-size:small;margin:2px;font-weight:700;font-size:smaller;vertical-align:middle;word-wrap:normal}.blue[_ngcontent-%COMP%]{color:#00008b}.stdd[_ngcontent-%COMP%]{display:inline-block;font-size:smaller;margin:2px;word-wrap:normal}.line2[_ngcontent-%COMP%]{color:#00008b;display:inline-block;margin:0 2px;font-weight:700;font-size:smaller;vertical-align:middle;word-wrap:normal}"]})}return o})();function M(o){const c=new Date(o);return!isNaN(c.getTime())}function X(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"div",3)(1,"h4"),e._uU(2,"Edit Deployment records"),e.qZA(),e.TgZ(3,"button",4),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.uploadAttachment())}),e.qZA(),e.TgZ(4,"button",5),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.bsModalRef.hide())}),e.qZA()()}}const $=function(){return{dateInputFormat:"YYYY-MM-DD"}};function ee(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"div",20),e._UZ(2,"input",21)(3,"ng-select",22)(4,"input",23),e.TgZ(5,"button",24),e.NdJ("click",function(){const a=e.CHM(t).index,s=e.oxw(2);return e.KtG(s.download(a))}),e.qZA(),e.TgZ(6,"button",25),e.NdJ("click",function(){const a=e.CHM(t).index,s=e.oxw(2);return e.KtG(s.deleteAttachment(a))}),e.qZA(),e.TgZ(7,"input",26),e.NdJ("change",function(i){const s=e.CHM(t).index,d=e.oxw(2);return e.KtG(d.onFileInputChange(i,s))}),e.qZA()()()}if(2&o){const t=c.index,n=e.oxw(2);e.xp6(1),e.Q6J("formGroupName",t),e.xp6(1),e.Q6J("bsValue",n.bsValueDate)("bsConfig",e.DdM(4,$)),e.xp6(1),e.Q6J("items",n.depStatusAndNames)}}function te(o,c){if(1&o&&(e.TgZ(0,"div",6)(1,"form",7)(2,"label",8),e._uU(3,"Candidate:"),e.qZA(),e.TgZ(4,"div",9),e._uU(5),e.qZA(),e.TgZ(6,"label",10),e._uU(7,"Customer:"),e.qZA(),e.TgZ(8,"div",9),e._uU(9),e.qZA(),e._UZ(10,"br"),e.TgZ(11,"label",10),e._uU(12,"Category Ref"),e.qZA(),e.TgZ(13,"div",9),e._uU(14),e.qZA(),e.TgZ(15,"label",11),e._uU(16,"ECNR"),e.qZA(),e.TgZ(17,"div",12),e._uU(18),e.qZA(),e._UZ(19,"br"),e.TgZ(20,"label",13),e._uU(21,"Selected On"),e.qZA(),e.TgZ(22,"div",9),e._uU(23),e.ALo(24,"date"),e.qZA(),e.TgZ(25,"label",13),e._uU(26,"Current Status:"),e.qZA(),e.TgZ(27,"div",14),e._uU(28),e.qZA(),e._UZ(29,"hr",15),e.TgZ(30,"label",16),e._uU(31,"Date"),e.qZA(),e.TgZ(32,"label",17),e._uU(33,"Process Name"),e.qZA(),e.TgZ(34,"div",18),e.YNc(35,ee,8,5,"div",19),e.qZA()()()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.form),e.xp6(4),e.Oqu(t.candidateName),e.xp6(4),e.Oqu(t.companyName),e.xp6(5),e.Oqu(t.categoryRef),e.xp6(4),e.Oqu(t.dep.ecnr?"Yes":"No"),e.xp6(5),e.Oqu(e.xi3(24,8,t.dep.selectedOn,"dd-MMM-yy")),e.xp6(5),e.Oqu(t.dep.currentStatus),e.xp6(7),e.Q6J("ngForOf",t.depItems.controls)}}let ne=(()=>{class o{constructor(t,n,i,a,s){this.bsModalRef=t,this.toastr=n,this.confirm=i,this.fb=a,this.service=s,this.updateDep=new e.vpe,this.indexId=0,this.ecnr=!1,this.form=new l.cw({}),this.candidateName="",this.categoryRef="",this.companyName="",this.filesToUpload=[],this.lastTimeCalled=0,this.bsValue=new Date,this.bsRangeValue=new Date,this.maxDate=new Date,this.minDate=new Date,this.bsValueDate=new Date,this.depStatusAndNames=[]}ngOnInit(){this.dep&&this.InitializeForm(this.dep)}InitializeForm(t){this.form=this.fb.group({id:[t.id],cVRefId:[t.cvRefId],orderItemId:[t.orderItemId],customerId:t.customerId,selectedOn:t.selectedOn,currentStatus:t.currentStatus,ecnr:t.ecnr,depItems:this.fb.array(t.depItems.map(n=>this.fb.group({id:n.id,depId:n.depId,transactionDate:[n.transactionDate,l.kI.required],sequence:[n.sequence,l.kI.required],fullPath:n.fullPath})))})}get depItems(){return this.form.get("depItems")}onFileInputChange(t,n){const i=t.target;var a=this.depItems.at(n).value;if(!this.sequenceValidForUpload(a.sequence))return void this.toastr.warning("The item has a sequence that does not need any file attachment","Invalid Item for Upload");if(this.filesToUpload=[],null!==a.fullPath&&""!==a.fullPath)return void this.toastr.warning("one file is already listed as uploaded.  If you want to replace earlier upload, then delete the upload in order to add another upload","Only 1 file can be uploaded for a transaction");this.depItemOfAttachment=a,this.indexId=n;const r=i.files[0];a.fullPath=r.name,this.filesToUpload.push(r)}uploadAttachment(){if(Date.now()<this.lastTimeCalled+28e3)return;this.lastTimeCalled=Date.now();let i=new FormData;this.filesToUpload.length>0&&this.filesToUpload.forEach(a=>{i.append("file",a,a.name)}),i.append("data",JSON.stringify(this.depItemOfAttachment)),this.service.uploadAttachmentForItem(i).subscribe({next:a=>{this.depItems.at(this.indexId).get("fullPath")?.setValue(a),this.toastr.success("file uploaded and attachment path updated","Success")},error:a=>this.toastr.error(a.error.details,"error while uploading the attachment")})}sequenceValidForUpload(t){switch(t){case 100:case 150:case 400:case 700:case 1100:case 1300:return!0;default:return!1}}download(t){var n=this.depItems.at(t).get("fullPath")?.value;null!==n&&""!==n?this.service.downloadAttachment(n).subscribe({next:i=>{const a=document.createElement("a"),s=URL.createObjectURL(i);a.href=s;var d=n.lastIndexOf("\\");a.download=-1!==d?n.substring(d+1):"filename.ext",a.click(),URL.revokeObjectURL(s)},error:i=>this.toastr.error(i.error.details,"Error encountered while downloading the file ")}):this.toastr.warning("No file upload data available","Bad Request")}deleteAttachment(t){var n=this.depItems.at(t).get("fullPath")?.value;null!==n&&""!==n||this.toastr.warning("No file upload data available","Bad Request")}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(b.UZ),e.Y36(f._W),e.Y36(v.z),e.Y36(l.qu),e.Y36(h))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-dep-attachment-modal"]],inputs:{updateDep:"updateDep"},decls:3,vars:2,consts:[["class","modal-header my-0",4,"ngIf"],["class","modal-body my-0",4,"ngIf"],[1,"modal-footer"],[1,"modal-header","my-0"],["title","edit emp data",1,"btn","fa","fa-save","fa-2x",2,"margin-left","200px",3,"click"],["title","Close",1,"btn","fa","fa-window-close","fa-2x","pull-right","my-0",3,"click"],[1,"modal-body","my-0"],[3,"formGroup"],["for","applicationNo",1,"stdd","w125","b"],[1,"stdd","w150"],["for","customerName",1,"stdd","w125","b"],[1,"stdd","w50","b"],[1,"stdd","w50"],[1,"stdd","w125","b"],[1,"stdd","w250"],[1,"my-0"],[1,"stdd","w110","b","vMiddle"],[1,"stdd","w200","b","vMiddle"],["formArrayName","depItems"],[4,"ngFor","ngForOf"],[3,"formGroupName"],["type","text","placeholder","Selected On","formControlName","transactionDate","bsDatepicker","",1,"stdd","w90",3,"bsValue","bsConfig"],["bindLabel","name","bindValue","id","labelForId","id","formControlName","sequence",1,"stdd","w200",2,"height","fit-content","border-color","black",3,"items"],["type","text","formControlName","fullPath",1,"stdd","w50",2,"font-size","smaller"],[1,"btn","fa","fa-download",3,"click"],[1,"btn","fa","fa-trash","red",3,"click"],["type","file","id","file",1,"stdd",3,"change"]],template:function(n,i){1&n&&(e.YNc(0,X,5,0,"div",0),e.YNc(1,te,36,11,"div",1),e._UZ(2,"div",2)),2&n&&(e.Q6J("ngIf",i.dep),e.xp6(1),e.Q6J("ngIf",i.dep))},dependencies:[g.sg,g.O5,_.Np,_.Y5,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,l.x0,l.CE,T.w9,g.uU],styles:[".stdd[_ngcontent-%COMP%]{display:inline-block;font-size:small;margin:0 2px;padding:0;vertical-align:top}.vMiddle[_ngcontent-%COMP%]{vertical-align:middle}.b[_ngcontent-%COMP%]{font-weight:700}.red[_ngcontent-%COMP%]{color:red}.w50[_ngcontent-%COMP%]{width:50px}.w90[_ngcontent-%COMP%]{width:90px}.w100[_ngcontent-%COMP%]{width:100px}.w110[_ngcontent-%COMP%]{width:110px}.w150[_ngcontent-%COMP%]{width:150px;word-wrap:normal}.w125[_ngcontent-%COMP%]{width:125px}.w200[_ngcontent-%COMP%]{width:200px}.w250[_ngcontent-%COMP%]{width:250px}"]})}return o})();var k=u(7012),P=u(617);let ie=(()=>{class o{constructor(){this.statuses=[{sequence:0,status:"None"},{sequence:100,status:"Selected"},{sequence:150,status:"Offer Letter Accepted"},{sequence:200,status:"Document Certificate Initiated"},{sequence:300,status:"Ref For Med Tests"},{sequence:400,status:"Med Fit"},{sequence:500,status:"Med Unfit"},{sequence:550,status:"Visa Documents Prepared"},{sequence:600,status:"Visa Docs submitted"},{sequence:700,status:"Visa Endorsed"},{sequence:800,status:"Visa denied"},{sequence:900,status:"Emig Application Lodged"},{sequence:1e3,status:"Emig Documents Lodged"},{sequence:1100,status:"Emig Granted"},{sequence:1200,status:"Emig Denied"},{sequence:1300,status:"Travel Tkt booked"},{sequence:1400,status:"Docs couriered to candidate"},{sequence:1500,status:"Traveled"},{sequence:1600,status:"Arrival Acknowledged by client"},{sequence:5e3,status:"Concluded"}]}transform(t){return this.statuses.filter(i=>i.sequence===t).map(i=>i.status)[0]??"undefined"}static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275pipe=e.Yjl({name:"depStatus",type:o,pure:!0})}return o})();function ae(o,c){if(1&o&&(e.TgZ(0,"div",10),e._uU(1),e.ALo(2,"depStatus"),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Oqu(e.lcZ(2,1,t.dep.deploySequence))}}function oe(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"div",11),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.showFlight())}),e._uU(1),e.ALo(2,"depStatus"),e.qZA()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Oqu(e.lcZ(2,1,t.dep.deploySequence))}}function se(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"input",1),e.NdJ("ngModelChange",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.dep.checked=i)})("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.selectedClicked())}),e.qZA(),e.TgZ(2,"div",2),e._uU(3),e.qZA(),e.TgZ(4,"div",3),e._uU(5),e.qZA(),e.TgZ(6,"div",3),e._uU(7),e.qZA(),e.TgZ(8,"div",4),e._uU(9),e.qZA(),e.TgZ(10,"div",3),e._uU(11),e.qZA(),e.TgZ(12,"div",5),e._uU(13),e.ALo(14,"date"),e.qZA(),e.TgZ(15,"div",5),e._uU(16),e.ALo(17,"date"),e.qZA(),e.YNc(18,ae,3,3,"div",6),e.YNc(19,oe,3,3,"div",7),e.TgZ(20,"div",3),e._uU(21),e.ALo(22,"depStatus"),e.qZA(),e.TgZ(23,"div",5),e._uU(24),e.ALo(25,"date"),e.qZA(),e.TgZ(26,"button",8),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.editDep())}),e.qZA(),e.TgZ(27,"button",9),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.editAttachment())}),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngModel",t.dep.checked),e.xp6(2),e.Oqu(t.dep.applicationNo),e.xp6(2),e.Oqu(t.dep.candidateName),e.xp6(2),e.Oqu(t.dep.customerName),e.xp6(2),e.Oqu(t.dep.orderNo),e.xp6(2),e.hij("",t.dep.categoryName," "),e.xp6(2),e.Oqu(e.xi3(14,12,t.dep.referredOn,"dd-MMM")),e.xp6(3),e.Oqu(e.xi3(17,15,t.dep.selectedOn,"dd-MMM")),e.xp6(2),e.Q6J("ngIf",1300!==t.dep.deploySequence),e.xp6(1),e.Q6J("ngIf",1300===t.dep.deploySequence),e.xp6(2),e.Oqu(e.lcZ(22,18,t.dep.nextSequence)),e.xp6(3),e.Oqu(e.xi3(25,20,t.dep.nextStageDate,"dd-MMM"))}}let le=(()=>{class o{constructor(t,n){this.service=t,this.toastr=n,this.editDepEvent=new e.vpe,this.deleteDepEvent=new e.vpe,this.selectedEvent=new e.vpe,this.showTicket=new e.vpe,this.editAttachmentEvent=new e.vpe}ngOnInit(){}editDep(){this.dep&&this.service.getDeploymentWithItems(this.dep.depId).subscribe({next:t=>{t&&this.editDepEvent.emit(t)}})}showFlight(){1300===this.dep.deploySequence?this.showTicket.emit(this.dep?.cvRefId):this.toastr.warning("This can be called only when there is a ticket booked")}deleteDep(){this.deleteDepEvent.emit(this.dep.depId)}selectedClicked(){this.selectedEvent.emit(this.dep)}editAttachment(){this.dep&&this.service.getDeploymentWithItems(this.dep.depId).subscribe({next:t=>{t&&this.editAttachmentEvent.emit(t)}})}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(h),e.Y36(f._W))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-deploy-line"]],inputs:{dep:"dep"},outputs:{editDepEvent:"editDepEvent",deleteDepEvent:"deleteDepEvent",selectedEvent:"selectedEvent",showTicket:"showTicket",editAttachmentEvent:"editAttachmentEvent"},decls:1,vars:1,consts:[[4,"ngIf"],["type","checkbox",1,"form-check-input","w20","hAlignCenter",2,"margin-left","25px","margin-right","25px",3,"ngModel","ngModelChange","click"],[1,"w50",2,"display","inline-block","margin-left","5px"],[1,"stdd","w150"],[1,"stdd","w50"],[1,"stdd","w75"],["class","stdd w150 mx-2",4,"ngIf"],["class","stdd w150 mx-2 cursorPointer","title","Press this to display flight details",3,"click",4,"ngIf"],["title","edit Deployment Transactions.  This option also provides for addition of a transaction",1,"btn","fa","fa-pencil","fa-sm",2,"color","aliceblue",3,"click"],["title","upload/download attachments.",1,"btn","fa","fa-upload",2,"color","aliceblue",3,"click"],[1,"stdd","w150","mx-2"],["title","Press this to display flight details",1,"stdd","w150","mx-2","cursorPointer",3,"click"]],template:function(n,i){1&n&&e.YNc(0,se,28,23,"div",0),2&n&&e.Q6J("ngIf",void 0!==i.dep)},dependencies:[g.O5,l.Wl,l.JJ,l.On,g.uU,ie],styles:[".stdd[_ngcontent-%COMP%]{display:inline-block;margin:2px 0;vertical-align:top;font-size:small;word-wrap:break-word}.fSmall[_ngcontent-%COMP%]{font-size:small}.fSmaller[_ngcontent-%COMP%]{font-size:smaller}.w20[_ngcontent-%COMP%]{width:20px}.w50[_ngcontent-%COMP%]{width:50px}.w75[_ngcontent-%COMP%]{width:75px;font-size:smaller!important}.w100[_ngcontent-%COMP%]{width:100px}.w110[_ngcontent-%COMP%]{width:110px}.w125[_ngcontent-%COMP%]{width:125px}.w150[_ngcontent-%COMP%]{width:150px}.w175[_ngcontent-%COMP%]{width:175px}.w200[_ngcontent-%COMP%]{width:200px}.mL25[_ngcontent-%COMP%]{width:25px}input[type=checkbox][_ngcontent-%COMP%]{outline:1px solid #1e5180}.red[_ngcontent-%COMP%]{color:red}  .ng-select-container{height:5px!important;font-size:.8em!important}.cursorPointer[_ngcontent-%COMP%]{cursor:pointer}"]})}return o})();const de=["search"];function re(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"div",25)(1,"pagination",26),e.NdJ("pageChanged",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.onPageChanged(i))}),e._uU(2," >"),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("totalItems",t.pagination.totalItems)("itemsPerPage",t.pagination.itemsPerPage)("maxSize",10)}}function ce(o,c){1&o&&(e.TgZ(0,"div"),e._uU(1," No pending deployment transactions on record\n"),e.qZA())}function pe(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"app-deploy-line",27),e.NdJ("editDepEvent",function(i){const s=e.CHM(t).$implicit,d=e.oxw();return e.KtG(d.editDeploymentModal(i,s))})("selectedEvent",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.selectionChanged(i))})("showTicket",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.showTicketClicked(i))})("candidateFlightDeleteEvent",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.candidateFlightDelete(i))})("candidteFlightEditEvent",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.candidateFlightEdit(i))})("editAttachmentEvent",function(i){const s=e.CHM(t).$implicit,d=e.oxw();return e.KtG(d.editAttachmentModal(i,s))}),e.qZA()()}if(2&o){const t=c.$implicit;e.xp6(1),e.Q6J("dep",t)}}const ue=function(){return{dateInputFormat:"YYYY-MM-DD"}};let ge=(()=>{class o{constructor(t,n,i,a,s,d){this.toastr=t,this.confirm=n,this.bsModalService=i,this.activatedRoute=a,this.service=s,this.router=d,this.EditDepEvent=new e.vpe,this.returnUrl="",this.title="",this.currentSearchValue="",this.currentOption="",this.currentStatus="",this.deployStatus="",this.deploys=[],this.deploysSelected=[],this.routeId="",this.totalCount=0,this.depStatuses=[],this.statusNameAndSeq=[],this.transDate=new Date,this.sequenceSelected=0,this.currentCVRefId=0,this.dParams=new N,this.newSequence=new H.x,this.bsValueDate=new Date,this.optionSelected="",this.searchOptions=[{name:"Application",value:"applicationNo"},{name:"Candidate Name",value:"candidateName"},{name:"Order No",value:"orderNo"},{name:"Category Name",value:"categoryName"},{name:"Date Selected",value:"selectedon"},{name:"Employer Name",value:"customerName"}],this.sortOptions=[{name:"By Application No Asc",value:"appno"},{name:"By Application No Desc",value:"apppnodesc"},{name:"By Profession Asc",value:"prof"},{name:"By Profession Desc",value:"profdesc"},{name:"By Employer",value:"employer"},{name:"By Employer Desc",value:"employerdesc"}],this.SEQUENCE_SELECTED=100,this.SEQUENCE_DOCUMENTS_ATTESTATION=200,this.SEQUENCE_MED_REFERRED=300,this.SEQUENCE_MED_FIT=400,this.SEQUENCE_MED_UNFIT=500,this.SEQUENCE_VISA_DOC_SUBMITTED=600,this.SEQUENCE_VISA_ISSUED=700,this.SEQUENCE_VISA_REJECTED=800,this.SEQUENCE_EMIG_APP_LODGED=900,this.SEQUENCE_EMIG_DOC_LODGED=1e3,this.SEQUENCE_EMIG_CLEARED=1100,this.SEQUENCE_EMIG_DENIED=1200,this.SEQUENCE_TRAVEL_BOOKED=1300,this.SEQUENCE_TRAVELED=1500;let r=this.router.getCurrentNavigation();r?.extras&&r.extras.state&&(r.extras.state.returnUrl&&(this.returnUrl=r.extras.state.returnUrl),r.extras.state.user&&(this.user=r.extras.state.user))}ngOnInit(){this.deploysSelected=[],this.getDeployments(),this.activatedRoute.data.subscribe({next:t=>this.statusNameAndSeq=t.statusNameAndSeq}),this.getDeploymentStatuses(),this.title="active"}getDeployStatusAndSeq(){this.service.getDepStatusAndNames().subscribe({next:t=>this.statusNameAndSeq=t})}getDeploymentStatuses(){this.service.getDeployStatuses().subscribe({next:t=>this.depStatuses=t,error:t=>console.log(t)})}onPageChanged(t){const n=this.service.getParams();n.pageNumber!==t&&(n.pageNumber=t.page,this.service.setParams(n),this.getDeployments())}getDeployments(){var t=this.service.getParams();console.log("params from service:",t),this.service.getDeploymentPagedList(t)?.subscribe({next:n=>{null!=n?(this.deploys=n.result,this.totalCount=n?.count,this.pagination=n.pagination):console.log("response is undefined")},error:n=>console.log(n)})}close(){this.currentCVRefId=0}deletDeployment(t){var n=t;this.confirm.confirm("confirm Delete","Are you sure you want to delete this deployment?  All related transactions will also be deleted").pipe((0,D.h)(a=>a),(0,x.w)(a=>this.service.deleteDeployment(n).pipe((0,O.K)(s=>(this.toastr.error(s,"failed to delete"),(0,C.of)())),(0,B.b)(s=>{this.toastr.error("Deleted the deployment","success in deletion")}),(0,O.K)(s=>(this.toastr.error(s,"Failed to delete the deployment record"),(0,C.of)()))))).subscribe(()=>this.toastr.success("deployment deleted in subscribe","success"))}onSearch(){const t=this.service.getParams();var n=this.searchTerm.nativeElement.value;if(this.currentSearchValue!=n||this.optionSelected!=this.currentOption||this.currentStatus!=this.deployStatus){switch(this.currentStatus=this.deployStatus,this.currentSearchValue=n,this.optionSelected){case"applicationNo":t.applicationNo=n;break;case"orderNo":t.orderNo=n;break;case"selectedOn":t.selectedOn=new Date(n);break;case"customerName":t.customerName=n;break;case"categoryName":t.categoryName=n;break;case"candidateName":t.candidateName=n}this.title=this.optionSelected+"="+n,""===this.deployStatus&&(this.deployStatus="Concluded"),t.status=this.deployStatus,t.pageNumber=1,this.service.setParams(t),this.getDeployments()}else this.toastr.warning("No valid selection","Bad Request")}onOptionSelected(t){this.optionSelected!==t&&(this.optionSelected=t,this.currentOption=t)}optionCleared(){this.optionSelected=""}onReset(){this.searchTerm.nativeElement.value="",this.dParams=new N,this.service.setParams(this.dParams),this.getDeployments()}editDeploymentModal(t,n){null!==t?(this.bsModalRef=this.bsModalService.show(G,{class:"modal-dialog-centered modal-lg",initialState:{dep:t,depStatusAndNames:this.statusNameAndSeq,candidateName:n.applicationNo+"-"+n.candidateName,categoryRef:n.categoryName,companyName:n.customerName}}),this.bsModalRef.content.updateDep.pipe((0,D.h)(s=>null!==s),(0,x.w)(s=>this.service.updateDeployment(s))).subscribe(s=>{if(null!==s){this.toastr.success("Deployment updated","Success");var d=this.deploys.findIndex(r=>r.depId===s.depId);-1!==d&&(this.deploys[d]=s)}else this.toastr.warning(s,"Failure")})):this.toastr.warning("No Deployment object returned from the modal form")}adddNewDeployment(t){this.bsModalRef=this.bsModalService.show(W,{class:"modal-dialog-centered modal-lg",initialState:{cvRefId:t.cvRefId,depStatuses:this.depStatuses,candidateName:t.applicationNo+"-"+t.customerName,categoryRef:t.categoryName,companyName:t.customerName,ecnr:t.ecnr}}),this.bsModalRef.content.updateDep.pipe((0,D.h)(a=>null!==a),(0,x.w)(a=>this.service.updateDeploymentItem(a))).subscribe(a=>{""===a?this.toastr.success("Deployment Item inserted","Success"):this.toastr.warning(a,"Failure")})}editAttachmentModal(t,n){null!==t?(this.bsModalRef=this.bsModalService.show(ne,{class:"modal-dialog-centered modal-lg",initialState:{dep:t,depStatusAndNames:this.statusNameAndSeq,candidateName:n.applicationNo+"-"+n.candidateName,categoryRef:n.categoryName,companyName:n.customerName}}),this.bsModalRef.content.updateDep.subscribe({next:()=>this.toastr.info("attachment process completed","Process Over")})):this.toastr.warning("No Deployment object returned from the modal form")}verifyNextSequence(t,n){var i=this.depStatuses.filter(r=>r.sequence==t)[0],s=(this.depStatuses.filter(r=>r.sequence==n),this.deploysSelected.filter(r=>r.ecnr)),d="";switch(i.sequence){case this.SEQUENCE_MED_REFERRED:d=n===this.SEQUENCE_MED_FIT||n===this.SEQUENCE_MED_UNFIT?"":"Valid Sequence after Medical Referred is: MEDICALLY FIT or MEDICALLY UNFIT";break;case this.SEQUENCE_MED_FIT:d=n===this.SEQUENCE_VISA_DOC_SUBMITTED?"Sequence after Medical Fitness is Visa Documents submision":"";break;case this.SEQUENCE_VISA_ISSUED:d=n===this.SEQUENCE_EMIG_APP_LODGED&&s.length>0?"Atleast one of the selected candidates are ECNR, and does not need Emigration formalities":n===this.SEQUENCE_TRAVEL_BOOKED&&0===s.length?"Emigration Clearance can be bye-passed only for ECNR candidates":"";break;case this.SEQUENCE_EMIG_APP_LODGED:d=n!==this.SEQUENCE_EMIG_DOC_LODGED?"Sequence to follow Emigration application Lodgement is":"EMIGRATION Documents Lodgement";break;case this.SEQUENCE_EMIG_DOC_LODGED:d=n===this.SEQUENCE_EMIG_CLEARED||n===this.SEQUENCE_EMIG_DENIED?"":"Sequence after Emigration Document Lodgement is eithr Emigration Cleared Or Emigration Denied";break;case this.SEQUENCE_TRAVEL_BOOKED:d=n===this.SEQUENCE_TRAVELED?"":"Sequence after Travel booked is TRAVELED"}return d}navigateByRoute(t,n,i,a){this.router.navigate([n+"/"+t],{state:{user:this.user,toedit:i,returnUrl:"/processing/list",depStages:a}})}getNextSeqForNextTransaction(t){var n=this.depStatuses.find(i=>i.sequence==t)?.nextSequence??0;return console.log("Next Sequence for next Transaction:",n),n}getSequenceForNextTransaction(t){var n=this.findMaxSeq(t),i=this.depStatuses.find(a=>a.sequence==n)?.nextSequence;return i??0}findMaxSeq(t){return t.deploySequence}getNextStageDateForNextTransaction(t,n){var i=new Date(t.currentSeqDate),a=this.depStatuses.find(s=>s.sequence==n)?.workingDaysReqdForNextStage;return new Date(i.setDate(i.getDate()+a))}selectionChanged(t){if(void 0!==t){var n;n=!0!==t.checked;var i=this.deploysSelected.findIndex(a=>a.depId===t.depId);n?this.deploysSelected.push(t):this.deploysSelected.splice(i,1)}}getTravellingTicket(){var t=new Date;t.setDate(t.getDate()+4),this.bsModalRef=this.bsModalService.show(U,{class:"modal-dialog-centered modal-lg",initialState:{flightData:{eTD_Boarding:t,eTA_Destination:t,airlineName:"Air India",airportOfBoarding:"Mumbai",airportOfDestination:"Jeddah",flightNo:"AI-823",eTA_Via:null,eTD_Via:null,flightNoVia:"",airportVia:"",airlineVia:"",eTA_DestinationString:"",eTD_BoardingString:"",eTA_ViaString:"",eTD_ViaString:""}}}),this.bsModalRef.content.candidateFlightEvent.subscribe({next:a=>a,error:a=>{console.log(a)}})}verifyTransactionData(){if(0===this.sequenceSelected)return"Please select the deployment transaction you want to apply";if(0===this.deploysSelected.length)return"Please select the items that you want to apply the transactions";const n=[...new Set(this.deploysSelected.map(r=>r.deploySequence))];if(n.length>1)return"You can apply a common next sequence to items having same current sequence";if([...new Set(this.deploysSelected.map(r=>r.deploySequence))].length>1)return"You may not select items having different values of ECNR - if an item has ECNR = true, then there are different yard stick available for next sequence applicability";var a=this.verifyNextSequence(n[0],this.sequenceSelected);if(""!==a)return a;var s=[...new Set(this.deploysSelected.map(r=>r.cityOfWorking))];if(1300===this.sequenceSelected&&s.length>1)return"The deployment items selected by you have more than one destination airports to travel to. Pl select the group with common destination airport, with common airport of Departure also.  Else, choose one candidate at a time";const d=new Date(Math.max(...this.deploysSelected.map(r=>r.transactionDate.getTime())));return d>this.transDate?"The selected Transaction date '"+this.transDate+"' is earlier than the last recorded transaction date  of "+d:""}constructDepItemsToAdd(){var t=[];return this.deploysSelected.forEach(n=>{t.push({id:0,depId:n.depId,transactionDate:this.transDate,sequence:this.sequenceSelected,nextSequence:0,fullPath:""})}),t}applyTransactions(){var t=this.verifyTransactionData();if(""!==t)return this.toastr.warning(t,"Error in the proposed transactions"),t;let n=this.constructDepItemsToAdd();if(null===n||0===n.length)return"failed to construct Dep Items";if(this.sequenceSelected===this.SEQUENCE_TRAVEL_BOOKED){var i=[];this.deploysSelected.forEach(p=>{i.push({candidateName:p.candidateName,applicationNo:p.applicationNo,depId:p.depId,cvRefId:p.cvRefId,customerName:p.customerName,customerCity:p.cityOfWorking,id:0,depItemId:0,categoryName:p.categoryName})});var a=this.transDate;this.bsModalRef=this.bsModalService.show(U,{class:"modal-dialog-centered modal-lg",initialState:{flightData:{eTD_Boarding:a,eTA_Destination:a,airlineName:"Air India",airportOfBoarding:"Mumbai",airportOfDestination:this.deploysSelected[0].cityOfWorking,flightNo:"AI-823",eTA_Via:null,eTD_Via:null,flightNoVia:"",airportVia:"",airlineVia:"",eTA_DestinationString:"",eTD_BoardingString:"",eTA_ViaString:"",eTD_ViaString:""}}}),this.bsModalRef.content.candidateFlightEvent.pipe((0,D.h)(p=>null!==p),(0,x.w)(p=>(console.log("flightdata received back from modal:",p),this.deploysSelected.forEach(Ae=>{this.candFlight={id:0,dateOfFlight:p.eTD_Boarding,airlineName:p.airlineName,flightNo:p.flightNo,airportOfBoarding:p.airportOfBoarding,airportOfDestination:p.airportOfDestination,eTA_Destination:p.eTA_Destination,fullPath:"",fileToUpload:null,orderNo:Ae.orderNo,candidateFlightItems:i,customerId:0,eTD_Boarding:p.eTD_Boarding,eTD_BoardingString:p.eTD_BoardingString,eTA_DestinationString:p.eTA_DestinationString,flightNoVia:p.flightNoVia,airportVia:p.airportVia,eTA_Via:p.eTD_Via,eTA_ViaString:p.eTA_ViaString,eTD_ViaString:p.eTD_ViaString}}),this.service.InsertDepItemsAndCandFlights({candFlightToAdd:this.candFlight,depItemsToAdd:n})))).subscribe(p=>{p.length>1&&this.UpdateDeploymentDOM(p)})}else this.service.InsertDepItems(n).subscribe({next:d=>null===d||0===d.length?(this.toastr.warning("Failed to insert","Failed to insert any dep Transaction"),this.sequenceSelected=-1,n=[],this.deploys.forEach(r=>{}),"failed to insert dep transaactions"):(this.UpdateDeploymentDOM(d),""),error:d=>this.toastr.error(d.error.details,"Error encountered")});return""}UpdateDeploymentDOM(t){for(const i of t){var n=this.deploys.findIndex(a=>a.depId==i.depId);-1!==n&&(this.deploys[n]=i,this.newSequence.next(i.deploySequence),i.checked=!1)}this.deploysSelected=[],this.sequenceSelected=-1,this.toastr.success("Success","Inserted "+t.length+" number of deployment transactions")}selected(t){this.sequenceSelected=t}showTicketClicked(t){}candidateFlightDelete(t){this.service.deleteCandidateFlight(t).subscribe(i=>{i?this.toastr.success("Candidate Flight Detail deleted","Deleted successfully"):this.toastr.warning("Failed to delete the Candidate Flight","Failed to delete")})}candidateFlightEdit(t){null!=t?this.service.editCandidateFlight(t).subscribe({next:i=>{""==i?this.toastr.success("The Candidate Flight was successfully updated","Success"):this.toastr.warning(i,"failed to update the candidate flight object")}}):this.toastr.warning("null object received from CAndidate Flight modal")}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(f._W),e.Y36(v.z),e.Y36(b.tT),e.Y36(m.gz),e.Y36(h),e.Y36(m.F0))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-deploy-listing"]],viewQuery:function(n,i){if(1&n&&e.Gf(de,5),2&n){let a;e.iGM(a=e.CRH())&&(i.searchTerm=a.first)}},inputs:{EditDepEvent:"EditDepEvent"},decls:53,vars:14,consts:[[2,"display","inline-block","width","150px","margin-left","50px","vertical-align","top","word-wrap","break-word"],["style","display: inline-block; margin-left: 15px; vertical-align: top;",4,"ngIf"],[2,"display","inline-block","vertical-align","top","font-size","small","font-size","bold","margin-left","5px"],["bindLabel","name","bindValue","value","labelForId","value","clearAllText","Clear","title","select a search option - then, enter the search value in the search box","placeholder","Select a Status",2,"display","inline-block","vertical-align","top","width","150px","font-size","small","margin-left","20px","vertical-align","top",3,"items","ngModel","selected","ngModelChange","clear"],["type","text","title","enter a value against the search option selected","placeholder","Search Value",1,"stdd","form-control","w100",2,"margin-left","25px !important",3,"keyup.enter"],["search",""],[2,"font-size","small","display","inline-block","font-weight","bold","margin-left","10px","vertical-align","top"],["type","radio","id","deployStatus","value","concluded","checked","true",1,"form-check-input","w20","hAlignCenter",2,"margin-left","10px","border-color","black","display","inline-block","vertical-align","top",3,"ngModel","ngModelChange"],[2,"vertical-align","top","font-size","small"],["type","radio","id","deployStatus","value","all",1,"form-check-input","w20","hAlignCenter",2,"margin-left","10px","border-color","black","display","inline-block","vertical-align","top",3,"ngModel","ngModelChange"],[1,"btn","mx-3","w20","fa","fa-search","fa-2x",2,"color","aliceblue","vertical-align","top",3,"click"],["title","select a status to add new transaction for the candidates selected",2,"display","inline-block","margin-left","10px","font-size","small","font-weight","bold","vertical-align","top"],["bindLabel","name","bindValue","id","labelForId","id","clearAllText","Clear","title","select a status for adding new deployment transactions","placeholder","Select a Status",2,"display","inline-block","border-style","solid","width","200px","font-size","small","margin-left","10px","vertical-align","top",3,"items","ngModel","selected","ngModelChange"],["type","text","placeholder","Order Date","bsDatepicker","",1,"stdd","w110","mx-2",3,"ngModel","bsValue","bsConfig","ngModelChange"],["title","Press to insert transactions for the items selected",1,"btn","w20","fa","fa-check","fa-2x","mx-1",2,"color","aliceblue","display","inline-block",3,"click"],[1,"btn","w20","fa","fa-refresh","fa-2x",2,"color","aliceblue","margin-left","250px",3,"click"],["title","List of deployment status","routerLink","/deployment/deployStatus",1,"btn","w20","mx-1",2,"color","aliceblue"],["title","return to Main Menu","routerLink","/",1,"btn","w20","fa","fa-window-close","fa-2x","mx-2",2,"color","aliceblue","display","inline-block"],[1,"my-2",2,"margin-left","25px"],[1,"stdd","w50"],[1,"stdd","w150"],[1,"stdd","w75"],[1,"stdd","w150","mx-2"],[4,"ngIf"],[4,"ngFor","ngForOf"],[2,"display","inline-block","margin-left","15px","vertical-align","top"],["previousText","\u2039","nextText","\u203a","firstText","\xab","lastText","\xbb",2,"display","inline-block",3,"totalItems","itemsPerPage","maxSize","pageChanged"],[3,"dep","editDepEvent","selectedEvent","showTicket","candidateFlightDeleteEvent","candidteFlightEditEvent","editAttachmentEvent"]],template:function(n,i){1&n&&(e.TgZ(0,"h4",0),e._uU(1),e.qZA(),e.YNc(2,re,3,3,"div",1),e.TgZ(3,"label",2),e._uU(4,"Search:"),e.qZA(),e.TgZ(5,"ng-select",3),e.NdJ("selected",function(s){return i.onOptionSelected(s)})("ngModelChange",function(s){return i.optionSelected=s})("clear",function(){return i.optionCleared()}),e.qZA(),e.TgZ(6,"input",4,5),e.NdJ("keyup.enter",function(){return i.onSearch()}),e.qZA(),e.TgZ(8,"label",6),e._uU(9,"Status"),e.qZA(),e.TgZ(10,"input",7),e.NdJ("ngModelChange",function(s){return i.deployStatus=s}),e.qZA(),e.TgZ(11,"span",8),e._uU(12,"Concluded"),e.qZA(),e.TgZ(13,"input",9),e.NdJ("ngModelChange",function(s){return i.deployStatus=s}),e.qZA(),e.TgZ(14,"span",8),e._uU(15,"All"),e.qZA(),e.TgZ(16,"button",10),e.NdJ("click",function(){return i.onSearch()}),e.qZA(),e._UZ(17,"br"),e.TgZ(18,"label",11),e._uU(19,"add new transaction"),e.qZA(),e.TgZ(20,"ng-select",12),e.NdJ("selected",function(s){return i.selected(s)})("ngModelChange",function(s){return i.sequenceSelected=s}),e.qZA(),e.TgZ(21,"input",13),e.NdJ("ngModelChange",function(s){return i.transDate=s}),e.qZA(),e.TgZ(22,"button",14),e.NdJ("click",function(){return i.applyTransactions()}),e.qZA(),e.TgZ(23,"button",15),e.NdJ("click",function(){return i.onReset()}),e.qZA(),e.TgZ(24,"button",16)(25,"mat-icon"),e._uU(26,"receipt"),e.qZA()(),e._UZ(27,"button",17),e.TgZ(28,"div",18)(29,"label",19),e._uU(30,"Sel"),e.qZA(),e.TgZ(31,"label",19),e._uU(32,"App#"),e.qZA(),e.TgZ(33,"label",20),e._uU(34,"Candidate Name"),e.qZA(),e.TgZ(35,"label",20),e._uU(36,"Customer Name"),e.qZA(),e.TgZ(37,"label",19),e._uU(38,"Order#"),e.qZA(),e.TgZ(39,"label",20),e._uU(40,"Category"),e.qZA(),e.TgZ(41,"label",21),e._uU(42,"Referred On"),e.qZA(),e.TgZ(43,"label",21),e._uU(44,"Selected On"),e.qZA(),e.TgZ(45,"label",22),e._uU(46,"Current Dep Status"),e.qZA(),e.TgZ(47,"label",20),e._uU(48,"Next Dep Status"),e.qZA(),e.TgZ(49,"label",21),e._uU(50,"Estimated Dt"),e.qZA()(),e.YNc(51,ce,2,0,"div",23),e.YNc(52,pe,2,1,"div",24)),2&n&&(e.xp6(1),e.Oqu(i.title),e.xp6(1),e.Q6J("ngIf",i.deploys&&i.pagination),e.xp6(3),e.Q6J("items",i.searchOptions)("ngModel",i.optionSelected),e.xp6(5),e.Q6J("ngModel",i.deployStatus),e.xp6(3),e.Q6J("ngModel",i.deployStatus),e.xp6(7),e.Q6J("items",i.statusNameAndSeq)("ngModel",i.sequenceSelected),e.xp6(1),e.Q6J("ngModel",i.transDate)("bsValue",i.bsValueDate)("bsConfig",e.DdM(13,ue)),e.xp6(30),e.Q6J("ngIf",!i.deploys),e.xp6(1),e.Q6J("ngForOf",i.deploys))},dependencies:[g.sg,g.O5,_.Np,_.Y5,k.Qt,l.Fj,l._,l.JJ,l.On,T.w9,m.rH,P.Hw,le],styles:[".stdd[_ngcontent-%COMP%]{display:inline-block;margin:1px 0;vertical-align:top;word-wrap:break-word;font-size:small}.fSmall[_ngcontent-%COMP%]{font-size:small}.fSmaller[_ngcontent-%COMP%]{font-size:smaller}.hAlignCenter[_ngcontent-%COMP%]{text-align:center}.w20[_ngcontent-%COMP%]{width:20px}.w50[_ngcontent-%COMP%]{width:50px}.w75[_ngcontent-%COMP%]{width:75px;font-size:smaller!important}.w100[_ngcontent-%COMP%]{width:100px}.w110[_ngcontent-%COMP%]{width:110px}.w125[_ngcontent-%COMP%]{width:125px}.w150[_ngcontent-%COMP%]{width:150px}.w175[_ngcontent-%COMP%]{width:175px}.w200[_ngcontent-%COMP%]{width:200px}.w250[_ngcontent-%COMP%]{width:250px}.b[_ngcontent-%COMP%]{font-weight:700}.green[_ngcontent-%COMP%]{color:#006400}  .ng-select .ng-select-container,   .ng-select.ng-select-single .ng-select-container{min-height:25px;font-size:.8em;font-weight:400}"]})}return o})();function me(o,c){if(1&o&&(e.TgZ(0,"div")(1,"div",6),e._uU(2),e.qZA(),e.TgZ(3,"div",7),e._uU(4),e.qZA(),e.TgZ(5,"div",8),e._uU(6),e.qZA(),e.TgZ(7,"div",9),e._uU(8),e.qZA(),e.TgZ(9,"div",6),e._uU(10),e.qZA(),e.TgZ(11,"div",7),e._uU(12),e.qZA()()),2&o){const t=c.$implicit,n=e.oxw();e.xp6(2),e.Oqu(t.sequence),e.xp6(2),e.Oqu(t.statusName),e.xp6(2),e.Oqu(t.workingDaysReqdForNextStage),e.xp6(2),e.Oqu(t.isOptional?"Yes":"No"),e.xp6(2),e.Oqu(t.nextSequence),e.xp6(2),e.Oqu(n.getSeqNameFromSeq(t.nextSequence))}}let _e=(()=>{class o{constructor(t){this.activatedRoute=t,this.status=[]}ngOnInit(){this.activatedRoute.data.subscribe({next:t=>{this.status=t.statuslist}})}getSeqNameFromSeq(t){var n=this.status.findIndex(i=>i.sequence==t);return-1===n?"Invalid Seq":this.status[n].statusName}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(m.gz))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-deploy-status-list"]],decls:19,vars:1,consts:[[1,"lbl"],["routerLink","/",1,"btn","fa","fa-window-close","fa-2x","cursorpointer"],[1,"lbl","w75"],[1,"lbl","w250"],[1,"lbl","w100"],[4,"ngFor","ngForOf"],[1,"w75","tAlignRight"],[1,"stdd","w250"],[1,"stdd","w100"],[1,"stdd","w75"]],template:function(n,i){1&n&&(e.TgZ(0,"h4",0),e._uU(1,"Deployment Status with Sequence Numbers"),e.qZA(),e._UZ(2,"button",1)(3,"br"),e.TgZ(4,"label",2),e._uU(5,"Sequence No"),e.qZA(),e.TgZ(6,"label",3),e._uU(7,"Deployment Status"),e.qZA(),e.TgZ(8,"label",4),e._uU(9,"Estimated days"),e._UZ(10,"br"),e._uU(11,"for this Sequence"),e.qZA(),e.TgZ(12,"label",2),e._uU(13,"Optional"),e.qZA(),e.TgZ(14,"label",2),e._uU(15,"Next Sequence"),e.qZA(),e.TgZ(16,"label",3),e._uU(17,"Next Status Name"),e.qZA(),e.YNc(18,me,13,6,"div",5)),2&n&&(e.xp6(18),e.Q6J("ngForOf",i.status))},dependencies:[g.sg,m.rH],styles:[".w75[_ngcontent-%COMP%]{width:75px}.w100[_ngcontent-%COMP%]{width:100px}.w250[_ngcontent-%COMP%]{width:250px}.lbl[_ngcontent-%COMP%]{display:inline-block;font-size:small;font-weight:700;margin:2px;vertical-align:middle}.tAlignRight[_ngcontent-%COMP%]{display:inline-block;text-align:right;margin:2px 6px 2px 2px;padding-right:4px}.stdd[_ngcontent-%COMP%]{display:inline-block;font-size:small;margin:2px;vertical-align:top}.cursorpointer[_ngcontent-%COMP%]{cursor:pointer;color:#00008b;font-weight:700}"]})}return o})();function ve(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.bExpand=!1)}),e.qZA()}}function Ce(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"button",11),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.bExpand=!0)}),e.qZA()}}function be(o,c){if(1&o&&(e.TgZ(0,"div")(1,"div",16),e._uU(2),e.qZA(),e.TgZ(3,"div",17),e._uU(4),e.qZA(),e.TgZ(5,"div",18),e._uU(6),e.qZA()()),2&o){const t=c.$implicit,n=c.index;e.xp6(2),e.Oqu(n+1),e.xp6(2),e.Oqu(t.applicationNo),e.xp6(2),e.Oqu(t.candidateName)}}function De(o,c){if(1&o&&(e.TgZ(0,"div")(1,"label",12),e._uU(2,"Sr No"),e.qZA(),e.TgZ(3,"label",13),e._uU(4,"App No"),e.qZA(),e.TgZ(5,"label",14),e._uU(6,"Candidate Name"),e.qZA(),e.YNc(7,be,7,3,"div",15),e.qZA()),2&o){const t=e.oxw(2);e.xp6(7),e.Q6J("ngForOf",t.dto.candidateFlightItems)}}function xe(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"div"),e.YNc(1,ve,1,0,"button",1),e.YNc(2,Ce,1,0,"button",2),e.TgZ(3,"div",3),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"div",4),e._uU(7),e.qZA(),e.TgZ(8,"div",5),e._uU(9),e.qZA(),e.TgZ(10,"div",3),e._uU(11),e.qZA(),e.TgZ(12,"div",3),e._uU(13),e.ALo(14,"date"),e.qZA(),e.TgZ(15,"div",3),e._uU(16),e.qZA(),e.TgZ(17,"div",6),e._uU(18),e.qZA(),e.TgZ(19,"button",7),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.editClicked())}),e.qZA(),e.TgZ(20,"button",8),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.travelAdviseClicked())}),e.qZA(),e.TgZ(21,"button",9),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.deleteClicked())}),e.qZA(),e.YNc(22,De,8,1,"div",0),e.qZA()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.bExpand),e.xp6(1),e.Q6J("ngIf",!t.bExpand),e.xp6(2),e.Oqu(e.xi3(5,10,t.dto.dateOfFlight,"dd-MMM-yy")),e.xp6(3),e.Oqu(t.dto.airportOfBoarding),e.xp6(2),e.Oqu(t.dto.airportOfDestination),e.xp6(2),e.Oqu(t.dto.airlineName),e.xp6(2),e.Oqu(e.xi3(14,13,t.dto.eTD_Boarding,"dd-MMM-yy")),e.xp6(3),e.Oqu(t.dto.eTA_Destination),e.xp6(2),e.Oqu(t.dto.candidateFlightItems.length),e.xp6(4),e.Q6J("ngIf",t.bExpand)}}let ye=(()=>{class o{constructor(t){this.service=t,this.flightCandidates=[],this.editEvent=new e.vpe,this.deleteEvent=new e.vpe,this.travelAdviseEvent=new e.vpe,this.selectedEvent=new e.vpe,this.bExpand=!1}ngOnInit(){console.log(this.dto)}editClicked(){this.editEvent.emit(this.dto.id)}deleteClicked(){this.deleteEvent.emit(this.dto.id)}travelAdviseClicked(){this.travelAdviseEvent.emit(this.dto?.id)}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(h))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-candidate-flight-item"]],inputs:{dto:"dto"},outputs:{editEvent:"editEvent",deleteEvent:"deleteEvent",travelAdviseEvent:"travelAdviseEvent",selectedEvent:"selectedEvent"},decls:1,vars:1,consts:[[4,"ngIf"],["class","btn fa fa-minus","style","color:aqua;",3,"click",4,"ngIf"],["class","btn fa fa-plus","style","color:aqua;",3,"click",4,"ngIf"],[1,"stdd","w120"],[1,"stdd","w150","cursorPointer"],[1,"stdd","w150"],[1,"stdd","w50"],["title","edit this Flight",1,"btn","w25","fa","fa-pencil",2,"color","aliceblue",3,"click"],["title","edit this Flight",1,"btn","w25","fa","fa-envelope",2,"color","aliceblue",3,"click"],["title","delete this customer",1,"btn","w25","fa","fa-trash","red",2,"color","red",3,"click"],[1,"btn","fa","fa-minus",2,"color","aqua",3,"click"],[1,"btn","fa","fa-plus",2,"color","aqua",3,"click"],[1,"cand","w50","b",2,"margin-left","100px !important"],[1,"cand","w100","b",2,"margin-left","15px !important"],[1,"cand","w150","b"],[4,"ngFor","ngForOf"],[1,"cand","w50",2,"margin-left","100px !important","text-align","right"],[1,"cand","w100",2,"margin-left","50px !important"],[1,"cand","w150"]],template:function(n,i){1&n&&e.YNc(0,xe,23,16,"div",0),2&n&&e.Q6J("ngIf",i.dto)},dependencies:[g.sg,g.O5,g.uU],styles:[".stdd[_ngcontent-%COMP%]{display:inline-block;font-size:small;margin-left:2px;margin-right:2px;vertical-align:top}.cand[_ngcontent-%COMP%]{display:inline-block;font-size:smaller;margin-left:2px;margin-right:2px;vertical-align:top;color:#0ff}.w15[_ngcontent-%COMP%]{width:15px}.w25[_ngcontent-%COMP%]{width:25px}.w100[_ngcontent-%COMP%]{width:100px}.w120[_ngcontent-%COMP%]{width:120px}.w150[_ngcontent-%COMP%]{width:150px}.mL50[_ngcontent-%COMP%]{margin-left:50px!important}.mL100[_ngcontent-%COMP%]{margin-left:10ppx!important}.b[_ngcontent-%COMP%]{font-weight:700}"]})}return o})();function we(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"pagination",14),e.NdJ("pageChanged",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.onPageChanged(i))}),e._uU(1,"\n>"),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("totalItems",t.pagination.totalItems)("itemsPerPage",t.pagination.itemsPerPage)("maxSize",10)}}function Te(o,c){1&o&&(e.TgZ(0,"div"),e._uU(1," No matching Candidate Flights on record\n"),e.qZA())}function Se(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"app-candidate-flight-item",15),e.NdJ("deleteEvent",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.deleteClicked(i))})("editEvent",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.editClicked(i))})("travelAdviseEvent",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.travelAdviseClicked(i))}),e.qZA()()}if(2&o){const t=c.$implicit;e.xp6(1),e.Q6J("dto",t)}}const Me=[{path:"",component:ge,resolve:{statusNameAndSeq:()=>(0,e.f3M)(h).getDepStatusAndNames()}},{path:"candidateflights",component:(()=>{class o{constructor(t,n,i,a){this.service=t,this.router=n,this.confirm=i,this.toastr=a,this.cFlights=[],this.totalCount=0,this.fParams=new A}ngOnInit(){this.loadFlights()}loadFlights(){var t=this.service.getFlightParams();this.service.getCandidateFlightHeadersPagedList(t)?.subscribe({next:n=>{null!=n&&(this.cFlights=n.result,this.totalCount=n?.count,this.pagination=n.pagination)},error:n=>console.log(n)})}travelAdviseClicked(t){this.service.composeTravelAdviseForClient(+t).subscribe({next:i=>{console.log("response",i),this.toastr.success(i,"Success")},error:i=>this.toastr.error(i.error.details,"Error encountered")})}onPageChanged(t){const n=this.service.getFlightParams();n.pageNumber!==t&&(n.pageNumber=t.page,this.service.setFlightParams(n),this.loadFlights())}deleteClicked(t){var n=t;const a=this.service.deleteCandidateFlight(n);this.confirm.confirm("confirm Delete","confirm delete this Candidate Flight?. WARNING: this will also delete the flight transaction, and cannot be undone").pipe((0,D.h)(d=>d),(0,x.w)(d=>a)).subscribe(d=>{if(d){this.toastr.success("Flight data deleted for the chosen candidate","deletion successful");var r=this.cFlights.findIndex(p=>p.id==n);r>=0&&this.cFlights.splice(r,1)}else this.toastr.error("Error in deleting the candidate Flight data","failed to delete")})}editClicked(t){}onReset(){this.fParams=new A,this.service.setFlightParams(this.fParams),this.loadFlights()}applyParams(){this.service.setFlightParams(this.fParams),this.loadFlights()}close(){this.router.navigateByUrl("/")}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(h),e.Y36(m.F0),e.Y36(v.z),e.Y36(f._W))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-candidate-flight-header"]],decls:32,vars:5,consts:[[1,"mx-4",2,"display","inline-block"],["class","stdd mx-3","previousText","\u2039","nextText","\u203a","firstText","\xab","lastText","\xbb",3,"totalItems","itemsPerPage","maxSize","pageChanged",4,"ngIf"],[1,"lbl","w150"],[1,"lbl","w75"],["id","orderNo","name","orderNo",1,"stdd","w75",3,"ngModel","ngModelChange"],[1,"lbl","w100","mL25"],["title","retrieves records from database based upon value selected",1,"btn","fa","fa-check","mL25",3,"click"],["title","resets search parameters",1,"btn","btn-outline-success","fa","fa-refresh","mx-1",3,"click"],["title","close this page",1,"btn","btn-outline-success","mx-2","fa","fa-window-close","fa-2x",3,"click"],[1,"my-0"],[1,"lbl","w120",2,"margin-left","25px !important"],[1,"lbl","w120"],[4,"ngIf"],[4,"ngFor","ngForOf"],["previousText","\u2039","nextText","\u203a","firstText","\xab","lastText","\xbb",1,"stdd","mx-3",3,"totalItems","itemsPerPage","maxSize","pageChanged"],[3,"dto","deleteEvent","editEvent","travelAdviseEvent"]],template:function(n,i){1&n&&(e.TgZ(0,"h4",0),e._uU(1,"Candidate Flight details"),e.qZA(),e.YNc(2,we,2,3,"pagination",1),e.TgZ(3,"span",2),e._uU(4,"Search Parameters"),e.qZA(),e.TgZ(5,"span",3),e._uU(6,"Order No"),e.qZA(),e.TgZ(7,"input",4),e.NdJ("ngModelChange",function(s){return i.fParams.orderNo=s}),e.qZA(),e.TgZ(8,"span",5),e._uU(9,"Category Ref"),e.qZA(),e.TgZ(10,"input",4),e.NdJ("ngModelChange",function(s){return i.fParams.orderItemId=s}),e.qZA(),e.TgZ(11,"button",6),e.NdJ("click",function(){return i.applyParams()}),e.qZA(),e.TgZ(12,"button",7),e.NdJ("click",function(){return i.onReset()}),e.qZA(),e.TgZ(13,"button",8),e.NdJ("click",function(){return i.close()}),e.qZA(),e._UZ(14,"hr",9),e.TgZ(15,"label",10),e._uU(16,"Flight Date"),e.qZA(),e.TgZ(17,"label",2),e._uU(18,"Airport of Boarding"),e.qZA(),e.TgZ(19,"label",2),e._uU(20,"Airport of Destination"),e.qZA(),e.TgZ(21,"label",11),e._uU(22,"Airline"),e.qZA(),e.TgZ(23,"label",11),e._uU(24,"ETD"),e.qZA(),e.TgZ(25,"label",11),e._uU(26,"ETA"),e.qZA(),e.TgZ(27,"label",3),e._uU(28,"Ct of Pax"),e.qZA(),e._UZ(29,"hr"),e.YNc(30,Te,2,0,"div",12),e.YNc(31,Se,2,1,"div",13)),2&n&&(e.xp6(2),e.Q6J("ngIf",void 0!==i.pagination),e.xp6(5),e.Q6J("ngModel",i.fParams.orderNo),e.xp6(3),e.Q6J("ngModel",i.fParams.orderItemId),e.xp6(20),e.Q6J("ngIf",!i.cFlights),e.xp6(1),e.Q6J("ngForOf",i.cFlights))},dependencies:[g.sg,g.O5,k.Qt,l.Fj,l.JJ,l.On,ye],styles:[".lbl[_ngcontent-%COMP%]{display:inline-block;font-size:small;margin-left:2px;margin-right:2px;vertical-align:middle;font-weight:700}.stdd[_ngcontent-%COMP%]{display:inline-block;font-size:small;margin-left:2px;margin-right:2px;vertical-align:middle}.w25[_ngcontent-%COMP%]{width:25px}.w75[_ngcontent-%COMP%]{width:75px}.w100[_ngcontent-%COMP%]{width:100px}.w120[_ngcontent-%COMP%]{width:120px}.w150[_ngcontent-%COMP%]{width:150px}.mL25[_ngcontent-%COMP%]{margin-left:25px}"]})}return o})()},{path:"deployStatus",component:_e,resolve:{statuslist:()=>(0,e.f3M)(h).getDeployStatuses()}}];let Ne=(()=>{class o{static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275mod=e.oAB({type:o});static#n=this.\u0275inj=e.cJS({imports:[g.ez,m.Bz.forChild(Me),m.Bz]})}return o})(),qe=(()=>{class o{static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275mod=e.oAB({type:o});static#n=this.\u0275inj=e.cJS({imports:[g.ez,R.m,Ne,P.Ps]})}return o})()}}]);