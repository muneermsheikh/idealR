"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[777],{7440:(E,C,r)=>{r.d(C,{S:()=>h});var t=r(2771),o=r(7673),b=r(6354),v=r(3587),u=r(6220),_=r(7705),m=r(1626);let h=(()=>{class c{constructor(n){this.http=n,this.apiUrl=v.c.apiUrl,this.currentUserSource=new t.m(1),this.currentUser$=this.currentUserSource.asObservable(),this.cache=new Map,this.callRecordStatus=[{status:"wrong number"},{status:"Not Responding"},{status:"Will Revert later"},{status:"Declined-Family issues"},{status:"Declined for overseas"},{status:"Declined-Low remuneration"},{status:"Declined - SC Not agreed"},{status:"Interested - to negotiate remuneration"},{status:"Interested, and keen"},{status:"Interested, but doubtful"},{status:"Declined - other reasons"}]}getHistories(n){const l=this.cache.get(Object.values(n).join("-"));if(l)return(0,o.of)(l);let g=(0,u.Xn)(n);return(0,u.f8)(this.apiUrl+"userHistory/pagedlist",g,this.http).pipe((0,b.T)(R=>(this.cache.set(Object.values(n).join("-"),R),R)))}getCallRecordReport(n){let l=(0,u.Xn)(n);return this.http.get(this.apiUrl+"CallRecord/report",{params:l})}getCallRecordWithItems(n,l){return this.http.get(this.apiUrl+"CallRecord/callRecordWithItems/"+n+"/"+l)}getCallRecordStatus(){return this.callRecordStatus}updateHistoryItem(n){return this.http.post(this.apiUrl+"userHistory/userhistoryitem",n)}insertNewCallRecordItem(n){return this.http.post(this.apiUrl+"CallRecord/CallRecorditem",n)}setParams(n){this.hParams=n}getParams(){return this.hParams}updateCallRecord(n){return this.http.put(this.apiUrl+"CallRecord",n)}updateCallRecordObject(n){return this.http.put(this.apiUrl+"CallRecord/UpdateNewItem",n)}updateCallRecordItem(n){return console.log("updatecallrecorditem, model"),this.http.put(this.apiUrl+"CallRecord/InsertCallRecordItem",n)}deleteHistory(n){return this.http.delete(this.apiUrl+"userHistory/"+n)}deleteHistoryItem(n){return this.http.delete(this.apiUrl+"userHistory/historyItemId/"+n)}getCallRecordFromPhoneNo(n){return this.http.get(this.apiUrl+"callRecord/callRecordFromPhoneNo/"+n)}getCallRecordsOfACandidate(n,l){return this.http.get(this.apiUrl+"callRecord/CallRecordSummary/"+n+"/"+l)}static#t=this.\u0275fac=function(l){return new(l||c)(_.KVO(m.Qq))};static#e=this.\u0275prov=_.jDH({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})()},2777:(E,C,r)=>{r.d(C,{J:()=>M});var t=r(7705),o=r(9417),b=r(779),v=r(8256),u=r(778),_=r(7440),m=r(177),h=r(9375),c=r(2510),O=r(6295);function n(a,f){1&a&&(t.j41(0,"div",34),t.EFF(1," Contact Result not selected "),t.k0s())}function l(a,f){if(1&a&&(t.j41(0,"div"),t.DNE(1,n,2,0,"div",33),t.k0s()),2&a){const e=t.XpG(3);t.R7$(1),t.Y8G("ngIf",e.form.controls.contactResult.touched&&e.form.controls.contactResult.invalid&&e.form.controls.contactResult.errors&&e.form.controls.contactResult.errors.required)}}const g=function(){return{dateInputFormat:"YYYY-MM-DD"}};function R(a,f){if(1&a){const e=t.RV6();t.j41(0,"div")(1,"div",23),t.nrm(2,"input",24)(3,"app-text-input",25)(4,"app-text-input",26),t.j41(5,"ng-select",27),t.bIt("change",function(i){const p=t.eBV(e).index,D=t.XpG(2);return t.Njj(D.contactResultChanged(i,p))}),t.k0s(),t.DNE(6,l,2,1,"div",5),t.nrm(7,"ng-select",28)(8,"input",29),t.j41(9,"button",30),t.bIt("click",function(){const d=t.eBV(e).index,p=t.XpG(2);return t.Njj(p.removeDepItem(d))}),t.k0s(),t.nrm(10,"br",20),t.j41(11,"label",31),t.EFF(12,"Discussions"),t.k0s(),t.nrm(13,"app-text-input",32),t.k0s()()}if(2&a){const e=f.index,s=t.XpG(2);t.R7$(1),t.Y8G("formGroupName",e),t.R7$(1),t.Y8G("bsValue",s.bsValueDate)("bsConfig",t.lJ4(10,g)),t.R7$(2),t.Y8G("label","Phone No"),t.R7$(1),t.Y8G("items",s.contactResults),t.R7$(1),t.Y8G("ngIf",s.form.controls.contactResult),t.R7$(1),t.Y8G("items",s.nextAction),t.R7$(1),t.Y8G("bsValue",s.bsValueDate)("bsConfig",t.lJ4(11,g)),t.R7$(5),t.Y8G("label","Discussions")}}function I(a,f){if(1&a){const e=t.RV6();t.j41(0,"div")(1,"form",8)(2,"label",9),t.EFF(3,"Name of the Person:"),t.k0s(),t.j41(4,"div",10),t.EFF(5),t.k0s(),t.j41(6,"label",11),t.EFF(7,"CategoryRef:"),t.k0s(),t.j41(8,"div",12),t.EFF(9),t.k0s(),t.nrm(10,"br"),t.j41(11,"label",9),t.EFF(12,"Subject:"),t.k0s(),t.j41(13,"div",10),t.EFF(14),t.k0s(),t.j41(15,"label",11),t.EFF(16,"Status:"),t.k0s(),t.j41(17,"div",13),t.EFF(18),t.k0s(),t.nrm(19,"hr",14),t.j41(20,"label",15),t.EFF(21,"Date"),t.k0s(),t.j41(22,"label",16),t.EFF(23,"In / Out"),t.k0s(),t.j41(24,"label",17),t.EFF(25,"Phone"),t.k0s(),t.j41(26,"label",18),t.EFF(27,"Result of disc"),t.k0s(),t.j41(28,"label",9),t.EFF(29,"Next action"),t.k0s(),t.j41(30,"label",16),t.EFF(31,"By"),t.k0s(),t.j41(32,"button",19),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.addCallRecordItem())}),t.k0s(),t.nrm(33,"hr",20),t.j41(34,"div",21),t.DNE(35,R,14,12,"div",22),t.k0s()()()}if(2&a){const e=t.XpG();t.R7$(1),t.Y8G("formGroup",e.form),t.R7$(4),t.JRh(e.callRecord.personName),t.R7$(4),t.JRh(e.callRecord.categoryRef),t.R7$(5),t.JRh(e.callRecord.subject),t.R7$(4),t.JRh(e.callRecord.status),t.R7$(17),t.Y8G("ngForOf",e.callRecordItems.controls)}}let M=(()=>{class a{constructor(e,s,i,d,p){this.bsModalRef=e,this.toastr=s,this.fb=i,this.confirm=d,this.service=p,this.passCallRecordEvent=new t.bkB,this.candidatName="",this.bsValueDate=new Date,this.bsValue=new Date,this.userName="",this.form=new o.gE({}),this.contactResults=[],this.nextAction=[{status:"Call again"},{status:"Correct Phone No"},{status:"Escalate To Supervisor"},{status:"Conclude"}],this.advisoriesBy=[{status:"Mail"},{status:"SMS"},{status:"Both"}],this.inOutList=[{status:"In"},{status:"Out"}],this.contactResults=this.service.getCallRecordStatus()}ngOnInit(){this.callRecord&&this.InitializeForm(this.callRecord)}InitializeForm(e){this.form=this.fb.group({id:e.id,categoryRef:e.categoryRef,personId:[e.personId,o.k0.required],personName:e.personName,personType:e.personType,username:[e.username??this.userName],status:e.status,statusDate:e.statusDate,email:e.Email,phoneNo:e.phoneNo,subject:[e.subject,o.k0.required],concludedOn:e.concludedOn,callRecordItems:this.fb.array(e.callRecordItems.map(s=>this.fb.group({id:s.id,callRecordId:s.callRecordId,incomingOutgoing:[s.incomingOutgoing,[o.k0.required,o.k0.maxLength(3)]],dateOfContact:[s.dateOfContact,o.k0.required],username:[s.username??this.userName],phoneNo:s.phoneNo,contactResult:[s.contactResult,o.k0.required],gistOfDiscussions:[s.gistOfDiscussions],nextAction:s.nextAction,nextActionOn:s.nextActionOn,email:s.email,advisoryBy:s.advisoryBy,composeSMS:s.advisoryBy})))})}get callRecordItems(){return this.form.get("callRecordItems")}newCallRecordItem(){var e=this.callRecordItems.at(this.callRecordItems.length-1);return this.fb.group({id:0,callRecordId:this.callRecord?.id,incomingOutgoing:["out",o.k0.required],dateOfContact:[new Date,o.k0.required],username:[this.userName??"",o.k0.required],contactResult:["",o.k0.required],gistOfDiscussions:"",advisoryBy:"mail",nextAction:"",nextActionOn:new Date,phoneNo:e.get("phoneNo")?.value,email:e.get("email")?.value})}addCallRecordItem(){this.callRecordItems.push(this.newCallRecordItem())}removeDepItem(e){this.confirm.confirm("Confirm Delete","This will also delete the selected Call Record Item. If you confirm to delete, remember to save this transaction").subscribe({next:s=>{s&&this.callRecordItems.removeAt(e)}})}updateCallRecord(){this.form.get("username")?.setValue(this.userName),this.passCallRecordEvent.emit(this.form.value),this.bsModalRef.hide()}contactResultChanged(e,s){switch(e.status.toLowerCase()){case"not responding":case"will revert later":this.callRecordItems.at(s).get("nextAction")?.setValue("Call Again");break;case"wrong number":this.callRecordItems.at(s).get("nextAction")?.setValue("Correct Phone Number");break;case"not interested":case"declined-family issues":case"declined for overseas":case"declined-low remuneration":default:this.callRecordItems.at(s).get("nextAction")?.setValue("Concluded");break;case"declined - sc not agreed":this.callRecordItems.at(s).get("nextAction")?.setValue("Escalate To Supervisor")}}close(){this.passCallRecordEvent.emit(null),this.bsModalRef.hide()}static#t=this.\u0275fac=function(s){return new(s||a)(t.rXU(b.Y$),t.rXU(v.tw),t.rXU(o.ok),t.rXU(u.G),t.rXU(_.S))};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["app-call-records-edit-modal"]],outputs:{passCallRecordEvent:"passCallRecordEvent"},decls:11,vars:4,consts:[[1,"modal-header","my-0"],[2,"font-size","bold"],[1,"btn","btn-success","w30","fa","fa-save",2,"margin-left","400px",3,"click"],[1,"btn","fa","fa-window-close","fa-2x","pull-right",3,"click"],[1,"modal-body","my-0"],[4,"ngIf"],[1,"modal-footer"],[2,"font-size","smaller"],[3,"formGroup"],[1,"lbl","w150"],[1,"stdd","w250"],[1,"lbl","w125","mL15"],[1,"stdd","w150"],[1,"stdd","w100"],[1,"my-1"],[1,"lbl","w80"],[1,"lbl","w75"],[1,"lbl","w125"],[1,"lbl","w175"],[1,"btn","w25","fa","fa-plus",3,"click"],[1,"my-0"],["formArrayName","callRecordItems"],[4,"ngFor","ngForOf"],[3,"formGroupName"],["type","text","placeholder","Date","formControlName","dateOfContact","bsDatepicker","",1,"stdd","w80","fSmaller",3,"bsValue","bsConfig"],["formControlName","incomingOutgoing",1,"stdd","fSmaller","w75"],["formControlName","phoneNo",1,"stdd","fSmallest","w125",3,"label"],["bindLabel","status","bindValue","status","labelForId","status","formControlName","contactResult",1,"select",2,"border-color","black","width","175px",3,"items","change"],["bindLabel","status","bindValue","status","labelForId","status","formControlName","nextAction",1,"select","w150",2,"border-color","black",3,"items"],["type","text","placeholder","Date","formControlName","nextActionOn","bsDatepicker","",1,"stdd","w75",3,"bsValue","bsConfig"],[1,"btn","w25","fa","fa-trash","fa-sm","red",3,"click"],[1,"stdd","fSmallest","b","w75","alignR"],["formControlName","gistOfDiscussions",1,"stdd","fSmallest","w600",3,"label"],["class","alert alert-danger",4,"ngIf"],[1,"alert","alert-danger"]],template:function(s,i){1&s&&(t.j41(0,"div",0)(1,"h4",1),t.EFF(2,"Edit Call Record"),t.k0s(),t.j41(3,"button",2),t.bIt("click",function(){return i.updateCallRecord()}),t.k0s(),t.j41(4,"button",3),t.bIt("click",function(){return i.close()}),t.k0s()(),t.j41(5,"div",4),t.DNE(6,I,36,6,"div",5),t.k0s(),t.nrm(7,"div",6),t.j41(8,"div",7),t.EFF(9),t.nI1(10,"json"),t.k0s()),2&s&&(t.R7$(6),t.Y8G("ngIf",i.callRecord),t.R7$(3),t.SpI(" ",t.bMT(10,2,i.form.value),"\n"))},dependencies:[m.Sq,m.bT,h.pc,h.p0,o.qT,o.me,o.BC,o.cb,o.j4,o.JD,o.$R,o.v8,c.vr,O.f,m.TG],styles:[".stdd[_ngcontent-%COMP%]{display:inline-block;margin-left:2px;margin-right:1px;vertical-align:top;font-size:smaller}.select[_ngcontent-%COMP%]{display:inline-block;margin-left:2px;margin-right:1px;vertical-align:top;font-size:smaller;font-weight:700}.stddY0[_ngcontent-%COMP%]{display:inline-block;margin:0 1px 0 2px;vertical-align:top}.lbl[_ngcontent-%COMP%]{display:inline-block;margin-left:2px;margin-right:1px;font-weight:700;vertical-align:top;font-size:smaller}.mL15[_ngcontent-%COMP%]{margin-left:15px!important}.mL40[_ngcontent-%COMP%]{margin-left:40px!important}.mL110[_ngcontent-%COMP%]{margin-left:110px!important}.mL460[_ngcontent-%COMP%]{margin-left:460px!important}.fSmallest[_ngcontent-%COMP%]{font-size:x-small;font-weight:700}.fSmaller[_ngcontent-%COMP%]{font-size:smaller}.b[_ngcontent-%COMP%]{font-weight:700}.red[_ngcontent-%COMP%]{color:red}.alignR[_ngcontent-%COMP%]{text-align:right}.w25[_ngcontent-%COMP%]{width:25px}.w30[_ngcontent-%COMP%]{width:30px}.w50[_ngcontent-%COMP%]{width:50px}.w75[_ngcontent-%COMP%]{width:75px}.w80[_ngcontent-%COMP%]{width:80px}.w100[_ngcontent-%COMP%]{width:100px}.w125[_ngcontent-%COMP%]{width:125px}.w150[_ngcontent-%COMP%]{width:150px}.w175[_ngcontent-%COMP%]{width:175px}.w250[_ngcontent-%COMP%]{width:250px}.w600[_ngcontent-%COMP%]{width:600px}.cursorPointer[_ngcontent-%COMP%]{cursor:pointer;color:#00008b}  .ng-select .ng-select-container,   .ng-select.ng-select-single .ng-select-container{min-height:25px;font-size:.8em;font-weight:400;width:auto!important}"]})}return a})()}}]);