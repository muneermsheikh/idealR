"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[27],{778:(T,v,r)=>{r.d(v,{G:()=>m});var o=r(7705),C=r(779);let R=(()=>{class c{constructor(l){this.bsModalRef=l,this.title="",this.message="",this.btnOkText="",this.btnCancelText="",this.result=!1}confirm(){this.result=!0,this.bsModalRef.hide()}decline(){this.bsModalRef.hide()}static#t=this.\u0275fac=function(t){return new(t||c)(o.rXU(C.Y$))};static#e=this.\u0275cmp=o.VBU({type:c,selectors:[["app-confirm-dialog"]],decls:11,vars:4,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],[1,"modal-body"],[1,"modal-footer"],["type","button",1,"btn","btn-success",3,"click"],["type","button",1,"btn","btn-danger",3,"click"]],template:function(t,d){1&t&&(o.j41(0,"div",0)(1,"h4",1),o.EFF(2),o.k0s()(),o.j41(3,"div",2)(4,"p"),o.EFF(5),o.k0s()(),o.j41(6,"div",3)(7,"button",4),o.bIt("click",function(){return d.confirm()}),o.EFF(8),o.k0s(),o.j41(9,"button",5),o.bIt("click",function(){return d.decline()}),o.EFF(10),o.k0s()()),2&t&&(o.R7$(2),o.JRh(d.title),o.R7$(3),o.JRh(d.message),o.R7$(3),o.JRh(d.btnOkText),o.R7$(2),o.JRh(d.btnCancelText))}})}return c})();var k=r(6354),F=r(3587),b=r(1626);let m=(()=>{class c{constructor(l,t){this.modalService=l,this.http=t,this.baseUrl=F.c.apiUrl}confirm(l="Confirmation",t="Are you sure you want to do this?",d="Ok",u="Cancel"){return this.bsModelRef=this.modalService.show(R,{initialState:{title:l,message:t,btnOkText:d,btnCancelText:u}}),this.bsModelRef.onHidden.pipe((0,k.T)(()=>this.bsModelRef.content.result))}getHelp(l){return this.http.get(this.baseUrl+"Help/help/"+l)}static#t=this.\u0275fac=function(t){return new(t||c)(o.KVO(C.I8),o.KVO(b.Qq))};static#e=this.\u0275prov=o.jDH({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})()},27:(T,v,r)=>{r.r(v),r.d(v,{CallRecordModule:()=>Y});var o=r(177),C=r(9485),R=r(6697),k=r(5964),F=r(5558),b=r(9437),m=r(7673),c=r(8141),U=r(2777);class l{constructor(){this.id=0,this.personType="",this.incomingOutgoing="",this.dateOfContact=new Date,this.personId="",this.mobileNo="",this.emailId="",this.categoryRef="",this.status="",this.statusClass="Active",this.username="",this.gistOfDiscussions="",this.advisoryBy="",this.nextAction="",this.nextActionOn=new Date,this.subject="",this.search="",this.sort="",this.pageNumber=1,this.pageSize=15}}var t=r(7705),d=r(2771),u=r(6354),j=r(3587),y=r(6220),M=r(1626),E=r(8256);let w=(()=>{class i{constructor(e,s){this.http=e,this.toastr=s,this.apiUrl=j.c.apiUrl,this.currentUserSource=new d.m(1),this.currentUser$=this.currentUserSource.asObservable(),this.histParams=new l,this.categoryRefDtos=[],this.cache=new Map,this.contactResults=[{status:"Not Reachable"},{status:"Wrong Number"},{status:"Declined-Family Issues"},{status:"Declined-Low Remuneration"},{status:"Declined-Other Reasons"},{status:"Will Call later"},{status:"Not interested for overseas"},{status:"Declined-Service Charges"}]}getContactResults(){return this.contactResults}setParams(e){this.histParams=e}getParams(){return this.histParams}getCategoryRefDetails(){return this.http.get(this.apiUrl+"categoryrefdetails").pipe((0,u.T)(e=>(this.categoryRefDtos=e,e)))}getCandidateHistory(e){return this.http.get(this.apiUrl+"CallRecord/bycandidateid/"+e)}getOrAddCallRecord(e){var s=(0,y.Xn)(e);return this.http.get(this.apiUrl+"CallRecord/getOrAddHistoryWithItems",{observe:"response",params:s})}getHistoryByParams(e){let s=(0,y.Xn)(e);return this.http.get(this.apiUrl+"CallRecord/dto",{observe:"response",params:s})}getUserHistoryPaged(e){const s=this.cache.get(Object.values(e).join("-"));if(s)return(0,m.of)(s);let n=(0,y.Xn)(e);return(0,y.f8)(this.apiUrl+"CallRecord/pagedlist",n,this.http).pipe((0,u.T)(a=>(this.cache.set(Object.values(e).join("-"),a),a)))}deleteUserHistoryById(e){return this.http.delete(this.apiUrl+"CallRecord/deletehist/"+e)}updateUserHistory(e){return this.http.put(this.apiUrl+"CallRecord",e)}composeEmailMessageOfConsent(){}static#t=this.\u0275fac=function(s){return new(s||i)(t.KVO(M.Qq),t.KVO(E.tw))};static#e=this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var N=r(778),I=r(779),O=r(1822),f=r(5743),_=r(3400),G=r(7440);function X(i,g){if(1&i){const e=t.RV6();t.j41(0,"div")(1,"div",1),t.EFF(2),t.k0s(),t.j41(3,"div",2),t.EFF(4),t.k0s(),t.j41(5,"div",3),t.EFF(6),t.k0s(),t.j41(7,"div",1),t.EFF(8),t.k0s(),t.j41(9,"div",3),t.EFF(10),t.k0s(),t.j41(11,"div",2),t.EFF(12),t.k0s(),t.j41(13,"button",4),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.editClicked())}),t.k0s(),t.j41(14,"button",5),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.callByPhone())}),t.k0s(),t.j41(15,"button",6),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.sendEmail())}),t.k0s(),t.j41(16,"button",7),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.deleteClicked())}),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(2),t.JRh(e.hist.personName),t.R7$(2),t.JRh(e.hist.categoryRef),t.R7$(2),t.JRh(e.hist.source),t.R7$(2),t.JRh(e.hist.email),t.R7$(2),t.JRh(e.hist.phoneNo),t.R7$(2),t.JRh(e.hist.status)}}let $=(()=>{class i{constructor(e,s){this.service=e,this.toastr=s,this.editEvent=new t.bkB,this.deleteEvent=new t.bkB}ngOnInit(){}editClicked(){this.service.getCallRecordWithItems(this.hist.personType,this.hist.personId).subscribe({next:e=>{this.editEvent.emit(e)},error:e=>this.toastr.warning(e.error.text,"Failed to retrieve the call record")})}deleteClicked(){this.deleteEvent.emit(this.hist?.id)}callByPhone(){}sendEmail(){}static#t=this.\u0275fac=function(s){return new(s||i)(t.rXU(G.S),t.rXU(E.tw))};static#e=this.\u0275cmp=t.VBU({type:i,selectors:[["app-call-records-item"]],inputs:{hist:"hist"},outputs:{editEvent:"editEvent",deleteEvent:"deleteEvent"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"stdd","w175"],[1,"stdd","w150"],[1,"stdd","w100"],["title","click to add/edit transations",1,"btn","btn","fa","fa-pencil",3,"click"],["title","register conversation by phone",1,"btn","btn","fa","fa-phone",3,"click"],["title","advise conversation to the person by email",1,"btn","btn","fa","fa-envelope",3,"click"],["title","click to delete this record along with all its related child records",1,"btn","btn","fa","fa-trash","red",3,"click"]],template:function(s,n){1&s&&t.DNE(0,X,17,6,"div",0),2&s&&t.Y8G("ngIf",null!=n.hist)},dependencies:[o.bT],styles:[".stdd[_ngcontent-%COMP%]{display:inline-block;vertical-align:top;font-size:smaller;margin:0 2px;word-wrap:normal}.w100[_ngcontent-%COMP%]{width:100px}.w150[_ngcontent-%COMP%]{width:150px}.w175[_ngcontent-%COMP%]{width:175px}.red[_ngcontent-%COMP%]{color:red}.btn[_ngcontent-%COMP%]{color:#f0f8ff}"]})}return i})();const B=["search"];function D(i,g){if(1&i){const e=t.RV6();t.j41(0,"div",8)(1,"pagination",9),t.bIt("pageChanged",function(n){t.eBV(e);const a=t.XpG();return t.Njj(a.onPageChanged(n))}),t.EFF(2," >"),t.k0s(),t.j41(3,"input",10,11),t.bIt("keyup.enter",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.onSearch())}),t.k0s(),t.j41(5,"button",12),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.onSearch())}),t.k0s(),t.j41(6,"button",13),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.onReset())}),t.k0s(),t.nrm(7,"button",14),t.k0s()}if(2&i){const e=t.XpG();t.R7$(1),t.Y8G("totalItems",e.pagination.totalItems)("itemsPerPage",e.pagination.itemsPerPage)("maxSize",10)}}function L(i,g){1&i&&(t.j41(0,"div",15)(1,"h4",16),t.EFF(2,"No call records on record as per parameters given"),t.k0s()())}function S(i,g){if(1&i){const e=t.RV6();t.j41(0,"div")(1,"app-call-records-item",18),t.bIt("editEvent",function(n){const h=t.eBV(e).$implicit,p=t.XpG(2);return t.Njj(p.editCallRecord(n,h))})("deleteEvent",function(n){t.eBV(e);const a=t.XpG(2);return t.Njj(a.deleteCallRecord(n))}),t.k0s()()}if(2&i){const e=g.$implicit;t.R7$(1),t.Y8G("hist",e)}}function V(i,g){if(1&i&&(t.j41(0,"div"),t.DNE(1,S,2,1,"div",17),t.k0s()),2&i){const e=t.XpG();t.R7$(1),t.Y8G("ngForOf",e.callRecords)}}let P=(()=>{class i{constructor(e,s,n,a,h,p,x){this.service=e,this.confirm=s,this.toastr=n,this.bsModalRef=a,this.accountService=h,this.bsModalService=p,this.router=x,this.callRecords=[],this.oParams=new l,this.totalCount=0,this.contactResults=[],this.userHistoryParams=new l,this.accountService.currentUser$.pipe((0,R.s)(1)).subscribe(W=>this.user=W)}ngOnInit(){this.getCallRecords(this.userHistoryParams),this.contactResults=this.service.getContactResults()}getCallRecords(e){this.service.getUserHistoryPaged(e).subscribe({next:s=>{s.result&&s.pagination&&(this.callRecords=s.result,this.pagination=s.pagination,this.totalCount=s.count)}})}onPageChanged(e){const s=this.service.getParams()??new l;s.pageNumber!==e&&(s.pageNumber=e.page,this.service.setParams(s),this.getCallRecords(s))}deleteCallRecord(e){this.confirm.confirm("confirm delete this Order","confirm delete order").pipe((0,k.p)(n=>n),(0,F.n)(n=>this.service.deleteUserHistoryById(e).pipe((0,b.W)(a=>(console.log("Error in deleting the Call Record",a),(0,m.of)())),(0,c.M)(a=>this.toastr.success("deleted the Call Recorrd")))),(0,b.W)(n=>(this.toastr.error("Error in getting delete confirmation",n),(0,m.of)()))).subscribe(()=>{console.log("delete succeeded"),this.toastr.success("Call Record deleted")},n=>{console.log("any error NOT handed in catchError() or if throwError() is returned instead of of() inside catcherror()",n)})}editCallRecord(e,s){null!==e?(this.bsModalRef=this.bsModalService.show(U.J,{class:"modal-dialog-centered modal-lg",initialState:{callRecord:e,status:s.status,candidateName:s.personName,categoryRef:s.categoryName}}),this.bsModalRef.content.updateCallRecordEvent.subscribe({next:h=>{if(""===h.strError){s.status=h.status;var p=this.callRecords.findIndex(x=>x.id==s.id);p>=0&&(this.callRecords[p]=s),this.toastr.success("The Call Record was updated","success")}else this.toastr.warning("Failed to update the call Record","Failed")},error:h=>this.toastr.error(h,"Error encountered")})):this.toastr.warning("No Call Record object returned by call record item")}onSearch(){const e=this.service.getParams();e.search=this.searchTerm?.nativeElement.value,e.pageNumber=1,this.service.setParams(e),this.getCallRecords(e)}onReset(){}static#t=this.\u0275fac=function(s){return new(s||i)(t.rXU(w),t.rXU(N.G),t.rXU(E.tw),t.rXU(I.Y$),t.rXU(O.D),t.rXU(I.I8),t.rXU(f.Ix))};static#e=this.\u0275cmp=t.VBU({type:i,selectors:[["app-call-records-list"]],viewQuery:function(s,n){if(1&s&&t.GBs(B,5),2&s){let a;t.mGM(a=t.lsd())&&(n.searchTerm=a.first)}},decls:18,vars:3,consts:[[2,"display","inline-block","font-size","bold"],["style","display: inline-block; margin-left: 15px; vertical-align: top;",4,"ngIf"],[1,"form-inline",2,"margin-left","50px"],[1,"lbl","w175"],[1,"lbl","w150"],[1,"lbl","w100"],["class","my-2",4,"ngIf"],[4,"ngIf"],[2,"display","inline-block","margin-left","15px","vertical-align","top"],["previousText","\u2039","nextText","\u203a","firstText","\xab","lastText","\xbb",2,"display","inline-block",3,"totalItems","itemsPerPage","maxSize","pageChanged"],["type","text","placeholder","Search",1,"stdd","form-control","w175",3,"keyup.enter"],["search",""],["title","search the records based upon search string entered",1,"btn","fa","fa-search","fa-2x","mx-1",3,"click"],["title","clears all search parameters",1,"btn","fa","fa-refresh","fa-2x","mx-1",3,"click"],["title","go back to Administration Menu","routerLink","/",1,"btn","fa","fa-window-close","fa-2x","mx-1"],[1,"my-2"],[1,"red"],[4,"ngFor","ngForOf"],[3,"hist","editEvent","deleteEvent"]],template:function(s,n){1&s&&(t.j41(0,"h4",0),t.EFF(1,"Call Records Listing"),t.k0s(),t.DNE(2,D,8,3,"div",1),t.j41(3,"div",2)(4,"label",3),t.EFF(5,"Name"),t.k0s(),t.j41(6,"label",4),t.EFF(7,"CategoryRef"),t.k0s(),t.j41(8,"label",5),t.EFF(9,"Source"),t.k0s(),t.j41(10,"label",3),t.EFF(11,"Email"),t.k0s(),t.j41(12,"label",5),t.EFF(13,"Phone No"),t.k0s(),t.j41(14,"label",4),t.EFF(15,"Status"),t.k0s(),t.DNE(16,L,3,0,"div",6),t.DNE(17,V,2,1,"div",7),t.k0s()),2&s&&(t.R7$(2),t.Y8G("ngIf",void 0!==n.pagination),t.R7$(14),t.Y8G("ngIf",!n.callRecords||0===n.callRecords.length),t.R7$(1),t.Y8G("ngIf",n.callRecords))},dependencies:[o.Sq,o.bT,_.eK,f.Wk,$],styles:[".lbl[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;font-weight:700;font-size:smaller;margin:0 2px;word-wrap:normal}.stdd[_ngcontent-%COMP%]{display:inline-block!important}.b[_ngcontent-%COMP%]{font-weight:700}.w100[_ngcontent-%COMP%]{width:100px}.w150[_ngcontent-%COMP%]{width:150px}.w175[_ngcontent-%COMP%]{width:175px}.red[_ngcontent-%COMP%]{color:red}.btn[_ngcontent-%COMP%]{color:#f0f8ff}"]})}return i})();const H=[{path:"",component:(()=>{class i{constructor(e){this.accountService=e,this.hasAdminRole=!1,this.accountService.currentUser$.pipe((0,R.s)(1)).subscribe(s=>this.user=s),this.hasAdminRole=void 0!==this.user&&this.user.roles.includes("Admin")}static#t=this.\u0275fac=function(s){return new(s||i)(t.rXU(O.D))};static#e=this.\u0275cmp=t.VBU({type:i,selectors:[["app-call-record-menu"]],decls:13,vars:2,consts:[[1,"container","d-flex","justify-contents-between","align-items-center","mt-5"],["routerLink","/callRecords/callRecordList","title","List of Pending Call Records - for admin role",3,"disabled"],["routerLink","/callRecords/callRecordListLoggedinUsername","title","Display active Call Records for logged in User"],["routerLink","/candidates/candidatehistory","title","Candidate history"]],template:function(s,n){1&s&&(t.j41(0,"div",0)(1,"button",1),t.EFF(2,"Active Call Records"),t.nrm(3,"br"),t.EFF(4,"of All users"),t.k0s(),t.j41(5,"button",2),t.EFF(6,"Active Call Records"),t.nrm(7,"br"),t.EFF(8),t.k0s(),t.j41(9,"button",3),t.EFF(10,"Candidate History"),t.k0s(),t.j41(11,"button",3),t.EFF(12,"Candidate History"),t.k0s()()),2&s&&(t.R7$(1),t.Y8G("disabled",!n.hasAdminRole),t.R7$(7),t.SpI("Of ",n.user.knownAs,""))},dependencies:[f.Wk]})}return i})()},{path:"callRecordList",component:P},{path:"callRecordListLoggedinUsername",component:P}];let A=(()=>{class i{static#t=this.\u0275fac=function(s){return new(s||i)};static#e=this.\u0275mod=t.$C({type:i});static#s=this.\u0275inj=t.G2t({imports:[o.MD,f.iI.forChild(H),f.iI]})}return i})();var J=r(9213);let Y=(()=>{class i{static#t=this.\u0275fac=function(s){return new(s||i)};static#e=this.\u0275mod=t.$C({type:i});static#s=this.\u0275inj=t.G2t({imports:[o.MD,C.G,A,J.m_]})}return i})()}}]);