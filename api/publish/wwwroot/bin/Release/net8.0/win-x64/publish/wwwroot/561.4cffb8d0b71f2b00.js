"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[561],{6295:(x,g,r)=>{r.d(g,{f:()=>p});var s=r(7705),u=r(9417),v=r(177);function b(c,a){if(1&c&&(s.j41(0,"div",3),s.EFF(1),s.k0s()),2&c){const t=s.XpG();s.R7$(1),s.SpI(" Please enter a ",t.label," ")}}function y(c,a){if(1&c&&(s.j41(0,"div",3),s.EFF(1),s.k0s()),2&c){const t=s.XpG();s.R7$(1),s.Lme(" ",t.label," must be at least ",null==t.control.errors?null:t.control.errors.minlength.requiredLength," characters ")}}function C(c,a){if(1&c&&(s.j41(0,"div",3),s.EFF(1),s.k0s()),2&c){const t=s.XpG();s.R7$(1),s.Lme(" ",t.label," must be at most ",null==t.control.errors?null:t.control.errors.maxlength.requiredLength," characters ")}}function f(c,a){if(1&c&&(s.j41(0,"div",3),s.EFF(1),s.k0s()),2&c){const t=s.XpG();s.R7$(1),s.SpI(" ",t.label," do not match ")}}let p=(()=>{class c{constructor(t){this.ngControl=t,this.label="",this.type="text",this.width="",this.ngControl.valueAccessor=this}writeValue(t){}registerOnChange(t){}registerOnTouched(t){}get control(){return this.ngControl.control}static#t=this.\u0275fac=function(h){return new(h||c)(s.rXU(u.vO,2))};static#e=this.\u0275cmp=s.VBU({type:c,selectors:[["app-text-input"]],inputs:{label:"label",type:"type",width:"width"},decls:6,vars:10,consts:[[1,"mb-3",2,"vertical-align","top"],[1,"form-control",2,"font-size","small","word-wrap","normal","height","auto","margin-top","0px","margin-bottom","0px","padding-top","0px","padding-bottom","0px","background-color","darkgrey",3,"type","width","formControl","placeholder"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"]],template:function(h,l){1&h&&(s.j41(0,"div",0),s.nrm(1,"input",1),s.DNE(2,b,2,1,"div",2),s.DNE(3,y,2,2,"div",2),s.DNE(4,C,2,2,"div",2),s.DNE(5,f,2,1,"div",2),s.k0s()),2&h&&(s.R7$(1),s.AVh("is-invalid",l.control.touched&&l.control.invalid),s.FS9("type",l.type),s.FS9("width",l.width),s.FS9("placeholder",l.label),s.Y8G("formControl",l.control),s.R7$(1),s.Y8G("ngIf",null==l.control.errors?null:l.control.errors.required),s.R7$(1),s.Y8G("ngIf",null==l.control.errors?null:l.control.errors.minlength),s.R7$(1),s.Y8G("ngIf",null==l.control.errors?null:l.control.errors.maxlength),s.R7$(1),s.Y8G("ngIf",null==l.control.errors?null:l.control.errors.isMatching))},dependencies:[v.bT,u.me,u.BC,u.l_]})}return c})()},778:(x,g,r)=>{r.d(g,{G:()=>f});var s=r(7705),u=r(779);let v=(()=>{class p{constructor(a){this.bsModalRef=a,this.title="",this.message="",this.btnOkText="",this.btnCancelText="",this.result=!1}confirm(){this.result=!0,this.bsModalRef.hide()}decline(){this.bsModalRef.hide()}static#t=this.\u0275fac=function(t){return new(t||p)(s.rXU(u.Y$))};static#e=this.\u0275cmp=s.VBU({type:p,selectors:[["app-confirm-dialog"]],decls:11,vars:4,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],[1,"modal-body"],[1,"modal-footer"],["type","button",1,"btn","btn-success",3,"click"],["type","button",1,"btn","btn-danger",3,"click"]],template:function(t,h){1&t&&(s.j41(0,"div",0)(1,"h4",1),s.EFF(2),s.k0s()(),s.j41(3,"div",2)(4,"p"),s.EFF(5),s.k0s()(),s.j41(6,"div",3)(7,"button",4),s.bIt("click",function(){return h.confirm()}),s.EFF(8),s.k0s(),s.j41(9,"button",5),s.bIt("click",function(){return h.decline()}),s.EFF(10),s.k0s()()),2&t&&(s.R7$(2),s.JRh(h.title),s.R7$(3),s.JRh(h.message),s.R7$(3),s.JRh(h.btnOkText),s.R7$(2),s.JRh(h.btnCancelText))}})}return p})();var b=r(6354),y=r(3587),C=r(1626);let f=(()=>{class p{constructor(a,t){this.modalService=a,this.http=t,this.baseUrl=y.c.apiUrl}confirm(a="Confirmation",t="Are you sure you want to do this?",h="Ok",l="Cancel"){return this.bsModelRef=this.modalService.show(v,{initialState:{title:a,message:t,btnOkText:h,btnCancelText:l}}),this.bsModelRef.onHidden.pipe((0,b.T)(()=>this.bsModelRef.content.result))}getHelp(a){return this.http.get(this.baseUrl+"Help/help/"+a)}static#t=this.\u0275fac=function(t){return new(t||p)(s.KVO(u.I8),s.KVO(C.Qq))};static#e=this.\u0275prov=s.jDH({token:p,factory:p.\u0275fac,providedIn:"root"})}return p})()},27:(x,g,r)=>{r.r(g),r.d(g,{CallRecordModule:()=>J});var s=r(177),u=r(9485),v=r(6697),b=r(5964),y=r(5558),C=r(9437),f=r(7673),p=r(8141),c=r(2777);class a{constructor(){this.id=0,this.personType="",this.incomingOutgoing="",this.dateOfContact=new Date,this.personId="",this.mobileNo="",this.emailId="",this.categoryRef="",this.status="",this.statusClass="Active",this.username="",this.gistOfDiscussions="",this.advisoryBy="",this.nextAction="",this.nextActionOn=new Date,this.subject="",this.search="",this.sort="",this.pageNumber=1,this.pageSize=15}}var t=r(7705),h=r(2771),l=r(6354),j=r(3587),k=r(6220),M=r(1626),_=r(8256);let U=(()=>{class i{constructor(e,n){this.http=e,this.toastr=n,this.apiUrl=j.c.apiUrl,this.currentUserSource=new h.m(1),this.currentUser$=this.currentUserSource.asObservable(),this.histParams=new a,this.categoryRefDtos=[],this.cache=new Map,this.contactResults=[{status:"Not Reachable"},{status:"Wrong Number"},{status:"Declined-Family Issues"},{status:"Declined-Low Remuneration"},{status:"Declined-Other Reasons"},{status:"Will Call later"},{status:"Not interested for overseas"},{status:"Declined-Service Charges"}]}getContactResults(){return this.contactResults}setParams(e){this.histParams=e}getParams(){return this.histParams}getCategoryRefDetails(){return this.http.get(this.apiUrl+"categoryrefdetails").pipe((0,l.T)(e=>(this.categoryRefDtos=e,e)))}getCandidateHistory(e){return this.http.get(this.apiUrl+"CallRecord/bycandidateid/"+e)}getOrAddCallRecord(e){var n=(0,k.Xn)(e);return this.http.get(this.apiUrl+"CallRecord/getOrAddHistoryWithItems",{observe:"response",params:n})}getHistoryByParams(e){let n=(0,k.Xn)(e);return this.http.get(this.apiUrl+"CallRecord/dto",{observe:"response",params:n})}getUserHistoryPaged(e){const n=this.cache.get(Object.values(e).join("-"));if(n)return(0,f.of)(n);let o=(0,k.Xn)(e);return(0,k.f8)(this.apiUrl+"CallRecord/pagedlist",o,this.http).pipe((0,l.T)(d=>(this.cache.set(Object.values(e).join("-"),d),d)))}deleteUserHistoryById(e){return this.http.delete(this.apiUrl+"CallRecord/deletehist/"+e)}updateUserHistory(e){return this.http.put(this.apiUrl+"CallRecord",e)}composeEmailMessageOfConsent(){}static#t=this.\u0275fac=function(n){return new(n||i)(t.KVO(M.Qq),t.KVO(_.tw))};static#e=this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var w=r(778),T=r(779),O=r(1822),F=r(5743),G=r(3400),N=r(7440);function D(i,E){if(1&i){const e=t.RV6();t.j41(0,"div")(1,"div",1),t.EFF(2),t.k0s(),t.j41(3,"div",2),t.EFF(4),t.k0s(),t.j41(5,"div",3),t.EFF(6),t.k0s(),t.j41(7,"div",1),t.EFF(8),t.k0s(),t.j41(9,"div",3),t.EFF(10),t.k0s(),t.j41(11,"div",2),t.EFF(12),t.k0s(),t.j41(13,"button",4),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.editClicked())}),t.k0s(),t.j41(14,"button",5),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.callByPhone())}),t.k0s(),t.j41(15,"button",6),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.sendEmail())}),t.k0s(),t.j41(16,"button",7),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.deleteClicked())}),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(2),t.JRh(e.hist.personName),t.R7$(2),t.JRh(e.hist.categoryRef),t.R7$(2),t.JRh(e.hist.source),t.R7$(2),t.JRh(e.hist.email),t.R7$(2),t.JRh(e.hist.phoneNo),t.R7$(2),t.JRh(e.hist.status)}}let $=(()=>{class i{constructor(e,n){this.service=e,this.toastr=n,this.editEvent=new t.bkB,this.deleteEvent=new t.bkB}ngOnInit(){}editClicked(){this.service.getCallRecordWithItems(this.hist.personType,this.hist.personId).subscribe({next:e=>{this.editEvent.emit(e)},error:e=>this.toastr.warning(e.error.text,"Failed to retrieve the call record")})}deleteClicked(){this.deleteEvent.emit(this.hist?.id)}callByPhone(){}sendEmail(){}static#t=this.\u0275fac=function(n){return new(n||i)(t.rXU(N.S),t.rXU(_.tw))};static#e=this.\u0275cmp=t.VBU({type:i,selectors:[["app-call-records-item"]],inputs:{hist:"hist"},outputs:{editEvent:"editEvent",deleteEvent:"deleteEvent"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"stdd","w175"],[1,"stdd","w150"],[1,"stdd","w100"],["title","click to add/edit transations",1,"btn","btn","fa","fa-pencil",3,"click"],["title","register conversation by phone",1,"btn","btn","fa","fa-phone",3,"click"],["title","advise conversation to the person by email",1,"btn","btn","fa","fa-envelope",3,"click"],["title","click to delete this record along with all its related child records",1,"btn","btn","fa","fa-trash","red",3,"click"]],template:function(n,o){1&n&&t.DNE(0,D,17,6,"div",0),2&n&&t.Y8G("ngIf",null!=o.hist)},dependencies:[s.bT],styles:[".stdd[_ngcontent-%COMP%]{display:inline-block;vertical-align:top;font-size:smaller;margin:0 2px;word-wrap:normal}.w100[_ngcontent-%COMP%]{width:100px}.w150[_ngcontent-%COMP%]{width:150px}.w175[_ngcontent-%COMP%]{width:175px}.red[_ngcontent-%COMP%]{color:red}.btn[_ngcontent-%COMP%]{color:#f0f8ff}"]})}return i})();const L=["search"];function X(i,E){if(1&i){const e=t.RV6();t.j41(0,"div",8)(1,"pagination",9),t.bIt("pageChanged",function(o){t.eBV(e);const d=t.XpG();return t.Njj(d.onPageChanged(o))}),t.EFF(2," >"),t.k0s(),t.j41(3,"input",10,11),t.bIt("keyup.enter",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.onSearch())}),t.k0s(),t.j41(5,"button",12),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.onSearch())}),t.k0s(),t.j41(6,"button",13),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.onReset())}),t.k0s(),t.nrm(7,"button",14),t.k0s()}if(2&i){const e=t.XpG();t.R7$(1),t.Y8G("totalItems",e.pagination.totalItems)("itemsPerPage",e.pagination.itemsPerPage)("maxSize",10)}}function B(i,E){1&i&&(t.j41(0,"div",15)(1,"h4",16),t.EFF(2,"No call records on record as per parameters given"),t.k0s()())}function S(i,E){if(1&i){const e=t.RV6();t.j41(0,"div")(1,"app-call-records-item",18),t.bIt("editEvent",function(o){const m=t.eBV(e).$implicit,R=t.XpG(2);return t.Njj(R.editCallRecord(o,m))})("deleteEvent",function(o){t.eBV(e);const d=t.XpG(2);return t.Njj(d.deleteCallRecord(o))}),t.k0s()()}if(2&i){const e=E.$implicit;t.R7$(1),t.Y8G("hist",e)}}function V(i,E){if(1&i&&(t.j41(0,"div"),t.DNE(1,S,2,1,"div",17),t.k0s()),2&i){const e=t.XpG();t.R7$(1),t.Y8G("ngForOf",e.callRecords)}}let P=(()=>{class i{constructor(e,n,o,d,m,R,I){this.service=e,this.confirm=n,this.toastr=o,this.bsModalRef=d,this.accountService=m,this.bsModalService=R,this.router=I,this.callRecords=[],this.oParams=new a,this.totalCount=0,this.contactResults=[],this.userHistoryParams=new a,this.accountService.currentUser$.pipe((0,v.s)(1)).subscribe(W=>this.user=W)}ngOnInit(){this.getCallRecords(this.userHistoryParams),this.contactResults=this.service.getContactResults()}getCallRecords(e){this.service.getUserHistoryPaged(e).subscribe({next:n=>{n.result&&n.pagination&&(this.callRecords=n.result,this.pagination=n.pagination,this.totalCount=n.count)}})}onPageChanged(e){const n=this.service.getParams()??new a;n.pageNumber!==e&&(n.pageNumber=e.page,this.service.setParams(n),this.getCallRecords(n))}deleteCallRecord(e){this.confirm.confirm("confirm delete this Order","confirm delete order").pipe((0,b.p)(o=>o),(0,y.n)(o=>this.service.deleteUserHistoryById(e).pipe((0,C.W)(d=>(console.log("Error in deleting the Call Record",d),(0,f.of)())),(0,p.M)(d=>this.toastr.success("deleted the Call Recorrd")))),(0,C.W)(o=>(this.toastr.error("Error in getting delete confirmation",o),(0,f.of)()))).subscribe(()=>{console.log("delete succeeded"),this.toastr.success("Call Record deleted")},o=>{console.log("any error NOT handed in catchError() or if throwError() is returned instead of of() inside catcherror()",o)})}editCallRecord(e,n){null!==e?(this.bsModalRef=this.bsModalService.show(c.J,{class:"modal-dialog-centered modal-lg",initialState:{callRecord:e,status:n.status,candidateName:n.personName,categoryRef:n.categoryName}}),this.bsModalRef.content.updateCallRecordEvent.subscribe({next:m=>{if(""===m.strError){n.status=m.status;var R=this.callRecords.findIndex(I=>I.id==n.id);R>=0&&(this.callRecords[R]=n),this.toastr.success("The Call Record was updated","success")}else this.toastr.warning("Failed to update the call Record","Failed")},error:m=>this.toastr.error(m,"Error encountered")})):this.toastr.warning("No Call Record object returned by call record item")}onSearch(){const e=this.service.getParams();e.search=this.searchTerm?.nativeElement.value,e.pageNumber=1,this.service.setParams(e),this.getCallRecords(e)}onReset(){}static#t=this.\u0275fac=function(n){return new(n||i)(t.rXU(U),t.rXU(w.G),t.rXU(_.tw),t.rXU(T.Y$),t.rXU(O.D),t.rXU(T.I8),t.rXU(F.Ix))};static#e=this.\u0275cmp=t.VBU({type:i,selectors:[["app-call-records-list"]],viewQuery:function(n,o){if(1&n&&t.GBs(L,5),2&n){let d;t.mGM(d=t.lsd())&&(o.searchTerm=d.first)}},decls:18,vars:3,consts:[[2,"display","inline-block","font-size","bold"],["style","display: inline-block; margin-left: 15px; vertical-align: top;",4,"ngIf"],[1,"form-inline",2,"margin-left","50px"],[1,"lbl","w175"],[1,"lbl","w150"],[1,"lbl","w100"],["class","my-2",4,"ngIf"],[4,"ngIf"],[2,"display","inline-block","margin-left","15px","vertical-align","top"],["previousText","\u2039","nextText","\u203a","firstText","\xab","lastText","\xbb",2,"display","inline-block",3,"totalItems","itemsPerPage","maxSize","pageChanged"],["type","text","placeholder","Search",1,"stdd","form-control","w175",3,"keyup.enter"],["search",""],["title","search the records based upon search string entered",1,"btn","fa","fa-search","fa-2x","mx-1",3,"click"],["title","clears all search parameters",1,"btn","fa","fa-refresh","fa-2x","mx-1",3,"click"],["title","go back to Administration Menu","routerLink","/",1,"btn","fa","fa-window-close","fa-2x","mx-1"],[1,"my-2"],[1,"red"],[4,"ngFor","ngForOf"],[3,"hist","editEvent","deleteEvent"]],template:function(n,o){1&n&&(t.j41(0,"h4",0),t.EFF(1,"Call Records Listing"),t.k0s(),t.DNE(2,X,8,3,"div",1),t.j41(3,"div",2)(4,"label",3),t.EFF(5,"Name"),t.k0s(),t.j41(6,"label",4),t.EFF(7,"CategoryRef"),t.k0s(),t.j41(8,"label",5),t.EFF(9,"Source"),t.k0s(),t.j41(10,"label",3),t.EFF(11,"Email"),t.k0s(),t.j41(12,"label",5),t.EFF(13,"Phone No"),t.k0s(),t.j41(14,"label",4),t.EFF(15,"Status"),t.k0s(),t.DNE(16,B,3,0,"div",6),t.DNE(17,V,2,1,"div",7),t.k0s()),2&n&&(t.R7$(2),t.Y8G("ngIf",void 0!==o.pagination),t.R7$(14),t.Y8G("ngIf",!o.callRecords||0===o.callRecords.length),t.R7$(1),t.Y8G("ngIf",o.callRecords))},dependencies:[s.Sq,s.bT,G.eK,F.Wk,$],styles:[".lbl[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;font-weight:700;font-size:smaller;margin:0 2px;word-wrap:normal}.stdd[_ngcontent-%COMP%]{display:inline-block!important}.b[_ngcontent-%COMP%]{font-weight:700}.w100[_ngcontent-%COMP%]{width:100px}.w150[_ngcontent-%COMP%]{width:150px}.w175[_ngcontent-%COMP%]{width:175px}.red[_ngcontent-%COMP%]{color:red}.btn[_ngcontent-%COMP%]{color:#f0f8ff}"]})}return i})();const A=[{path:"",component:(()=>{class i{constructor(e){this.accountService=e,this.hasAdminRole=!1,this.accountService.currentUser$.pipe((0,v.s)(1)).subscribe(n=>this.user=n),this.hasAdminRole=void 0!==this.user&&this.user.roles.includes("Admin")}static#t=this.\u0275fac=function(n){return new(n||i)(t.rXU(O.D))};static#e=this.\u0275cmp=t.VBU({type:i,selectors:[["app-call-record-menu"]],decls:13,vars:2,consts:[[1,"container","d-flex","justify-contents-between","align-items-center","mt-5"],["routerLink","/callRecords/callRecordList","title","List of Pending Call Records - for admin role",3,"disabled"],["routerLink","/callRecords/callRecordListLoggedinUsername","title","Display active Call Records for logged in User"],["routerLink","/candidates/candidatehistory","title","Candidate history"]],template:function(n,o){1&n&&(t.j41(0,"div",0)(1,"button",1),t.EFF(2,"Active Call Records"),t.nrm(3,"br"),t.EFF(4,"of All users"),t.k0s(),t.j41(5,"button",2),t.EFF(6,"Active Call Records"),t.nrm(7,"br"),t.EFF(8),t.k0s(),t.j41(9,"button",3),t.EFF(10,"Candidate History"),t.k0s(),t.j41(11,"button",3),t.EFF(12,"Candidate History"),t.k0s()()),2&n&&(t.R7$(1),t.Y8G("disabled",!o.hasAdminRole),t.R7$(7),t.SpI("Of ",o.user.knownAs,""))},dependencies:[F.Wk]})}return i})()},{path:"callRecordList",component:P},{path:"callRecordListLoggedinUsername",component:P}];let H=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=t.$C({type:i});static#s=this.\u0275inj=t.G2t({imports:[s.MD,F.iI.forChild(A),F.iI]})}return i})();var Y=r(9213);let J=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=t.$C({type:i});static#s=this.\u0275inj=t.G2t({imports:[s.MD,u.G,H,Y.m_]})}return i})()}}]);