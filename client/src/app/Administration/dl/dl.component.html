<div *ngIf="order">
    <form [formGroup]="form" (change)="formChanged()" >
        <label class="lbl w110 mx-2">Order No</label>
        <label class="lbl w300 mx-2">Customer</label>
        <label class="lbl w110 mx-2">Dated</label>
        <label class="lbl w110 mx-2">Complete By</label>
        <label class="lbl w110 mx-2">City</label>
        <label class="lbl w150 mx-2">Country</label>
        <label class="lbl w150 mx-2">Order Ref</label>
        <label class="lbl w200 mx-2">Project Head</label>

        <br>
        <div class="stdd w110 mx-2">
            <app-text-input [label]="'Order No'" formControlName="orderNo" ></app-text-input>
        </div>
        
        <div class="stdd w300 mx-2">
            <ng-select 
                [items]="customers"
                bindLabel="customerName"
                bindValue="id"
                labelForId="id"
                clearAllText="Clear"
                formControlName="customerId"
            ></ng-select>
        </div>
        
        <input class="stdd w110 mx-2" type="text" placeholder="Order Date" formControlName="orderDate"
            bsDatepicker [bsValue]="bsValueDate" [bsConfig]="{dateInputFormat: 'YYYY-MM-DD' }">
            
        <input class="stdd w110 mx-2" type="text" placeholder="Order Date" formControlName="completeBy"
            bsDatepicker [bsValue]="bsValueDate" [bsConfig]="{dateInputFormat: 'YYYY-MM-DD' }">

        <div class="stdd w110 mx-2">
            <app-text-input [label]="'City'" formControlName="cityOfWorking" ></app-text-input>
        </div>
        <div class="stdd w150 mx-2">
            <app-text-input [label]="'Country'" formControlName="country" ></app-text-input>
       </div>
       <div class="stdd w150 mx-2">
            <app-text-input [label]="'Order Ref'" formControlName="orderRef" ></app-text-input>
       </div>
       <div class="stdd w110 mx-2">
            <ng-select  
                 [items]="employees"
                 bindLabel="knownAs"
                 bindValue="id"
                 labelForId="id"
                 clearAllText="Clear"
                 formControlName="projectManagerId">
            </ng-select>
       </div>

       <br>
        <div *ngIf="!isAddMode" class="stdd" >
                <label class="lbl w150">Contract Review Status</label>
                <div class="stdd w100 cursorpointer" style="border:btn-primary;" 
                    [ngClass]="order.contractReviewStatus==='Accepted'
                    ?'green'
                    :order.contractReviewStatus==='Accepted with regrets'
                        ?'blue'
                        :'red'" 
            >
                    {{order.contractReviewStatus}}
            </div>  
            <label class="lbl w150 mx-3">Forwarded to HR On</label>
            <div *ngIf="order.forwardedToHRDeptOn !==null && order.forwardedToHRDeptOn !== undefined "  
                    id="forwardedToHRDeptOn" class="stdd w110" style="border:btn-primary;">
                    {{order.forwardedToHRDeptOn | date}}
                    <!-- {{member.forwardedToHRDeptOn.getFullYear() < 2000 ? 'not forwarded': member.forwardedToHRDeptOn | date}} -->
            </div>
            <div *ngIf="order.forwardedToHRDeptOn ===undefined" class="stdd w100 cursorpointer"
                    (click)="forwardOrderToHRDept()">
                    Not Forwarded
            </div>
        </div>
       
        <button class="stdd btn btn-primary pull-right fa fa-2x fa-window-close fa-2x " (click)="close()"
            title="Return to calling procedure" ></button>

        <label class="lbl w100">Status</label>
        <div class="stdd fontSmaller w120">{{order.status}}</div>
       
        <button type="submit" [disabled]="!form.dirty" style="margin-left: 25px!important;" 
            class="stdd btn btn-success fa fa-save" (click)="onSubmit()" title="Save the requirement" >
            <span *ngIf="loading" class="spinner-border spinner-border-sm mr-1"></span>
        </button> 
       
        <div *ngIf="!isAddMode" style="display: inline-block;" class="pull-right" >
            <button disabled="member.contractReviewStatusId===1 || member.contractReviewStatusId===2 " 
                class="btn btn-primary stdd fa fa-users " (click)="assignTasksToHRExecs()" 
                title="assign selected categories once Contract Review is done"
            > </button>
        </div>
        <hr style="margin: 0px; padding: 0px;">

        <div formArrayName="orderItems" class="my-2">
            <div style="font-weight: bold; margin-left: 0px; font-size: smaller;">
                <label class="lbl w30">Sel</label>
                <label class="lbl w30" >Sr#</label>
                <label class="lbl w240">Category</label>
                <label class="w30 mx-2" style="display: inline-block;">ECNR</label>
                <label class="lbl w110">Source<br>From</label>
                <label class="lbl w50">Qnty</label>
                <label class="lbl w50" >Min<br>CVs</label>
                <label class="lbl w50" >Max<br>CVs</label>
                <label class="lbl w110" 
                    title="Date by which the shortlisting of candidates is to be completed by the HR Executive"
                    >Complete by
                </label>
                <label class="lbl w50">Review<br>Status</label>

                <button  type="button" (click)="addItem()" class="stdd w30 fa fa-plus fa-2x blue" style="margin-left: 20px;"></button>
            </div>

            <div *ngFor="let item of orderItems.controls; let i=index">
                <div [formGroupName]="i">
                    <input type="checkbox" formControlName="srNo" 
                        style="display: inline-block; width: 15px; margin-left: 8px; margin-right: 8px;">

                    <div class="stdd w30">
                        <app-text-input formControlName="srNo"></app-text-input>
                    </div>
                    <ng-select  class="stdd w240" *ngIf="categories" 
                        [items]="categories"
                        bindLabel="professionName"
                        bindValue="id"
                        labelForId="id"
                        clearAllText="Clear"
                        formControlName="professionId">
                    </ng-select>

                    <input type="checkbox" formControlName="ecnr" class="chk  w30" >
                    <div class="stdd w110">
                            <app-text-input [label]="'Source From'" formControlName="sourceFrom"></app-text-input>
                    </div>
                    <div class="stdd w50">
                            <app-text-input [label]="'quantity'" formControlName="quantity" ></app-text-input>
                    </div>
                    <div class="stdd w50">
                            <app-text-input [label]="'Min CVs'" formControlName="minCVs" ></app-text-input>
                    </div>
                    <div class="stdd w50">
                            <app-text-input [label]="'max CVs'" formControlName="maxCVs" ></app-text-input>
                    </div>
                    
                    <input type="text"
                        class="stdd w110"
                        placeholder="Complete By"
                        formControlName="completeBefore"
                        bsDatepicker
                        [bsValue]="bsValueDate"
                        [bsConfig]="{dateInputFormat: 'YYYY-MM-DD' }"
                    >
                    <input type="text" class="stdd w150 cursorpointer" title="contract review of this category"
                        (click)="openContractReviewItemModal(i)" formControlName="reviewItemStatus" >

                    <div *ngIf="!isAddMode" class="stdd">       
                        <button class="w10 btn fa fa-question-mark" 
                                title="design Assessment Questions for this category" 
                                (click)="assessItem(i)" 
                                >Q</button>

                        <button class="w10 btn fa fa-list" title="Open Job Description"
                                (click)="openJDModal(i)" ></button>
                        <button class="w10 btn fa fa-dollar" title="Open Remuneration"
                                (click)="openRemunerationModal(i)" ></button>
                    </div>
                    <button (click)="removeItem(i)" class="w10 btn fa fa-trash fa-sm" 
                        title="remove this item"
                    ></button>
                </div>
            </div>
        </div>
    </form>
    <ul class="text-danger list-unstyled" *ngIf="errors">
        <li *ngFor="let error of errors">
             {{error}}
        </li>
   </ul>
</div>

<div style="font-size: small;">
    {{form.value |json}}
</div>