"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[691],{6295:(y,b,c)=>{c.d(b,{f:()=>e});var t=c(7705),h=c(9417),T=c(177);function M(g,m){if(1&g&&(t.j41(0,"div",3),t.EFF(1),t.k0s()),2&g){const l=t.XpG();t.R7$(1),t.SpI(" Please enter a ",l.label," ")}}function v(g,m){if(1&g&&(t.j41(0,"div",3),t.EFF(1),t.k0s()),2&g){const l=t.XpG();t.R7$(1),t.Lme(" ",l.label," must be at least ",null==l.control.errors?null:l.control.errors.minlength.requiredLength," characters ")}}function C(g,m){if(1&g&&(t.j41(0,"div",3),t.EFF(1),t.k0s()),2&g){const l=t.XpG();t.R7$(1),t.Lme(" ",l.label," must be at most ",null==l.control.errors?null:l.control.errors.maxlength.requiredLength," characters ")}}function f(g,m){if(1&g&&(t.j41(0,"div",3),t.EFF(1),t.k0s()),2&g){const l=t.XpG();t.R7$(1),t.SpI(" ",l.label," do not match ")}}let e=(()=>{class g{constructor(l){this.ngControl=l,this.label="",this.type="text",this.width="",this.ngControl.valueAccessor=this}writeValue(l){}registerOnChange(l){}registerOnTouched(l){}get control(){return this.ngControl.control}static#e=this.\u0275fac=function(p){return new(p||g)(t.rXU(h.vO,2))};static#t=this.\u0275cmp=t.VBU({type:g,selectors:[["app-text-input"]],inputs:{label:"label",type:"type",width:"width"},decls:6,vars:10,consts:[[1,"mb-3",2,"vertical-align","top"],[1,"form-control",2,"font-size","small","word-wrap","normal","height","auto","margin-top","0px","margin-bottom","0px","padding-top","0px","padding-bottom","0px","background-color","darkgrey",3,"type","width","formControl","placeholder"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"]],template:function(p,d){1&p&&(t.j41(0,"div",0),t.nrm(1,"input",1),t.DNE(2,M,2,1,"div",2),t.DNE(3,v,2,2,"div",2),t.DNE(4,C,2,2,"div",2),t.DNE(5,f,2,1,"div",2),t.k0s()),2&p&&(t.R7$(1),t.AVh("is-invalid",d.control.touched&&d.control.invalid),t.FS9("type",d.type),t.FS9("width",d.width),t.FS9("placeholder",d.label),t.Y8G("formControl",d.control),t.R7$(1),t.Y8G("ngIf",null==d.control.errors?null:d.control.errors.required),t.R7$(1),t.Y8G("ngIf",null==d.control.errors?null:d.control.errors.minlength),t.R7$(1),t.Y8G("ngIf",null==d.control.errors?null:d.control.errors.maxlength),t.R7$(1),t.Y8G("ngIf",null==d.control.errors?null:d.control.errors.isMatching))},dependencies:[T.bT,h.me,h.BC,h.l_]})}return g})()},778:(y,b,c)=>{c.d(b,{G:()=>f});var t=c(7705),h=c(779);let T=(()=>{class e{constructor(m){this.bsModalRef=m,this.title="",this.message="",this.btnOkText="",this.btnCancelText="",this.result=!1}confirm(){this.result=!0,this.bsModalRef.hide()}decline(){this.bsModalRef.hide()}static#e=this.\u0275fac=function(l){return new(l||e)(t.rXU(h.Y$))};static#t=this.\u0275cmp=t.VBU({type:e,selectors:[["app-confirm-dialog"]],decls:11,vars:4,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],[1,"modal-body"],[1,"modal-footer"],["type","button",1,"btn","btn-success",3,"click"],["type","button",1,"btn","btn-danger",3,"click"]],template:function(l,p){1&l&&(t.j41(0,"div",0)(1,"h4",1),t.EFF(2),t.k0s()(),t.j41(3,"div",2)(4,"p"),t.EFF(5),t.k0s()(),t.j41(6,"div",3)(7,"button",4),t.bIt("click",function(){return p.confirm()}),t.EFF(8),t.k0s(),t.j41(9,"button",5),t.bIt("click",function(){return p.decline()}),t.EFF(10),t.k0s()()),2&l&&(t.R7$(2),t.JRh(p.title),t.R7$(3),t.JRh(p.message),t.R7$(3),t.JRh(p.btnOkText),t.R7$(2),t.JRh(p.btnCancelText))}})}return e})();var M=c(6354),v=c(3587),C=c(1626);let f=(()=>{class e{constructor(m,l){this.modalService=m,this.http=l,this.baseUrl=v.c.apiUrl}confirm(m="Confirmation",l="Are you sure you want to do this?",p="Ok",d="Cancel"){return this.bsModelRef=this.modalService.show(T,{initialState:{title:m,message:l,btnOkText:p,btnCancelText:d}}),this.bsModelRef.onHidden.pipe((0,M.T)(()=>this.bsModelRef.content.result))}getHelp(m){return this.http.get(this.baseUrl+"Help/help/"+m)}static#e=this.\u0275fac=function(l){return new(l||e)(t.KVO(h.I8),t.KVO(C.Qq))};static#t=this.\u0275prov=t.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})()},5691:(y,b,c)=>{c.r(b),c.d(b,{MessageModule:()=>U});var t=c(177),h=c(9417),T=c(9485),M=c(4056),v=c(5964),C=c(5558),f=c(2568),e=c(7705),g=c(8882),m=c(8256),l=c(778),p=c(3400),d=c(4722),I=c(2510),F=c(6295),j=c(5743);const E=["searchInUsernames"],x=["searchInContents"];function P(r,_){if(1&r){const s=e.RV6();e.j41(0,"pagination",25),e.bIt("ngModelChange",function(n){e.eBV(s);const i=e.XpG();return e.Njj(i.pagination.currentPage=n)})("pageChanged",function(n){e.eBV(s);const i=e.XpG();return e.Njj(i.pageChanged(n))}),e.k0s()}if(2&r){const s=e.XpG();e.Y8G("boundaryLinks",!0)("totalItems",s.pagination.totalItems)("itemsPerPage",s.pagination.itemsPerPage)("ngModel",s.pagination.currentPage)("maxSize",15)}}function R(r,_){1&r&&(e.j41(0,"div",26)(1,"h3"),e.EFF(2,"No messages"),e.k0s()())}function w(r,_){if(1&r){const s=e.RV6();e.j41(0,"div")(1,"div",34),e.bIt("click",function(){const i=e.eBV(s).$implicit,a=e.XpG(3);return e.Njj(a.msgClicked(i))}),e.EFF(2),e.nI1(3,"date"),e.k0s(),e.j41(4,"div",35),e.bIt("click",function(){const i=e.eBV(s).$implicit,a=e.XpG(3);return e.Njj(a.msgClicked(i))}),e.EFF(5),e.k0s(),e.j41(6,"div",36),e.bIt("click",function(){const i=e.eBV(s).$implicit,a=e.XpG(3);return e.Njj(a.msgClicked(i))}),e.EFF(7),e.k0s(),e.j41(8,"button",37),e.bIt("click",function(){const i=e.eBV(s).$implicit,a=e.XpG(3);return e.Njj(a.removeMessage(i.id))}),e.k0s()()}if(2&r){const s=_.$implicit;e.R7$(2),e.JRh(e.i5U(3,4,s.messageComposedOn,"dd-MMM-yy")),e.R7$(3),e.Lme("",s.senderUsername," [",s.senderEmail,"]"),e.R7$(2),e.JRh(s.subject)}}function G(r,_){if(1&r&&(e.j41(0,"div")(1,"label",30),e.EFF(2,"Date"),e.k0s(),e.j41(3,"label",31),e.EFF(4,"From"),e.k0s(),e.j41(5,"label",32),e.EFF(6,"Subject"),e.k0s(),e.DNE(7,w,9,7,"div",33),e.k0s()),2&r){const s=e.XpG(2);e.R7$(7),e.Y8G("ngForOf",s.messages)}}function $(r,_){if(1&r){const s=e.RV6();e.j41(0,"div")(1,"div",40),e.bIt("click",function(){const i=e.eBV(s).$implicit,a=e.XpG(3);return e.Njj(a.msgClicked(i))}),e.EFF(2),e.nI1(3,"date"),e.k0s(),e.j41(4,"div",41),e.bIt("click",function(){const i=e.eBV(s).$implicit,a=e.XpG(3);return e.Njj(a.msgClicked(i))}),e.EFF(5),e.k0s(),e.j41(6,"div",42),e.bIt("click",function(){const i=e.eBV(s).$implicit,a=e.XpG(3);return e.Njj(a.msgClicked(i))}),e.EFF(7),e.k0s(),e.j41(8,"button",43),e.bIt("click",function(){const i=e.eBV(s).$implicit,a=e.XpG(3);return e.Njj(a.removeMessage(i.id))}),e.k0s()()}if(2&r){const s=_.$implicit;e.R7$(2),e.JRh(e.i5U(3,4,s.messageComposedOn,"ddMMMyy")),e.R7$(3),e.JRh(s.recipientEmail),e.R7$(2),e.Lme("",s.subject," - ",s.id,"")}}function O(r,_){if(1&r&&(e.j41(0,"div",38)(1,"label",30),e.EFF(2,"Date"),e.k0s(),e.j41(3,"label",31),e.EFF(4,"To"),e.k0s(),e.j41(5,"label",39),e.EFF(6,"Subject"),e.k0s(),e.DNE(7,$,9,7,"div",33),e.k0s()),2&r){const s=e.XpG(2);e.R7$(7),e.Y8G("ngForOf",s.messages)}}function D(r,_){if(1&r&&(e.j41(0,"div",27),e.DNE(1,G,8,1,"div",28),e.DNE(2,O,8,1,"div",29),e.k0s()),2&r){const s=e.XpG();e.R7$(1),e.Y8G("ngIf","Inbox"===s.container),e.R7$(1),e.Y8G("ngIf","Outbox"===s.container)}}const S=[{path:"messages",component:(()=>{class r{constructor(s,o,n){this.service=s,this.toastr=o,this.confirm=n,this.messages=[],this.msgParams=new f.a,this.container="Inbox",this.loading=!1,this.messageSentOn=new Date,this.dtMsgSentMoreThan2000=!1,this.iMessageId=0,this.msgToDisplay="",this.toEmailId="",this.ccEmailId="",this.subject="",this.lastContainer="",this.lastMessageType="",this.currentPage=0,this.msgTypes=[],this.editorConfig={editable:!0,spellcheck:!0,height:"auto",minHeight:"0",maxHeight:"auto",width:"auto",minWidth:"0",translate:"yes",enableToolbar:!0,showToolbar:!0,placeholder:"Enter text here...",defaultParagraphSeparator:"",defaultFontName:"",defaultFontSize:"",fonts:[{class:"arial",name:"Arial"},{class:"times-new-roman",name:"Times New Roman"},{class:"calibri",name:"Calibri"},{class:"comic-sans-ms",name:"Comic Sans MS"}],customClasses:[{name:"quote",class:"quote"},{name:"redText",class:"redText"},{name:"titleText",class:"titleText",tag:"h1"}],uploadWithCredentials:!1,sanitize:!0,toolbarPosition:"top",toolbarHiddenButtons:[["bold","italic"],["fontSize"]]},this.msgTypes=this.service.getMessageTypes()}ngOnInit(){}loadMessages(s=!1){""!==this.msgParams.messageType?(console.log("currentpage:",this.currentPage,"params page",this.msgParams.pageNumber),(this.container!==this.lastContainer||this.msgParams.messageType!==this.lastMessageType&&""!==this.lastMessageType||this.msgParams.pageNumber!==this.currentPage)&&(this.lastMessageType=this.msgParams.messageType,this.loading=!0,this.service.setParams(this.msgParams),this.service.getMessages(s).subscribe({next:o=>{this.messages=o.result,this.pagination=o.pagination,this.loading=!1,this.currentPage=this.msgParams.pageNumber}}),this.lastContainer=this.container)):this.toastr.warning("Please select the Message Type before selecting the container","Message Type Not Selected")}deleteMessage(s){this.service.deleteMessage(s).subscribe({next:o=>{if(console.log("reponse:",o),"Marked as Deleted"===o?this.toastr.success("Message Marked as Deleted","Success"):"Deleted"===o&&this.toastr.success("Message Deleted","Success"),"Deleted"===o||"Marked as Deleted"===o){var n=this.messages?.findIndex(i=>i.id===s);-1!==n&&this.messages?.splice(n,1)}},error:o=>this.toastr.error(o.error?.details,"Error encountered")})}pageChanged(s){this.msgParams.pageNumber!==s.page&&(this.msgParams.pageNumber=s.page,this.loadMessages())}msgClicked(s){this.msgToDisplay=s.content,this.messageSentOn=s.messageSent,this.iMessageId=s.id,this.dtMsgSentMoreThan2000=this.messageSentOn>new Date("2000-01-01"),this.subject=s.subject,this.toEmailId=s.recipientEmail}removeMessage(s){const n=this.service.deleteMessage(s);this.confirm.confirm("confirm Delete","confirm delete this Message. WARNING: this cannot be undone").pipe((0,v.p)(a=>a),(0,C.n)(()=>n)).subscribe({next:a=>{if("Unauthorized"===a)this.toastr.warning("The message can be deleted by the sender or the recipient","Unauthorized");else if("Deleted"===a||"Marked as Deleted"===a){this.toastr.success("Message Deleted","Deletion successful");var u=this.messages?.findIndex(k=>k.id==s);-1!==u&&this.messages.splice(u,1)}else this.toastr.error(a,"Failed to delete the message")},error:a=>this.toastr.error(a.error.text,"Error encountered")})}sendMessage(){var s=this.messages?.filter(u=>u.id===this.iMessageId)[0];if(!s)return void this.toastr.warning("failed to retrieve the current message","cannot retrieve message");const i=this.service.sendMessage({senderUsername:s.senderUsername,recipientUsername:s.recipientUsername,ccEmailAddress:"",subject:s.subject,content:this.msgToDisplay,id:s.id});this.confirm.confirm("confirm Send Message","confirm send this Message.").pipe((0,v.p)(u=>u),(0,C.n)(()=>i)).subscribe({next:u=>{if(void 0!==u){this.toastr.success("Message sent","Success");var k=this.messages?.findIndex(B=>B.id==u.id);-1!==k&&this.messages&&u&&this.messages.splice(k,1)}else this.toastr.warning("Failed to send the message","failed to Send")},error:u=>this.toastr.error(u.error.details,"Error encountered")})}onSearchInUsernames(){const s=new f.a;s.search=this.searchTermInUsernames?.nativeElement.value,s.pageNumber=1,this.service.setParams(s),this.loadMessages()}onSearchInContents(){const s=new f.a;s.searchInContents=this.searchTermInContents?.nativeElement.value,s.pageNumber=1,this.service.setParams(s),this.loadMessages()}updateToEmailId(){}static#e=this.\u0275fac=function(o){return new(o||r)(e.rXU(g.b),e.rXU(m.tw),e.rXU(l.G))};static#t=this.\u0275cmp=e.VBU({type:r,selectors:[["app-messages"]],viewQuery:function(o,n){if(1&o&&(e.GBs(E,5),e.GBs(x,5)),2&o){let i;e.mGM(i=e.lsd())&&(n.searchTermInUsernames=i.first),e.mGM(i=e.lsd())&&(n.searchTermInContents=i.first)}},decls:35,vars:21,consts:[[1,"stdd","col-4","my-0",2,"vertical-align","top"],[1,"mb-4","d-flex"],["name","container",1,"btn-group"],["title","Unread messages","btnRadio","Unread","value","unread",1,"btn","btn-primary",3,"ngModel","ngModelChange","click"],[1,"fa","fa-envelope"],["btnRadio","Inbox","title","Inbox messages","value","Inbox",1,"btn","btn-primary",3,"ngModel","ngModelChange","click"],[1,"fa","fa-envelope-open"],["title","sent messages","btnRadio","Outbox","value","Outbox",1,"btn","btn-primary",3,"ngModel","ngModelChange","click"],[1,"fa","fa-paper-plane"],["bindLabel","MessageType","bindValue","MessageType","labelForId","MessageType","clearAllText","Clear",1,"mx-3","w150",3,"items","ngModel","ngModelChange"],["style","display: inline-block;","previousText","\u2039","nextText","\u203a","firstText","\xab","lastText","\xbb",3,"boundaryLinks","totalItems","itemsPerPage","ngModel","maxSize","ngModelChange","pageChanged",4,"ngIf"],["class","row",4,"ngIf"],["class","stdd row","style","vertical-align: top;",4,"ngIf"],[1,"stdd","col-7","my-0",2,"vertical-align","top"],["title","retrieves Email Id from database",1,"btn",3,"disabled","click"],["title","send the message to the addressee",1,"stdd","pull-right","btn","fa","fa-paper-plane","mx-1",2,"color","aliceblue","background-color","grey",3,"disabled","click"],[1,"stdd","w25"],[1,"stdd","w150",3,"ngModel","label","ngModelChange"],[1,"stdd","w25","mx-2"],[1,"stdd","w50"],[1,"stdd","w250",3,"ngModel","label","ngModelChange"],[1,"stdd","w40"],[1,"stdd","w80"],[3,"ngModel","ngModelChange"],["type","button","title","close this window","routerLink","/",1,"btn","fa","fa-window-close","fa-2x",2,"color","aliceblue"],["previousText","\u2039","nextText","\u203a","firstText","\xab","lastText","\xbb",2,"display","inline-block",3,"boundaryLinks","totalItems","itemsPerPage","ngModel","maxSize","ngModelChange","pageChanged"],[1,"row"],[1,"stdd","row",2,"vertical-align","top"],[4,"ngIf"],["class","stdd",4,"ngIf"],[1,"lbl","w80"],[1,"lbl","w100"],[1,"lbl","w250"],[4,"ngFor","ngForOf"],[1,"stdd","cursorPointer","col-2",3,"click"],[1,"stdd","cursorPointer","col-3",3,"click"],[1,"stdd","cursorPointer","col-5",3,"click"],[1,"stdd","btn","col-1","fa","fa-trash","red",3,"click"],[1,"stdd"],[1,"lbl","w300"],[1,"stdd","cursorPointer","w80",3,"click"],[1,"stdd","cursorPointer","w100",3,"click"],[1,"stdd","cursorPointer","w300",3,"click"],[1,"stdd","btn","w35","fa","fa-trash","red",3,"click"]],template:function(o,n){1&o&&(e.j41(0,"div",0)(1,"div",1),e.nrm(2,"br"),e.j41(3,"div",2)(4,"button",3),e.bIt("ngModelChange",function(a){return n.msgParams.container=a})("click",function(){return n.loadMessages()}),e.nrm(5,"i",4),e.k0s(),e.j41(6,"button",5),e.bIt("ngModelChange",function(a){return n.msgParams.container=a})("click",function(){return n.loadMessages()}),e.nrm(7,"i",6),e.k0s(),e.j41(8,"button",7),e.bIt("ngModelChange",function(a){return n.msgParams.container=a})("click",function(){return n.loadMessages()}),e.nrm(9,"i",8),e.k0s()(),e.j41(10,"ng-select",9),e.bIt("ngModelChange",function(a){return n.msgParams.messageType=a}),e.k0s(),e.DNE(11,P,1,5,"pagination",10),e.k0s(),e.DNE(12,R,3,0,"div",11),e.DNE(13,D,3,2,"div",12),e.k0s(),e.j41(14,"div",13)(15,"button",14),e.bIt("click",function(){return n.updateToEmailId()}),e.k0s(),e.j41(16,"button",15),e.bIt("click",function(){return n.sendMessage()}),e.k0s(),e.nrm(17,"br")(18,"br"),e.j41(19,"span",16),e.EFF(20,"To:"),e.k0s(),e.j41(21,"app-text-input",17),e.bIt("ngModelChange",function(a){return n.toEmailId=a}),e.k0s(),e.j41(22,"span",18),e.EFF(23,"CC:"),e.k0s(),e.j41(24,"app-text-input",17),e.bIt("ngModelChange",function(a){return n.ccEmailId=a}),e.k0s(),e.j41(25,"span",19),e.EFF(26,"Subject"),e.k0s(),e.j41(27,"app-text-input",20),e.bIt("ngModelChange",function(a){return n.subject=a}),e.k0s(),e.j41(28,"span",21),e.EFF(29,"Sent On"),e.k0s(),e.j41(30,"div",22),e.EFF(31),e.nI1(32,"date"),e.k0s(),e.j41(33,"angular-editor",23),e.bIt("ngModelChange",function(a){return n.msgToDisplay=a}),e.k0s()(),e.nrm(34,"button",24)),2&o&&(e.R7$(4),e.Y8G("ngModel",n.msgParams.container),e.R7$(2),e.Y8G("ngModel",n.msgParams.container),e.R7$(2),e.Y8G("ngModel",n.msgParams.container),e.R7$(2),e.Y8G("items",n.msgTypes)("ngModel",n.msgParams.messageType),e.R7$(1),e.Y8G("ngIf",!n.loading&&n.pagination&&n.messages&&n.messages.length>0),e.R7$(1),e.Y8G("ngIf",!n.messages||0===(null==n.messages?null:n.messages.length)),e.R7$(1),e.Y8G("ngIf",n.messages&&0!==(null==n.messages?null:n.messages.length)),e.R7$(2),e.Y8G("disabled",null!==n.toEmailId||""!==n.toEmailId),e.R7$(1),e.Y8G("disabled",n.dtMsgSentMoreThan2000||""===n.toEmailId),e.R7$(5),e.Y8G("ngModel",n.toEmailId)("label","To Email"),e.R7$(3),e.Y8G("ngModel",n.ccEmailId)("label","CC"),e.R7$(3),e.Y8G("ngModel",n.subject)("label","Subject"),e.R7$(4),e.JRh(e.i5U(32,18,n.messageSentOn,"ddMMMyy")),e.R7$(2),e.Y8G("ngModel",n.msgToDisplay))},dependencies:[t.Sq,t.bT,h.BC,h.vS,p.eK,d.p4,I.vr,F.f,M.Rj,j.Wk,t.vh],styles:[".stdd[_ngcontent-%COMP%]{display:inline-block;margin:0 2px;font-size:x-small;vertical-align:top;word-wrap:normal;word-break:break-all}.lbl[_ngcontent-%COMP%]{display:inline-block;margin:0 2px;font-size:x-small;font-weight:700;vertical-align:top;word-break:normal;word-wrap:break-word}.cursorPointer[_ngcontent-%COMP%]{cursor:pointer;color:#ff0}.red[_ngcontent-%COMP%]{color:red}.w25[_ngcontent-%COMP%]{width:25px}.w35[_ngcontent-%COMP%]{width:35px}.w40[_ngcontent-%COMP%]{width:40px}.w50[_ngcontent-%COMP%]{width:50px}.w80[_ngcontent-%COMP%]{width:80px}.w100[_ngcontent-%COMP%]{width:100px}.w150[_ngcontent-%COMP%]{width:150px}.w300[_ngcontent-%COMP%]{width:300px}.w250[_ngcontent-%COMP%]{width:250px}"]})}return r})()}];let N=(()=>{class r{static#e=this.\u0275fac=function(o){return new(o||r)};static#t=this.\u0275mod=e.$C({type:r});static#s=this.\u0275inj=e.G2t({imports:[t.MD,j.iI.forChild(S),j.iI]})}return r})(),U=(()=>{class r{static#e=this.\u0275fac=function(o){return new(o||r)};static#t=this.\u0275mod=e.$C({type:r});static#s=this.\u0275inj=e.G2t({imports:[t.MD,h.YN,T.G,M.Qt,N]})}return r})()}}]);